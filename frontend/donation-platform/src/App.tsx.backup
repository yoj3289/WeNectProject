import React, { useState, useEffect } from 'react';
import { Heart, Search, User, Bell, Menu, Calendar, Target, Users, Share2, MessageCircle, X, Upload, Edit, Trash2, CheckCircle, XCircle, DollarSign, BarChart3, FileText, Settings, LogOut, Home, List, PlusCircle, MessageSquare, Save, Eye, EyeOff, CreditCard, Building, Download, Shield, Award, Image, AlertCircle, Info, Plus, ChevronRight, ChevronLeft, LayoutDashboard, FolderCheck, Filter, ChevronDown, MoreVertical, Clock, TrendingUp, Mail, Phone, Activity, ArrowUp, ArrowDown, RefreshCw, PieChart } from 'lucide-react';
import HomePage from './pages/HomePage';
import DonationModal from './components/donation/DonationModal';

// Types
interface Project {
  id: number;
  title: string;
  category: string;
  currentAmount: number;
  targetAmount: number;
  dday: number;
  donors: number;
  image: string;
  description: string;
  organization: string;
  status: 'approved' | 'pending' | 'rejected';
  rejectionReason?: string;
}

interface RecentDonation {
  name: string;
  amount: number;
  project: string;
  time: string;
}

interface Comment {
  id: number;
  author: string;
  content: string;
  date: string;
  parentId?: number;
  replies?: Comment[];
}

interface CommunityPost {
  id: number;
  type: 'ê³µì§€' | 'ì§ˆë¬¸' | 'ì‘ì›';
  title: string;
  author: string;
  date: string;
  views: number;
  content?: string;
  comments?: Comment[];
}

interface SettlementRequest {
  id: number;
  projectId: number;
  projectTitle: string;
  organization: string;
  requestAmount: number;
  requestDate: string;
  status: 'pending' | 'approved' | 'rejected';
  documents: string[];
  rejectionReason?: string;
}

interface Notification {
  id: number;
  type: 'donation' | 'project' | 'settlement' | 'comment';
  title: string;
  message: string;
  date: string;
  isRead: boolean;
  link?: string;
}

interface UserProfile {
  name: string;
  email: string;
  phone: string;
  notificationSettings: {
    donation: boolean;
    project: boolean;
    comment: boolean;
    newsletter: boolean;
  };
}

interface AdminUser {
  id: number;
  name: string;
  email: string;
  type: 'ì¼ë°˜' | 'ê¸°ê´€';
  status: 'active' | 'inactive' | 'suspended';
  registeredDate: string;
  lastLogin: string;
}

interface DonationHistory {
  id: number;
  projectTitle: string;
  amount: number;
  date: string;
  receiptNumber: string;
  status: 'completed' | 'pending';
}

interface PiggyBank {
  projectId: number;
  projectTitle: string;
  totalAmount: number;
  withdrawnAmount: number;
  balance: number;
  status: 'active' | 'withdrawn' | 'locked';
  lastUpdated: string;
}

type PageType = 'home' | 'login' | 'projects' | 'detail' | 'signup' | 'create-project' | 'edit-project' | 'community' | 'mypage' | 'profile-edit' | 'admin' | 'admin-users' | 'post-detail' | 'create-post' | 'edit-post' | 'settlement' | 'notifications' | 'donation-history' | 'favorite-projects' | 'piggy-bank' | 'project-approval';
type UserType = 'individual' | 'organization' | 'admin';
type TabType = 'intro' | 'progress' | 'donors' | 'messages';

// AdminDashboard Props Interface
interface AdminDashboardProps {
  sidebarOpen: boolean;
  setSidebarOpen: (open: boolean) => void;
  activeMenu: string;
  setActiveMenu: (menu: string) => void;
  projectFilter: string;
  setProjectFilter: (filter: string) => void;
  projectCategoryFilter: string;
  setProjectCategoryFilter: (filter: string) => void;
  projectSearchTerm: string;
  setProjectSearchTerm: (term: string) => void;
  userTypeFilter: string;
  setUserTypeFilter: (filter: string) => void;
  userStatusFilter: string;
  setUserStatusFilter: (filter: string) => void;
  userSearchTerm: string;
  setUserSearchTerm: (term: string) => void;
  settlementFilter: string;
  setSettlementFilter: (filter: string) => void;
  settlementSearchTerm: string;
  setSettlementSearchTerm: (term: string) => void;
  selectedProjects: number[];
  setSelectedProjects: (projects: number[]) => void;
  selectedUsers: number[];
  setSelectedUsers: (users: number[]) => void;
  selectedSettlements: number[];
  setSelectedSettlements: (settlements: number[]) => void;
  selectedProject: any;
  setSelectedProject: (project: any) => void;
  selectedUser: any;
  setSelectedUser: (user: any) => void;
  selectedSettlement: any;
  setSelectedSettlement: (settlement: any) => void;
  showProjectModal: boolean;
  setShowProjectModal: (show: boolean) => void;
  showUserModal: boolean;
  setShowUserModal: (show: boolean) => void;
  showSettlementModal: boolean;
  setShowSettlementModal: (show: boolean) => void;
  rejectReason: string;
  setRejectReason: (reason: string) => void;
  adminUsers: any[];
}

const DonationPlatform: React.FC = () => {
  const [currentPage, setCurrentPage] = useState<PageType>('home');
  const [selectedProject, setSelectedProject] = useState<any>(null);
  const [showDonationModal, setShowDonationModal] = useState<boolean>(false);
  const [showLoginModal, setShowLoginModal] = useState<boolean>(false);
  const [showPasswordModal, setShowPasswordModal] = useState<boolean>(false);
  const [showPaymentModal, setShowPaymentModal] = useState<boolean>(false);
  const [isLoggedIn, setIsLoggedIn] = useState<boolean>(false);
  const [userType, setUserType] = useState<UserType>('individual');
  const [selectedLoginType, setSelectedLoginType] = useState<UserType>('individual');
  const [activeTab, setActiveTab] = useState<TabType>('intro');
  const [uploadedImages, setUploadedImages] = useState<string[]>([]);
  const [selectedPost, setSelectedPost] = useState<CommunityPost | null>(null);
  const [editingCommentId, setEditingCommentId] = useState<number | null>(null);
  const [replyingToCommentId, setReplyingToCommentId] = useState<number | null>(null);
  const [commentText, setCommentText] = useState<string>('');
  
  const [loginEmail, setLoginEmail] = useState('');
  const [loginPassword, setLoginPassword] = useState('');
  const [rememberMe, setRememberMe] = useState(false);
  const [loginAttempts, setLoginAttempts] = useState<Map<string, number>>(new Map());
  const [lockedAccounts, setLockedAccounts] = useState<Set<string>>(new Set());

  const [signupType, setSignupType] = useState<UserType>('individual');
  const [signupEmail, setSignupEmail] = useState('');
  const [isEmailChecked, setIsEmailChecked] = useState(false);
  const [isEmailAvailable, setIsEmailAvailable] = useState(false);
  const [signupPassword, setSignupPassword] = useState('');
  const [signupPasswordConfirm, setSignupPasswordConfirm] = useState('');
  const [signupName, setSignupName] = useState('');
  const [signupPhone, setSignupPhone] = useState('');
  const [signupBusinessNumber, setSignupBusinessNumber] = useState('');
  const [signupRepName, setSignupRepName] = useState('');
  const [uploadedFile, setUploadedFile] = useState<File | null>(null);

  const [favoriteProjectIds, setFavoriteProjectIds] = useState<Set<number>>(new Set([1, 2, 5])); // ì´ˆê¸°ê°’ì€ ê¸°ì¡´ ì½”ë“œì— ë§ì¶¤

  // 5ë²ˆ - í•„í„°ë§/ì •ë ¬ states
  const [selectedCategory, setSelectedCategory] = useState('ì „ì²´');
  const [sortOption, setSortOption] = useState('ìµœì‹ ìˆœ');

  // 7ë²ˆ - ëŒ“ê¸€ states
  const [comments, setComments] = useState<Comment[]>([]);
  const [newComment, setNewComment] = useState('');
  const [replyTo, setReplyTo] = useState<number | null>(null);

  // 10ë²ˆ - ì´ë¯¸ì§€ ì—…ë¡œë“œ state (File ë°°ì—´ë¡œ ë³€ê²½)
  const [uploadedImageFiles, setUploadedImageFiles] = useState<File[]>([]);

  // 11ë²ˆ - ì¡°íšŒìˆ˜ state
  const [postViews, setPostViews] = useState<Map<number, number>>(new Map([
    [1, 234],
    [2, 89],
    [3, 156]
  ]));

  // ì¡°íšŒìˆ˜ë¥¼ ì¦ê°€ì‹œí‚¨ ê²Œì‹œê¸€ ID ì¶”ì  (Setìœ¼ë¡œ ê´€ë¦¬)
  const [viewedPostIds, setViewedPostIds] = useState<Set<number>>(new Set());

  // Donation form states
  const [donationAmount, setDonationAmount] = useState<number>(0);
  const [customAmount, setCustomAmount] = useState<string>('');
  const [donorName, setDonorName] = useState<string>('');
  const [isAnonymous, setIsAnonymous] = useState<boolean>(false);
  const [donationMessage, setDonationMessage] = useState<string>('');
  const [paymentMethod, setPaymentMethod] = useState<string>('');

  // Project registration states
  const [currentStep, setCurrentStep] = useState<number>(1);
  const [projectTitle, setProjectTitle] = useState<string>('');
  const [projectCategory, setProjectCategory] = useState<string>('');
  const [organizationName, setOrganizationName] = useState<string>('');
  const [businessNumber, setBusinessNumber] = useState<string>('');
  const [projectSummary, setProjectSummary] = useState<string>('');
  const [projectDescription, setProjectDescription] = useState<string>('');
  const [fundingPlan, setFundingPlan] = useState<string>('');
  const [targetAmount, setTargetAmount] = useState<string>('');
  const [fundingDuration, setFundingDuration] = useState<string>('30');
  const [startDate, setStartDate] = useState<string>('');
  const [endDate, setEndDate] = useState<string>('');
  const [fundingType, setFundingType] = useState<string>('stop-on-goal');
  const [projectImages, setProjectImages] = useState<string[]>([]);
  const [businessPlan, setBusinessPlan] = useState<string>('');
  const [agreeToTerms, setAgreeToTerms] = useState<boolean>(false);

  // Admin dashboard states
  const [sidebarOpen, setSidebarOpen] = useState<boolean>(true);
  const [activeMenu, setActiveMenu] = useState<string>('dashboard');
  const [projectFilter, setProjectFilter] = useState<string>('all');
  const [projectCategoryFilter, setProjectCategoryFilter] = useState<string>('all');
  const [projectSearchTerm, setProjectSearchTerm] = useState<string>('');
  const [userTypeFilter, setUserTypeFilter] = useState<string>('all');
  const [userStatusFilter, setUserStatusFilter] = useState<string>('all');
  const [userSearchTerm, setUserSearchTerm] = useState<string>('');
  const [settlementFilter, setSettlementFilter] = useState<string>('all');
  const [settlementSearchTerm, setSettlementSearchTerm] = useState<string>('');
  const [selectedProjects, setSelectedProjects] = useState<number[]>([]);
  const [selectedUsers, setSelectedUsers] = useState<number[]>([]);
  const [selectedSettlements, setSelectedSettlements] = useState<number[]>([]);

  // Admin modal states
  const [selectedUser, setSelectedUser] = useState<any>(null);
  const [selectedSettlement, setSelectedSettlement] = useState<any>(null);
  const [showProjectModal, setShowProjectModal] = useState<boolean>(false);
  const [showUserModal, setShowUserModal] = useState<boolean>(false);
  const [showSettlementModal, setShowSettlementModal] = useState<boolean>(false);
  const [rejectReason, setRejectReason] = useState<string>('');

// ============================================
// 2. ê´€ì‹¬ í”„ë¡œì íŠ¸ ì¶”ê°€/ì œê±° í† ê¸€ í•¨ìˆ˜
// ============================================
  const toggleFavoriteProject = (projectId: number) => {
    const newFavorites = new Set(favoriteProjectIds);

    if (newFavorites.has(projectId)) {
      // ì´ë¯¸ ê´€ì‹¬ í”„ë¡œì íŠ¸ë©´ ì œê±°
      newFavorites.delete(projectId);
      alert('ê´€ì‹¬ í”„ë¡œì íŠ¸ì—ì„œ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.');
    } else {
      // ê´€ì‹¬ í”„ë¡œì íŠ¸ì— ì¶”ê°€
      newFavorites.add(projectId);
      alert('ê´€ì‹¬ í”„ë¡œì íŠ¸ì— ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.');
    }

    setFavoriteProjectIds(newFavorites);
  };

  // ============================================
  // 5ë²ˆ - í•„í„°ë§/ì •ë ¬ í•¨ìˆ˜
  // ============================================
  const getFilteredAndSortedProjects = () => {
    let result = [...projects];

    // ì¹´í…Œê³ ë¦¬ í•„í„°ë§
    if (selectedCategory !== 'ì „ì²´') {
      result = result.filter(p => p.category === selectedCategory);
    }

    // ì •ë ¬
    switch (sortOption) {
      case 'ìµœì‹ ìˆœ':
        // í”„ë¡œì íŠ¸ ID ë†’ì€ ìˆœ (ìµœì‹ )
        result.sort((a, b) => b.id - a.id);
        break;
      case 'ë§ˆê°ì„ë°•ìˆœ':
        // D-day ë‚®ì€ ìˆœ
        result.sort((a, b) => a.dday - b.dday);
        break;
      case 'ëª¨ê¸ˆë¥ ìˆœ':
        // ëª¨ê¸ˆë¥  ë†’ì€ ìˆœ
        result.sort((a, b) => {
          const progressA = (a.currentAmount / a.targetAmount) * 100;
          const progressB = (b.currentAmount / b.targetAmount) * 100;
          return progressB - progressA;
        });
        break;
    }

    return result;
  };

  // ============================================
  // 7ë²ˆ - ëŒ“ê¸€ í•¨ìˆ˜ë“¤
  // ============================================
  const addComment = (content: string, parentId?: number) => {
    if (!content.trim()) {
      alert('ëŒ“ê¸€ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
      return;
    }

    const comment: Comment = {
      id: Date.now(),
      author: 'ì‚¬ìš©ì',
      content,
      date: new Date().toLocaleDateString(),
      parentId,
      replies: []
    };

    setComments([...comments, comment]);
    setNewComment('');
    setReplyTo(null);
    alert('ëŒ“ê¸€ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.');
  };

  const deleteComment = (id: number) => {
    if (confirm('ëŒ“ê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
      setComments(comments.filter(c => c.id !== id && c.parentId !== id));
      alert('ëŒ“ê¸€ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
    }
  };

  // ============================================
  // 8ë²ˆ - SNS ê³µìœ  & URL ë³µì‚¬ í•¨ìˆ˜ë“¤
  // ============================================
  const copyToClipboard = (text: string) => {
    navigator.clipboard.writeText(text).then(() => {
      alert('ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
    });
  };

  const shareToSNS = (platform: string, projectTitle: string) => {
    const url = window.location.href;
    const text = `${projectTitle} - ë”°ëœ»í•œ ë‚˜ëˆ”`;

    switch(platform) {
      case 'facebook':
        window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`);
        break;
      case 'twitter':
        window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`);
        break;
      case 'kakao':
        alert('ì¹´ì¹´ì˜¤í†¡ ê³µìœ  ê¸°ëŠ¥ì€ ì¹´ì¹´ì˜¤ ê°œë°œì ë“±ë¡ í›„ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.');
        break;
    }
  };

  // ============================================
  // 9ë²ˆ - ì˜ìˆ˜ì¦ ë‹¤ìš´ë¡œë“œ í•¨ìˆ˜
  // ============================================
  const downloadReceipt = (receiptNumber: string, projectTitle: string, amount: number) => {
    const content = `
ê¸°ë¶€ê¸ˆ ì˜ìˆ˜ì¦
-----------------
ì˜ìˆ˜ì¦ ë²ˆí˜¸: ${receiptNumber}
í”„ë¡œì íŠ¸: ${projectTitle}
ê¸°ë¶€ ê¸ˆì•¡: ${formatAmount(amount)}ì›
ë°œê¸‰ì¼: ${new Date().toLocaleDateString()}
-----------------
ë”°ëœ»í•œ ë‚˜ëˆ”
    `.trim();

    const blob = new Blob([content], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `ì˜ìˆ˜ì¦_${receiptNumber}.txt`;
    a.click();
    URL.revokeObjectURL(url);

    alert('ì˜ìˆ˜ì¦ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.');
  };

  // ============================================
  // 10ë²ˆ - ì´ë¯¸ì§€ ì—…ë¡œë“œ í•¨ìˆ˜ë“¤
  // ============================================
  const handleImageUpload = (e: React.ChangeEvent<HTMLInputElement>) => {
    const files = Array.from(e.target.files || []);

    // ìµœëŒ€ 5ê°œ ì œí•œ
    if (uploadedImageFiles.length + files.length > 5) {
      alert('ì´ë¯¸ì§€ëŠ” ìµœëŒ€ 5ê°œê¹Œì§€ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
      return;
    }

    // íŒŒì¼ í¬ê¸° ì œí•œ (ê° 5MB)
    const maxSize = 5 * 1024 * 1024;
    const validFiles = files.filter(file => {
      if (file.size > maxSize) {
        alert(`${file.name}ì€(ëŠ”) 5MBë¥¼ ì´ˆê³¼í•©ë‹ˆë‹¤.`);
        return false;
      }
      return true;
    });

    setUploadedImageFiles([...uploadedImageFiles, ...validFiles]);
  };

  const removeImage = (index: number) => {
    setUploadedImageFiles(uploadedImageFiles.filter((_, i) => i !== index));
  };

  // ============================================
  // 11ë²ˆ - ì¡°íšŒìˆ˜ ì¹´ìš´íŠ¸ í•¨ìˆ˜
  // ============================================
  const incrementView = (postId: number) => {
    // ì´ë¯¸ ì¡°íšŒí•œ ê²Œì‹œê¸€ì´ë©´ ì¹´ìš´íŠ¸í•˜ì§€ ì•ŠìŒ
    if (viewedPostIds.has(postId)) {
      return;
    }

    const newViews = new Map(postViews);
    const currentViews = newViews.get(postId) || 0;
    newViews.set(postId, currentViews + 1);
    setPostViews(newViews);

    // ì¡°íšŒí•œ ê²Œì‹œê¸€ ID ì¶”ê°€
    const newViewedIds = new Set(viewedPostIds);
    newViewedIds.add(postId);
    setViewedPostIds(newViewedIds);
  };




// ============================================
// 2. ì´ë©”ì¼ ì¤‘ë³µ í™•ì¸ í•¨ìˆ˜ ì¶”ê°€
// ============================================
  const checkEmailDuplicate = (email: string) => {
    // ì´ë©”ì¼ í˜•ì‹ ê²€ì¦
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(email)) {
      alert('ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.');
      return;
    }

    // ì‹¤ì œë¡œëŠ” ë°±ì—”ë“œ API í˜¸ì¶œ
    const existingEmails = [
      'user@example.com',
      'org@example.com', 
      'admin@example.com',
      'test@test.com'
    ];

    const isDuplicate = existingEmails.includes(email);
    
    setIsEmailChecked(true);
    setIsEmailAvailable(!isDuplicate);
    
    if (isDuplicate) {
      alert('ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì´ë©”ì¼ì…ë‹ˆë‹¤.');
    } else {
      alert('ì‚¬ìš© ê°€ëŠ¥í•œ ì´ë©”ì¼ì…ë‹ˆë‹¤.');
    }
  };
  
// ============================================
// 3. íŒŒì¼ ì—…ë¡œë“œ í•¸ë“¤ëŸ¬ ì¶”ê°€
// ============================================
  const handleFileUpload = (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0];
    if (!file) return;

    // íŒŒì¼ í¬ê¸° ì œí•œ (5MB)
    const maxSize = 5 * 1024 * 1024;
    if (file.size > maxSize) {
      alert('íŒŒì¼ í¬ê¸°ëŠ” 5MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.');
      return;
    }

    // íŒŒì¼ í˜•ì‹ ê²€ì¦ (PDF, JPG, PNGë§Œ í—ˆìš©)
    const allowedTypes = ['application/pdf', 'image/jpeg', 'image/png'];
    if (!allowedTypes.includes(file.type)) {
      alert('PDF, JPG, PNG íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
      return;
    }

    setUploadedFile(file);
    alert(`íŒŒì¼ì´ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤: ${file.name}`);
  };

// ============================================
// 4. íšŒì›ê°€ì… ì²˜ë¦¬ í•¨ìˆ˜ ì¶”ê°€
// ============================================
  const handleSignup = () => {
    // ì´ë©”ì¼ ì¤‘ë³µ í™•ì¸ ì—¬ë¶€
    if (!isEmailChecked) {
      alert('ì´ë©”ì¼ ì¤‘ë³µ í™•ì¸ì„ í•´ì£¼ì„¸ìš”.');
      return;
    }
    
    if (!isEmailAvailable) {
      alert('ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ì´ë©”ì¼ì…ë‹ˆë‹¤.');
      return;
    }

    // ë¹„ë°€ë²ˆí˜¸ ê²€ì¦
    if (signupPassword.length < 8) {
      alert('ë¹„ë°€ë²ˆí˜¸ëŠ” 8ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
      return;
    }

    const specialCharRegex = /[!@#$%^&*(),.?":{}|<>]/;
    if (!specialCharRegex.test(signupPassword)) {
      alert('ë¹„ë°€ë²ˆí˜¸ëŠ” íŠ¹ìˆ˜ë¬¸ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.');
      return;
    }

    if (signupPassword !== signupPasswordConfirm) {
      alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
      return;
    }

    // ê¸°ê´€ íšŒì›ì¸ ê²½ìš° ì„œë¥˜ í™•ì¸
    if (signupType === 'organization' && !uploadedFile) {
      alert('ê¸°ê´€ ì¸ì¦ì„œë¥˜ë¥¼ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.');
      return;
    }

    // íšŒì›ê°€ì… ì„±ê³µ
    alert('íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');
    setIsLoggedIn(true);
    setUserType(signupType);
    setCurrentPage('home');
    
    // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
    setSignupEmail('');
    setSignupPassword('');
    setSignupPasswordConfirm('');
    setSignupName('');
    setSignupPhone('');
    setSignupBusinessNumber('');
    setSignupRepName('');
    setUploadedFile(null);
    setIsEmailChecked(false);
    setIsEmailAvailable(false);
  };

  const [userProfile, setUserProfile] = useState<UserProfile>({
    name: 'ê¹€ë¯¼ìˆ˜',
    email: 'user@example.com',
    phone: '010-1234-5678',
    notificationSettings: {
      donation: true,
      project: true,
      comment: true,
      newsletter: false
    }
  });

  const [adminUsers, setAdminUsers] = useState<AdminUser[]>([
    {
      id: 1,
      name: 'ê¹€ë¯¼ìˆ˜',
      email: 'user1@example.com',
      type: 'ì¼ë°˜',
      status: 'active',
      registeredDate: '2024-01-15',
      lastLogin: '2024-03-15 14:30'
    },
    {
      id: 2,
      name: 'í¬ë§ë‚˜ëˆ”ì¬ë‹¨',
      email: 'hope@example.com',
      type: 'ê¸°ê´€',
      status: 'active',
      registeredDate: '2024-02-01',
      lastLogin: '2024-03-14 09:20'
    },
    {
      id: 3,
      name: 'ì´ì˜í¬',
      email: 'user2@example.com',
      type: 'ì¼ë°˜',
      status: 'inactive',
      registeredDate: '2024-01-20',
      lastLogin: '2024-02-28 18:45'
    }
  ]);

  const [notifications, setNotifications] = useState<Notification[]>([
    {
      id: 1,
      type: 'donation',
      title: 'ê¸°ë¶€ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤',
      message: 'ì†Œì™¸ê³„ì¸µ ì•„ë™ ê¸‰ì‹ ì§€ì› í”„ë¡œì íŠ¸ì— 50,000ì›ì´ ê¸°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.',
      date: '2024-03-15 14:30',
      isRead: false
    },
    {
      id: 2,
      type: 'project',
      title: 'í”„ë¡œì íŠ¸ê°€ ëª©í‘œë¥¼ ë‹¬ì„±í–ˆìŠµë‹ˆë‹¤',
      message: 'ë…ê±°ë…¸ì¸ ìƒí™œ ì§€ì› í”„ë¡œì íŠ¸ê°€ ëª©í‘œ ê¸ˆì•¡ì„ ë‹¬ì„±í–ˆìŠµë‹ˆë‹¤!',
      date: '2024-03-14 10:20',
      isRead: false
    }
  ]);

  const [settlementRequests, setSettlementRequests] = useState<SettlementRequest[]>([
    {
      id: 1,
      projectId: 3,
      projectTitle: 'ë…ê±°ë…¸ì¸ ìƒí™œ ì§€ì›',
      organization: 'ì‹¤ë²„ì¼€ì–´ì„¼í„°',
      requestAmount: 9800000,
      requestDate: '2024-03-15',
      status: 'pending',
      documents: ['ì‚¬ìš©ë‚´ì—­ì„œ.pdf', 'ì˜ìˆ˜ì¦.pdf']
    }
  ]);

  const donationHistory: DonationHistory[] = [
    { id: 1, projectTitle: 'ì†Œì™¸ê³„ì¸µ ì•„ë™ ê¸‰ì‹ ì§€ì›', amount: 50000, date: '2024-03-15', receiptNumber: 'R2024031501', status: 'completed' },
    { id: 2, projectTitle: 'ìœ ê¸°ë™ë¬¼ ë³´í˜¸ì†Œ ìš´ì˜ë¹„', amount: 30000, date: '2024-03-10', receiptNumber: 'R2024031002', status: 'completed' },
    { id: 3, projectTitle: 'ë…ê±°ë…¸ì¸ ìƒí™œ ì§€ì›', amount: 100000, date: '2024-02-28', receiptNumber: 'R2024022803', status: 'completed' },
    { id: 4, projectTitle: 'ì‚°ë¶ˆ í”¼í•´ ì§€ì—­ ë³µêµ¬', amount: 20000, date: '2024-02-20', receiptNumber: 'R2024022004', status: 'completed' }
  ];

  const piggyBanks: PiggyBank[] = [
    { projectId: 1, projectTitle: 'ë…ê±°ë…¸ì¸ ìƒí™œ ì§€ì›', totalAmount: 9800000, withdrawnAmount: 0, balance: 9800000, status: 'active', lastUpdated: '2024-03-15' },
    { projectId: 2, projectTitle: 'ì§€ì—­ì•„ë™ì„¼í„° ìš´ì˜ ì§€ì›', totalAmount: 5000000, withdrawnAmount: 5000000, balance: 0, status: 'withdrawn', lastUpdated: '2024-02-28' }
  ];

  const projects: Project[] = [
    {
      id: 1,
      title: 'ì†Œì™¸ê³„ì¸µ ì•„ë™ ê¸‰ì‹ ì§€ì›',
      category: 'ì•„ë™ë³µì§€',
      currentAmount: 7500000,
      targetAmount: 10000000,
      dday: 15,
      donors: 234,
      image: 'ğŸ±',
      description: 'ì–´ë ¤ìš´ í™˜ê²½ì˜ ì•„ë™ë“¤ì—ê²Œ ê±´ê°•í•œ ì‹ì‚¬ë¥¼ ì œê³µí•˜ëŠ” í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.',
      organization: 'í¬ë§ë‚˜ëˆ”ì¬ë‹¨',
      status: 'approved'
    },
    {
      id: 2,
      title: 'ìœ ê¸°ë™ë¬¼ ë³´í˜¸ì†Œ ìš´ì˜ë¹„',
      category: 'ë™ë¬¼ë³´í˜¸',
      currentAmount: 4200000,
      targetAmount: 8000000,
      dday: 25,
      donors: 189,
      image: 'ğŸ•',
      description: 'ë²„ë ¤ì§„ ë™ë¬¼ë“¤ì—ê²Œ ë”°ëœ»í•œ ë³´ê¸ˆìë¦¬ë¥¼ ì œê³µí•©ë‹ˆë‹¤.',
      organization: 'ë™ë¬¼ì‚¬ë‘í˜‘íšŒ',
      status: 'approved'
    },
    {
      id: 3,
      title: 'ë…ê±°ë…¸ì¸ ìƒí™œ ì§€ì›',
      category: 'ë…¸ì¸ë³µì§€',
      currentAmount: 9800000,
      targetAmount: 10000000,
      dday: 5,
      donors: 412,
      image: 'ğŸ‘´',
      description: 'í™€ë¡œ ê³„ì‹  ì–´ë¥´ì‹ ë“¤ì˜ ì¼ìƒì„ ë•ëŠ” í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.',
      organization: 'ì‹¤ë²„ì¼€ì–´ì„¼í„°',
      status: 'approved'
    },
    {
      id: 4,
      title: 'ì‚°ë¶ˆ í”¼í•´ ì§€ì—­ ë³µêµ¬',
      category: 'í™˜ê²½ë³´í˜¸',
      currentAmount: 12500000,
      targetAmount: 15000000,
      dday: 20,
      donors: 567,
      image: 'ğŸŒ²',
      description: 'ì‚°ë¶ˆë¡œ í”¼í•´ë¥¼ ì…ì€ ì§€ì—­ì˜ ìƒíƒœê³„ ë³µì› í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.',
      organization: 'ë…¹ìƒ‰í™˜ê²½ì¬ë‹¨',
      status: 'approved'
    },
    {
      id: 5,
      title: 'ì €ì†Œë“ì¸µ í•™ìƒ êµìœ¡ë¹„',
      category: 'êµìœ¡',
      currentAmount: 6300000,
      targetAmount: 10000000,
      dday: 30,
      donors: 298,
      image: 'ğŸ“š',
      description: 'ê²½ì œì  ì–´ë ¤ì›€ìœ¼ë¡œ í•™ìŠµ ê¸°íšŒë¥¼ ë†“ì¹˜ëŠ” í•™ìƒë“¤ì„ ìœ„í•œ í”„ë¡œê·¸ë¨ì…ë‹ˆë‹¤.',
      organization: 'êµìœ¡ë‚˜ëˆ”ì¬ë‹¨',
      status: 'pending'
    },
    {
      id: 6,
      title: 'ì†Œì•„ì•” í™˜ì•„ ì¹˜ë£Œë¹„',
      category: 'ì˜ë£Œì§€ì›',
      currentAmount: 18900000,
      targetAmount: 20000000,
      dday: 10,
      donors: 823,
      image: 'ğŸ—ï¸',
      description: 'ì†Œì•„ì•”ìœ¼ë¡œ ê³ í†µë°›ëŠ” ì–´ë¦°ì´ë“¤ì˜ ì¹˜ë£Œë¹„ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.',
      organization: 'ì˜ë£Œë³µì§€ì¬ë‹¨',
      status: 'approved'
    }
  ];

  const favoriteProjects = projects.filter(p => favoriteProjectIds.has(p.id));

  const recentDonations: RecentDonation[] = [
    { name: 'ê¹€ì² ìˆ˜', amount: 50000, project: 'ì†Œì™¸ê³„ì¸µ ì•„ë™ ê¸‰ì‹ ì§€ì›', time: '5ë¶„ ì „' },
    { name: 'ì´ìˆ˜ì¬', amount: 30000, project: 'ìœ ê¸°ë™ë¬¼ ë³´í˜¸ì†Œ ìš´ì˜ë¹„', time: '12ë¶„ ì „' },
    { name: 'ë°•ì •ìš°', amount: 100000, project: 'ë…ê±°ë…¸ì¸ ìƒí™œ ì§€ì›', time: '23ë¶„ ì „' },
    { name: 'ìµœë¯¼ìˆ˜', amount: 20000, project: 'ì‚°ë¶ˆ í”¼í•´ ì§€ì—­ ë³µêµ¬', time: '35ë¶„ ì „' }
  ];

  const [communityPosts, setCommunityPosts] = useState<CommunityPost[]>([
    { 
      id: 1, 
      type: 'ê³µì§€', 
      title: 'í”„ë¡œì íŠ¸ ìŠ¹ì¸ ê¸°ì¤€ ì•ˆë‚´', 
      author: 'ê´€ë¦¬ì', 
      date: '2024-03-15', 
      views: 234,
      comments: [
        { id: 1, author: 'ê¹€ì² ìˆ˜', content: 'ìì„¸í•œ ì•ˆë‚´ ê°ì‚¬í•©ë‹ˆë‹¤!', date: '2024-03-15', replies: [] }
      ]
    },
    { 
      id: 2, 
      type: 'ì§ˆë¬¸', 
      title: 'ê¸°ë¶€ê¸ˆ ì˜ìˆ˜ì¦ì€ ì–´ë–»ê²Œ ë°›ë‚˜ìš”?', 
      author: 'ê¹€ì² ìˆ˜', 
      date: '2024-03-14', 
      views: 89,
      comments: [
        { 
          id: 2, 
          author: 'ê´€ë¦¬ì', 
          content: 'ë§ˆì´í˜ì´ì§€ì—ì„œ ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.', 
          date: '2024-03-14',
          replies: [
            { id: 3, author: 'ê¹€ì² ìˆ˜', content: 'ê°ì‚¬í•©ë‹ˆë‹¤!', date: '2024-03-14', parentId: 2 }
          ]
        }
      ]
    },
    { 
      id: 3, 
      type: 'ê³µì§€', 
      title: '2024 ë‚˜ëˆ” í˜ìŠ¤í‹°ë²Œ ê°œìµœ ì•ˆë‚´', 
      author: 'í¬ë§ë‚˜ëˆ”ì¬ë‹¨', 
      date: '2024-03-13', 
      views: 156,
      comments: []
    },
    { 
      id: 4, 
      type: 'ì‘ì›', 
      title: 'ì•„ë™ ê¸‰ì‹ í”„ë¡œì íŠ¸ ì‘ì›í•©ë‹ˆë‹¤!', 
      author: 'ì´ìˆ˜ì¬', 
      date: '2024-03-12', 
      views: 67,
      comments: []
    }
  ]);

  // Helper Functions
  const formatAmount = (amount: number): string => {
    return amount.toLocaleString('ko-KR');
  };

  const calculatePercentage = (current: number, target: number): number => {
    return Math.round((current / target) * 100);
  };

  // Donation Functions
  const handleDonation = () => {
    const amount = customAmount ? parseInt(customAmount) : donationAmount;
    if (!amount || amount <= 0) {
      alert('ê¸°ë¶€ ê¸ˆì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
      return;
    }
    if (!donorName && !isAnonymous) {
      alert('ê¸°ë¶€ìëª…ì„ ì…ë ¥í•˜ê±°ë‚˜ ìµëª…ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
      return;
    }
    setShowPaymentModal(true);
  };

  const handlePayment = () => {
    if (!paymentMethod) {
      alert('ê²°ì œ ìˆ˜ë‹¨ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
      return;
    }
    alert('ê²°ì œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ê¸°ë¶€í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.');
    setShowPaymentModal(false);
    setShowDonationModal(false);
    setDonationAmount(0);
    setCustomAmount('');
    setDonorName('');
    setIsAnonymous(false);
    setDonationMessage('');
    setPaymentMethod('');
  };

  const handleSettlementRequest = (projectId: number) => {
    if (window.confirm('ì •ì‚°ì„ ìš”ì²­í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
      alert('ì •ì‚° ìš”ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ì ìŠ¹ì¸ í›„ ì²˜ë¦¬ë©ë‹ˆë‹¤.');
    }
  };

  const handleProjectApproval = (projectId: number, approve: boolean) => {
    if (approve) {
      alert('í”„ë¡œì íŠ¸ê°€ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.');
    } else {
      const reason = window.prompt('ë°˜ë ¤ ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”:');
      if (reason) {
        alert('í”„ë¡œì íŠ¸ê°€ ë°˜ë ¤ë˜ì—ˆìŠµë‹ˆë‹¤.');
      }
    }
  };

  // Comment Functions
  const handleAddComment = (postId: number, content: string, parentId?: number) => {
    const newComment: Comment = {
      id: Date.now(),
      author: userProfile.name,
      content,
      date: new Date().toISOString().split('T')[0],
      parentId,
      replies: []
    };

    setCommunityPosts(prev => prev.map(post => {
      if (post.id === postId) {
        const comments = post.comments || [];
        if (parentId) {
          return {
            ...post,
            comments: comments.map(c => 
              c.id === parentId 
                ? { ...c, replies: [...(c.replies || []), newComment] }
                : c
            )
          };
        }
        return { ...post, comments: [...comments, newComment] };
      }
      return post;
    }));

    setCommentText('');
    setReplyingToCommentId(null);
  };

  // Settlement Functions
  const handleApproveSettlement = (requestId: number) => {
    if (!window.confirm('ì •ì‚°ì„ ìŠ¹ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?'))
      return;
    
    setSettlementRequests(prev => prev.map(req =>
      req.id === requestId ? { ...req, status: 'approved' as const } : req
    ));
    
    alert('ì •ì‚°ì´ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.');
  };

  const handleRejectSettlement = (requestId: number) => {
    const reason = window.prompt('ê±°ë¶€ ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”:');
    if (!reason) return;
    
    setSettlementRequests(prev => prev.map(req =>
      req.id === requestId 
        ? { ...req, status: 'rejected' as const, rejectionReason: reason } 
        : req
    ));
    
    alert('ì •ì‚°ì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.');
  };

  // Notification Functions
  const markAsRead = (notificationId: number) => {
    setNotifications(prev => prev.map(n =>
      n.id === notificationId ? { ...n, isRead: true } : n
    ));
  };

  const markAllAsRead = () => {
    setNotifications(prev => prev.map(n => ({ ...n, isRead: true })));
  };

  // Profile Functions
  const handleUpdateProfile = (updatedProfile: UserProfile) => {
    setUserProfile(updatedProfile);
    alert('í”„ë¡œí•„ì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.');
    setCurrentPage('mypage');
  };

  const handleChangePassword = (currentPassword: string, newPassword: string, confirmPassword: string) => {
    if (newPassword !== confirmPassword) {
      alert('ìƒˆ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
      return;
    }
    if (newPassword.length < 8) {
      alert('ë¹„ë°€ë²ˆí˜¸ëŠ” 8ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
      return;
    }
    alert('ë¹„ë°€ë²ˆí˜¸ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.');
    setShowPasswordModal(false);
  };

  // Logout Function
  const handleLogout = () => {
    setIsLoggedIn(false);
    setUserType('individual');
    setCurrentPage('home');
    // JWT í† í° ì œê±°
    if (typeof window !== 'undefined') {
      window.localStorage.removeItem('jwt_token');
      window.localStorage.removeItem('user_type');
      window.localStorage.removeItem('remember_me');
    }
    alert('ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤.');
  };

// ============================================
// 4. handleLogin í•¨ìˆ˜ ì¶”ê°€ (handleLogout í•¨ìˆ˜ ì•„ë˜ì—)
// ============================================
  const handleLogin = (email: string, password: string, remember: boolean) => {
    // ê³„ì • ì ê¸ˆ í™•ì¸
    if (lockedAccounts.has(email)) {
      alert('ê³„ì •ì´ ì ê²¼ìŠµë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•´ì£¼ì„¸ìš”.');
      return;
    }

    // ë°ëª¨ ê³„ì • í™•ì¸ (ì‹¤ì œë¡œëŠ” ë°±ì—”ë“œ API í˜¸ì¶œ)
    const demoAccounts = {
      'user@example.com': { password: 'password123', type: 'individual' as UserType },
      'org@example.com': { password: 'password123', type: 'organization' as UserType },
      'admin@example.com': { password: 'admin123', type: 'admin' as UserType }
    };

    const account = demoAccounts[email as keyof typeof demoAccounts];
    
    if (account && account.password === password) {
      // ë¡œê·¸ì¸ ì„±ê³µ
      setIsLoggedIn(true);
      setUserType(account.type);
      setCurrentPage('home');
      
      // JWT í† í° ìƒì„± ì‹œë®¬ë ˆì´ì…˜
      const mockToken = btoa(JSON.stringify({
        email,
        type: account.type,
        exp: Date.now() + (remember ? 30 * 24 * 60 * 60 * 1000 : 24 * 60 * 60 * 1000)
      }));
      
      if (typeof window !== 'undefined') {
        window.localStorage.setItem('jwt_token', mockToken);
        window.localStorage.setItem('user_type', account.type);
        if (remember) {
          window.localStorage.setItem('remember_me', 'true');
        }
      }
      
      // ë¡œê·¸ì¸ ì‹œë„ íšŸìˆ˜ ì´ˆê¸°í™”
      const newAttempts = new Map(loginAttempts);
      newAttempts.delete(email);
      setLoginAttempts(newAttempts);
      
      alert(`${account.type === 'admin' ? 'ê´€ë¦¬ì' : account.type === 'organization' ? 'ê¸°ê´€' : 'ì¼ë°˜'} ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.`);
      
      // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
      setLoginEmail('');
      setLoginPassword('');
    } else {
      // ë¡œê·¸ì¸ ì‹¤íŒ¨
      const attempts = (loginAttempts.get(email) || 0) + 1;
      const newAttempts = new Map(loginAttempts);
      newAttempts.set(email, attempts);
      setLoginAttempts(newAttempts);
      
      if (attempts >= 5) {
        // ê³„ì • ì ê¸ˆ
        const newLocked = new Set(lockedAccounts);
        newLocked.add(email);
        setLockedAccounts(newLocked);
        alert('ë¹„ë°€ë²ˆí˜¸ë¥¼ 5íšŒ ì˜ëª» ì…ë ¥í•˜ì—¬ ê³„ì •ì´ ì ê²¼ìŠµë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•´ì£¼ì„¸ìš”.');
      } else {
        alert(`ë¡œê·¸ì¸ ì‹¤íŒ¨. (${attempts}/5íšŒ ì‹œë„)\nì´ë©”ì¼ ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.`);
      }
    }
  };

// ============================================
// 5. LoginPage ì»´í¬ë„ŒíŠ¸ ì¶”ê°€ (ë‹¤ë¥¸ í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸ë“¤ê³¼ ê°™ì€ ìœ„ì¹˜ì—)
// ============================================
  const LoginPage: React.FC = () => (
    <div className="bg-gray-50 min-h-screen flex items-center justify-center py-12 px-4">
      <div className="bg-white rounded-2xl p-12 w-full max-w-md border border-gray-200 shadow-lg relative">
        <button
          onClick={() => setCurrentPage('home')}
          className="absolute top-6 left-6 text-gray-600 hover:text-gray-900 font-semibold"
        >
          â† í™ˆìœ¼ë¡œ
        </button>
        <div className="text-center mb-8">
          <div className="flex items-center justify-center gap-2 mb-4">
            <Heart className="text-red-500" size={40} fill="currentColor" />
          </div>
          <h1 className="text-4xl font-bold mb-2">ë¡œê·¸ì¸</h1>
          <p className="text-gray-600">ë”°ëœ»í•œ ë‚˜ëˆ”ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤</p>
        </div>

        <div className="space-y-5">
          <div>
            <label className="block text-sm font-bold text-gray-700 mb-2">ì´ë©”ì¼</label>
            <input 
              type="email" 
              placeholder="example@email.com"
              value={loginEmail}
              onChange={(e) => setLoginEmail(e.target.value)}
              className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500"
              onKeyPress={(e) => {
                if (e.key === 'Enter') {
                  handleLogin(loginEmail, loginPassword, rememberMe);
                }
              }}
            />
          </div>

          <div>
            <label className="block text-sm font-bold text-gray-700 mb-2">ë¹„ë°€ë²ˆí˜¸</label>
            <input 
              type="password" 
              placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
              value={loginPassword}
              onChange={(e) => setLoginPassword(e.target.value)}
              className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500"
              onKeyPress={(e) => {
                if (e.key === 'Enter') {
                  handleLogin(loginEmail, loginPassword, rememberMe);
                }
              }}
            />
          </div>

          <div className="flex items-center justify-between">
            <label className="flex items-center gap-2 cursor-pointer">
              <input 
                type="checkbox" 
                checked={rememberMe}
                onChange={(e) => setRememberMe(e.target.checked)}
                className="w-4 h-4 text-red-500 border-gray-300 rounded focus:ring-red-500"
              />
              <span className="text-sm text-gray-700">ë¡œê·¸ì¸ ìœ ì§€</span>
            </label>
            <button className="text-sm text-red-500 hover:underline">
              ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°
            </button>
          </div>

          <button 
            onClick={() => handleLogin(loginEmail, loginPassword, rememberMe)}
            className="w-full py-4 bg-red-500 text-white rounded-lg font-bold text-lg hover:bg-red-600 transition-all"
          >
            ë¡œê·¸ì¸
          </button>

          <div className="text-center">
            <span className="text-gray-600">ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”? </span>
            <button 
              onClick={() => setCurrentPage('signup')}
              className="text-red-500 font-semibold hover:underline"
            >
              íšŒì›ê°€ì…
            </button>
          </div>
        </div>

        {/* ë°ëª¨ ê³„ì • ì•ˆë‚´ */}
        <div className="mt-8 p-4 bg-blue-50 rounded-lg border border-blue-200">
          <p className="text-sm font-bold text-blue-900 mb-2">ğŸ’¡ ë°ëª¨ ê³„ì • ì•ˆë‚´</p>
          <div className="text-xs text-blue-800 space-y-1">
            <p>â€¢ ì¼ë°˜ íšŒì›: user@example.com / password123</p>
            <p>â€¢ ê¸°ê´€ íšŒì›: org@example.com / password123</p>
            <p>â€¢ ê´€ë¦¬ì: admin@example.com / admin123</p>
          </div>
        </div>
      </div>
    </div>
  );


  // Components
  const Header: React.FC = () => (
    <header className="bg-white border-b border-gray-200 sticky top-0 z-50">
      <div className="max-w-[1400px] mx-auto px-8 py-5 flex items-center justify-between">
        <div
          className="flex items-center gap-2 cursor-pointer"
          onClick={() => setCurrentPage('home')}
        >
          <Heart className="text-red-500" size={32} fill="currentColor" />
          <span className="text-2xl font-bold">ìœ„ë„¥íŠ¸</span>
        </div>

        <nav className="flex items-center gap-8">
          <button 
            onClick={() => setCurrentPage('projects')}
            className="text-lg font-semibold hover:text-red-500 transition-colors"
          >
            í”„ë¡œì íŠ¸
          </button>
          <button 
            onClick={() => setCurrentPage('community')}
            className="text-lg font-semibold hover:text-red-500 transition-colors"
          >
            ì»¤ë®¤ë‹ˆí‹°
          </button>
          {isLoggedIn && userType === 'admin' && (
            <button 
              onClick={() => setCurrentPage('admin')}
              className="text-lg font-semibold hover:text-red-500 transition-colors"
            >
              ê´€ë¦¬ì
            </button>
          )}
        </nav>

        <div className="flex items-center gap-4">
          {isLoggedIn ? (
            <>
              <button 
                onClick={() => setCurrentPage('notifications')}
                className="relative p-2 hover:bg-gray-100 rounded-full transition-colors"
              >
                <Bell size={24} />
                {notifications.filter(n => !n.isRead).length > 0 && (
                  <span className="absolute top-0 right-0 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center">
                    {notifications.filter(n => !n.isRead).length}
                  </span>
                )}
              </button>
              <button 
                onClick={() => setCurrentPage('mypage')}
                className="flex items-center gap-2 px-4 py-2 hover:bg-gray-100 rounded-lg transition-colors"
              >
                <User size={24} />
                <span className="font-semibold">{userProfile.name}</span>
              </button>
              <button 
                onClick={handleLogout}
                className="p-2 hover:bg-gray-100 rounded-full transition-colors"
                title="ë¡œê·¸ì•„ì›ƒ"
              >
                <LogOut size={24} />
              </button>
            </>
          ) : (
            <button 
              onClick={() => setCurrentPage('login')}
              className="px-6 py-3 font-semibold hover:bg-gray-100 rounded-lg transition-colors"
            >
              ë¡œê·¸ì¸
              </button>
          )}
        </div>
      </div>
    </header>
  );

  // DonationModal component is now imported from ./components/donation/DonationModal.tsx

  const PaymentModal: React.FC = () => (
    <div className="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
      <div className="max-w-lg w-full bg-white rounded-2xl p-8">
        <div className="flex items-center justify-between mb-6">
          <h2 className="text-2xl font-bold">ê²°ì œ ìˆ˜ë‹¨ ì„ íƒ</h2>
          <button 
            onClick={() => setShowPaymentModal(false)} 
            className="text-gray-400 hover:text-gray-600"
          >
            <X size={24} />
          </button>
        </div>

        <div className="mb-6 p-4 bg-gray-50 rounded-lg">
          <div className="flex justify-between items-center">
            <span className="text-gray-600">ê²°ì œ ê¸ˆì•¡</span>
            <span className="text-2xl font-bold text-red-500">
              {formatAmount(customAmount ? parseInt(customAmount) : donationAmount)}ì›
            </span>
          </div>
        </div>

        <div className="space-y-3 mb-6">
          <button
            onClick={() => setPaymentMethod('card')}
            className={`w-full p-4 rounded-lg border-2 transition-all flex items-center gap-3 ${
              paymentMethod === 'card'
                ? 'border-red-500 bg-red-50'
                : 'border-gray-300 hover:border-red-500'
            }`}
          >
            <CreditCard size={24} />
            <div className="text-left">
              <div className="font-bold">ì‹ ìš©/ì²´í¬ì¹´ë“œ</div>
              <div className="text-sm text-gray-600">ê°„í¸í•˜ê²Œ ì¹´ë“œë¡œ ê²°ì œ</div>
            </div>
          </button>

          <button
            onClick={() => setPaymentMethod('transfer')}
            className={`w-full p-4 rounded-lg border-2 transition-all flex items-center gap-3 ${
              paymentMethod === 'transfer'
                ? 'border-red-500 bg-red-50'
                : 'border-gray-300 hover:border-red-500'
            }`}
          >
            <Building size={24} />
            <div className="text-left">
              <div className="font-bold">ê³„ì¢Œì´ì²´</div>
              <div className="text-sm text-gray-600">ì€í–‰ ê³„ì¢Œë¡œ ì´ì²´</div>
            </div>
          </button>

          <button
            onClick={() => setPaymentMethod('simple')}
            className={`w-full p-4 rounded-lg border-2 transition-all flex items-center gap-3 ${
              paymentMethod === 'simple'
                ? 'border-red-500 bg-red-50'
                : 'border-gray-300 hover:border-red-500'
            }`}
          >
            <DollarSign size={24} />
            <div className="text-left">
              <div className="font-bold">ê°„í¸ê²°ì œ</div>
              <div className="text-sm text-gray-600">í† ìŠ¤, ì¹´ì¹´ì˜¤í˜ì´ ë“±</div>
            </div>
          </button>
        </div>

        <button
          onClick={handlePayment}
          disabled={!paymentMethod}
          className="w-full py-4 bg-red-500 text-white rounded-lg font-bold text-lg hover:bg-red-600 transition-all disabled:bg-gray-300 disabled:cursor-not-allowed"
        >
          ê²°ì œí•˜ê¸°
        </button>
      </div>
    </div>
  );

  const LoginModal: React.FC = () => (
    <div className="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
      <div className="max-w-md w-full bg-white rounded-2xl p-8">
        <div className="flex items-center justify-between mb-8">
          <h2 className="text-3xl font-bold">ë¡œê·¸ì¸</h2>
          <button 
            onClick={() => setShowLoginModal(false)}
            className="text-gray-400 hover:text-gray-600"
          >
            <X size={24} />
          </button>
        </div>

        <div className="grid grid-cols-3 gap-3 mb-6">
          <button 
            onClick={() => setSelectedLoginType('individual')}
            className={`py-3 rounded-lg font-semibold transition-all ${
              selectedLoginType === 'individual' 
                ? 'bg-red-500 text-white' 
                : 'border border-gray-300 text-gray-700 hover:border-red-500'
            }`}
          >
            ì¼ë°˜ íšŒì›
          </button>
          <button 
            onClick={() => setSelectedLoginType('organization')}
            className={`py-3 rounded-lg font-semibold transition-all ${
              selectedLoginType === 'organization' 
                ? 'bg-red-500 text-white' 
                : 'border border-gray-300 text-gray-700 hover:border-red-500'
            }`}
          >
            ê¸°ê´€ íšŒì›
          </button>
          <button 
            onClick={() => setSelectedLoginType('admin')}
            className={`py-3 rounded-lg font-semibold transition-all ${
              selectedLoginType === 'admin' 
                ? 'bg-red-500 text-white' 
                : 'border border-gray-300 text-gray-700 hover:border-red-500'
            }`}
          >
            ê´€ë¦¬ì
          </button>
        </div>

        <div className="space-y-4 mb-6">
          <input 
            type="email" 
            placeholder="example@email.com"
            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500"
          />
          <input 
            type="password" 
            placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500"
          />
        </div>

        <button 
          onClick={() => {
            setIsLoggedIn(true);
            setUserType(selectedLoginType);
            setShowLoginModal(false);
          }}
          className="w-full py-4 bg-red-500 text-white rounded-lg font-bold text-lg hover:bg-red-600 transition-all"
        >
          ë¡œê·¸ì¸
        </button>

        <div className="mt-6 text-center">
          <span className="text-gray-600">ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”? </span>
          <button 
            onClick={() => {
              setShowLoginModal(false);
              setCurrentPage('signup');
            }}
            className="text-red-500 font-bold hover:underline"
          >
            íšŒì›ê°€ì…
          </button>
        </div>
      </div>
    </div>
  );

  const PasswordChangeModal: React.FC = () => {
    const [currentPassword, setCurrentPassword] = useState('');
    const [newPassword, setNewPassword] = useState('');
    const [confirmPassword, setConfirmPassword] = useState('');

    return (
      <div className="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
        <div className="max-w-md w-full bg-white rounded-2xl p-8">
          <div className="flex items-center justify-between mb-8">
            <h2 className="text-2xl font-bold">ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</h2>
            <button 
              onClick={() => setShowPasswordModal(false)}
              className="text-gray-400 hover:text-gray-600"
            >
              <X size={24} />
            </button>
          </div>

          <div className="space-y-4">
            <div>
              <label className="block text-sm font-bold text-gray-700 mb-2">í˜„ì¬ ë¹„ë°€ë²ˆí˜¸</label>
              <input 
                type="password"
                value={currentPassword}
                onChange={(e) => setCurrentPassword(e.target.value)}
                className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500"
              />
            </div>
            <div>
              <label className="block text-sm font-bold text-gray-700 mb-2">ìƒˆ ë¹„ë°€ë²ˆí˜¸</label>
              <input 
                type="password"
                value={newPassword}
                onChange={(e) => setNewPassword(e.target.value)}
                className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500"
              />
            </div>
            <div>
              <label className="block text-sm font-bold text-gray-700 mb-2">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
              <input 
                type="password"
                value={confirmPassword}
                onChange={(e) => setConfirmPassword(e.target.value)}
                className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500"
              />
            </div>
          </div>

          <button 
            onClick={() => handleChangePassword(currentPassword, newPassword, confirmPassword)}
            className="w-full mt-6 py-4 bg-red-500 text-white rounded-lg font-bold text-lg hover:bg-red-600 transition-all"
          >
            ë³€ê²½í•˜ê¸°
          </button>
        </div>
      </div>
    );
  };

  // HomePage component is now imported from ./pages/HomePage.tsx

// ============================================
// 4. ProjectsPage ì»´í¬ë„ŒíŠ¸ ìˆ˜ì • - í•˜íŠ¸ ë²„íŠ¼ ì¶”ê°€
// ============================================
// ProjectsPage ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì˜ í”„ë¡œì íŠ¸ ì¹´ë“œ ë¶€ë¶„ì„ ìˆ˜ì •
// ê¸°ì¡´ ì¹´ë“œ êµ¬ì¡°ì—ì„œ ì´ë¯¸ì§€ ë¶€ë¶„ì— í•˜íŠ¸ ë²„íŠ¼ ì¶”ê°€

  const ProjectsPage: React.FC = () => {
    const displayProjects = getFilteredAndSortedProjects();

    return (
      <div className="bg-gray-50 min-h-screen">
        <div className="max-w-[1400px] mx-auto px-8 py-12">
          <h1 className="text-5xl font-bold mb-10">í”„ë¡œì íŠ¸ ë‘˜ëŸ¬ë³´ê¸°</h1>

          <div className="flex gap-4 mb-8">
            {/* ê²€ìƒ‰ì°½ - ë™ì‘ ì•ˆí•¨ (ë‚˜ì¤‘ì— êµ¬í˜„) */}
            <div className="relative flex-1">
              <Search className="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400" size={20} />
              <input
                type="text"
                placeholder="í”„ë¡œì íŠ¸ ê²€ìƒ‰..."
                className="w-full pl-12 pr-4 py-4 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500"
                disabled
              />
            </div>

            {/* ì¹´í…Œê³ ë¦¬ í•„í„° - ë™ì‘í•¨ */}
            <select
              value={selectedCategory}
              onChange={(e) => setSelectedCategory(e.target.value)}
              className="px-6 py-4 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500 cursor-pointer"
            >
              <option>ì „ì²´</option>
              <option>ì•„ë™ë³µì§€</option>
              <option>ë…¸ì¸ë³µì§€</option>
              <option>ë™ë¬¼ë³´í˜¸</option>
              <option>í™˜ê²½ë³´í˜¸</option>
              <option>ì˜ë£Œì§€ì›</option>
              <option>êµìœ¡</option>
            </select>

            {/* ì •ë ¬ ì˜µì…˜ - ë™ì‘í•¨ */}
            <select
              value={sortOption}
              onChange={(e) => setSortOption(e.target.value)}
              className="px-6 py-4 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500 cursor-pointer"
            >
              <option>ìµœì‹ ìˆœ</option>
              <option>ë§ˆê°ì„ë°•ìˆœ</option>
              <option>ëª¨ê¸ˆë¥ ìˆœ</option>
            </select>
          </div>

          {/* í•„í„° ê²°ê³¼ í‘œì‹œ */}
          {selectedCategory !== 'ì „ì²´' && (
            <div className="mb-6">
              <p className="text-gray-600">
                <span className="font-bold text-gray-900">{selectedCategory}</span> ì¹´í…Œê³ ë¦¬
                <span className="font-bold text-red-500 ml-2">{displayProjects.length}ê°œ</span>
              </p>
            </div>
          )}

          {/* í•„í„° ê²°ê³¼ ì—†ì„ ë•Œ */}
          {displayProjects.length === 0 ? (
            <div className="text-center py-20">
              <FileText className="mx-auto text-gray-300 mb-4" size={64} />
              <p className="text-gray-500 text-lg mb-4">
                í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì— í”„ë¡œì íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.
              </p>
              <button
                onClick={() => setSelectedCategory('ì „ì²´')}
                className="px-6 py-3 bg-red-500 text-white rounded-lg font-bold hover:bg-red-600"
              >
                ì „ì²´ í”„ë¡œì íŠ¸ ë³´ê¸°
              </button>
            </div>
          ) : (
            <div className="grid grid-cols-4 gap-6">
              {displayProjects.map(project => {
            const progress = calculatePercentage(project.currentAmount, project.targetAmount);
            const isFavorite = favoriteProjectIds.has(project.id);
            
            return (
              <div 
                key={project.id}
                className="border border-gray-200 rounded-xl overflow-hidden hover:shadow-lg transition-shadow bg-white relative"
              >
                {/* í•˜íŠ¸ ë²„íŠ¼ ì¶”ê°€ */}
                <button
                  onClick={(e) => {
                    e.stopPropagation(); // ì¹´ë“œ í´ë¦­ ì´ë²¤íŠ¸ ë°©ì§€
                    if (!isLoggedIn) {
                      alert('ë¡œê·¸ì¸ì´ í•„ìš”í•œ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.');
                      setCurrentPage('login');
                    } else {
                      toggleFavoriteProject(project.id);
                    }
                  }}
                  className="absolute top-4 right-4 z-10 p-2 bg-white rounded-full shadow-lg hover:scale-110 transition-transform"
                >
                  <Heart 
                    size={24} 
                    className={isFavorite ? 'text-red-500' : 'text-gray-400'}
                    fill={isFavorite ? 'currentColor' : 'none'}
                  />
                </button>

                <div 
                  className="cursor-pointer"
                  onClick={() => {
                    setSelectedProject(project);
                    setActiveTab('intro');
                    setCurrentPage('detail');
                  }}
                >
                  <div className="h-48 bg-gradient-to-br from-red-100 to-pink-100 flex items-center justify-center text-7xl">
                    {project.image}
                  </div>
                  <div className="p-5">
                    <div className="text-sm text-red-500 font-semibold mb-2">{project.category}</div>
                    <h4 className="text-lg font-bold mb-3 line-clamp-2">{project.title}</h4>

                    <div className="mb-4">
                      <div className="flex justify-between text-sm mb-2">
                        <span className="font-bold text-red-500">{progress}%</span>
                        <span className="text-gray-600">D-{project.dday}</span>
                      </div>
                      <div className="w-full bg-gray-200 rounded-full h-2">
                        <div 
                          className="bg-red-500 h-2 rounded-full"
                          style={{ width: `${progress}%` }}
                        ></div>
                      </div>
                    </div>

                    <div className="flex justify-between text-sm text-gray-600">
                      <span>{formatAmount(project.currentAmount)}ì›</span>
                      <span>{project.donors}ëª… ì°¸ì—¬</span>
                    </div>
                  </div>
                </div>
              </div>
            );
              })}
            </div>
          )}
        </div>
      </div>
    );
  };

// ============================================
// 5. ProjectDetailPage ì»´í¬ë„ŒíŠ¸ ìˆ˜ì • - ê´€ì‹¬ í”„ë¡œì íŠ¸ ë²„íŠ¼ ì¶”ê°€
// ============================================
// ProjectDetailPage ë‚´ë¶€ì˜ ì˜¤ë¥¸ìª½ ì‚¬ì´ë“œë°”ì— í•˜íŠ¸ ë²„íŠ¼ ì¶”ê°€
// ê¸°ì¡´ "ê¸°ë¶€í•˜ê¸°" ë²„íŠ¼ ìœ„ì— ì¶”ê°€
  const ProjectDetailPage: React.FC = () => {
    if (!selectedProject) return <ProjectsPage />;
    
    const progress = calculatePercentage(selectedProject.currentAmount, selectedProject.targetAmount);
    const isFavorite = favoriteProjectIds.has(selectedProject.id);

    const renderTabContent = () => {
      switch (activeTab) {
        case 'intro':
          return (
            <div className="prose max-w-none">
              <p className="text-gray-700 text-lg leading-relaxed mb-6">
                {selectedProject.description}
              </p>
              <h3 className="text-2xl font-bold mb-4">í”„ë¡œì íŠ¸ ìƒì„¸ ë‚´ìš©</h3>
              <p className="text-gray-700 leading-relaxed mb-6">
                ì´ í”„ë¡œì íŠ¸ëŠ” ìš°ë¦¬ ì‚¬íšŒì˜ ì†Œì™¸ëœ ì´ì›ƒë“¤ì—ê²Œ ì‹¤ì§ˆì ì¸ ë„ì›€ì„ ì œê³µí•˜ê¸° ìœ„í•´ ê¸°íšë˜ì—ˆìŠµë‹ˆë‹¤. 
                ì—¬ëŸ¬ë¶„ì˜ ì†Œì¤‘í•œ ê¸°ë¶€ê¸ˆì€ íˆ¬ëª…í•˜ê²Œ ê´€ë¦¬ë˜ë©°, ì •ì‚° ê³¼ì •ì„ í†µí•´ 
                í•„ìš”í•œ ê³³ì— ì •í™•íˆ ì „ë‹¬ë©ë‹ˆë‹¤.
              </p>
            </div>
          );
        case 'progress':
          return (
            <div className="space-y-6">
              <div className="p-6 bg-gray-50 rounded-lg">
                <h4 className="font-bold text-lg mb-4">ëª¨ê¸ˆ ì§„í–‰ í˜„í™©</h4>
                <div className="grid grid-cols-2 gap-4">
                  <div className="p-4 bg-white rounded-lg">
                    <p className="text-sm text-gray-600 mb-1">í˜„ì¬ ëª¨ê¸ˆì•¡</p>
                    <p className="text-xl font-bold">{formatAmount(selectedProject.currentAmount)}ì›</p>
                  </div>
                  <div className="p-4 bg-white rounded-lg">
                    <p className="text-sm text-gray-600 mb-1">ëª©í‘œ ê¸ˆì•¡</p>
                    <p className="text-xl font-bold">{formatAmount(selectedProject.targetAmount)}ì›</p>
                  </div>
                </div>
              </div>
            </div>
          );
        case 'donors':
          return (
            <div>
              <h4 className="font-bold text-lg mb-4">ê¸°ë¶€ì ëª…ë‹¨ (ì´ {selectedProject.donors}ëª…)</h4>
              <div className="space-y-3">
                {[
                  { name: 'ê¹€ì² ìˆ˜', amount: 50000, date: '2024-03-15' },
                  { name: 'ì´ìˆ˜ì¬', amount: 30000, date: '2024-03-14' },
                  { name: 'ë°•ì •ìš°', amount: 100000, date: '2024-03-13' }
                ].map((donor, idx) => (
                  <div key={idx} className="flex items-center justify-between p-5 bg-gray-50 rounded-lg">
                    <div>
                      <p className="font-bold">{donor.name}</p>
                      <p className="text-sm text-gray-500">{donor.date}</p>
                    </div>
                    <span className="text-red-500 font-bold">{formatAmount(donor.amount)}ì›</span>
                  </div>
                ))}
              </div>
            </div>
          );
        case 'messages':
          return (
            <div>
              <h4 className="font-bold text-lg mb-4">ì‘ì› ë©”ì‹œì§€</h4>
              <div className="space-y-4">
                {[
                  { name: 'ê¹€ì² ìˆ˜', message: 'ì¢‹ì€ í™œë™ ì‘ì›í•©ë‹ˆë‹¤!', date: '2024-03-15' },
                  { name: 'ì´ìˆ˜ì¬', message: 'í•¨ê»˜ ë§Œë“œëŠ” ë”°ëœ»í•œ ì„¸ìƒ!', date: '2024-03-14' }
                ].map((msg, idx) => (
                  <div key={idx} className="p-5 bg-gray-50 rounded-lg">
                    <div className="flex items-center justify-between mb-3">
                      <span className="font-bold">{msg.name}</span>
                      <span className="text-sm text-gray-500">{msg.date}</span>
                    </div>
                    <p className="text-gray-700">{msg.message}</p>
                  </div>
                ))}
              </div>
            </div>
          );
        default:
          return <div />;
      }
    };

    return (
      <div className="bg-gray-50 min-h-screen">
        <div className="max-w-[1400px] mx-auto px-8 py-12">
          <button 
            onClick={() => setCurrentPage('projects')}
            className="mb-8 text-gray-600 hover:text-gray-900 font-semibold"
          >
            â† ëª©ë¡ìœ¼ë¡œ
          </button>

          <div className="grid grid-cols-3 gap-8">
            <div className="col-span-2">
              <div className="bg-white border border-gray-200 rounded-xl overflow-hidden">
                <div className="h-96 bg-gradient-to-br from-red-100 to-pink-100 flex items-center justify-center text-9xl">
                  {selectedProject.image}
                </div>
                
                <div className="p-8">
                  <div className="flex items-center gap-3 mb-4">
                    <span className="px-3 py-1 bg-red-50 text-red-500 rounded-full text-sm font-bold">
                      {selectedProject.category}
                    </span>
                    <span className="text-gray-600">{selectedProject.organization}</span>
                  </div>
                  
                  <h1 className="text-4xl font-bold mb-6">{selectedProject.title}</h1>
                  
                  <div className="flex gap-8 mb-8 border-b border-gray-200">
                    <button 
                      onClick={() => setActiveTab('intro')}
                      className={`pb-3 font-bold transition-colors ${
                        activeTab === 'intro' 
                          ? 'text-red-500 border-b-2 border-red-500' 
                          : 'text-gray-600 hover:text-gray-900'
                      }`}
                    >
                      í”„ë¡œì íŠ¸ ì†Œê°œ
                    </button>
                    <button 
                      onClick={() => setActiveTab('progress')}
                      className={`pb-3 font-bold transition-colors ${
                        activeTab === 'progress' 
                          ? 'text-red-500 border-b-2 border-red-500' 
                          : 'text-gray-600 hover:text-gray-900'
                      }`}
                    >
                      ì§„í–‰ í˜„í™©
                    </button>
                    <button 
                      onClick={() => setActiveTab('donors')}
                      className={`pb-3 font-bold transition-colors ${
                        activeTab === 'donors' 
                          ? 'text-red-500 border-b-2 border-red-500' 
                          : 'text-gray-600 hover:text-gray-900'
                      }`}
                    >
                      ê¸°ë¶€ì í˜„í™©
                    </button>
                    <button 
                      onClick={() => setActiveTab('messages')}
                      className={`pb-3 font-bold transition-colors ${
                        activeTab === 'messages' 
                          ? 'text-red-500 border-b-2 border-red-500' 
                          : 'text-gray-600 hover:text-gray-900'
                      }`}
                    >
                      ì‘ì› ë©”ì‹œì§€
                    </button>
                  </div>

                  <div className="py-4">
                    {renderTabContent()}
                  </div>
                </div>
              </div>
            </div>

            <div>
              <div className="bg-white border border-gray-200 rounded-xl p-6 sticky top-8">
                <div className="mb-6">
                  <div className="flex justify-between items-center mb-3">
                    <span className="text-4xl font-bold text-red-500">{progress}%</span>
                    <span className="px-3 py-1 bg-red-50 text-red-500 font-bold rounded-full">
                      D-{selectedProject.dday}
                    </span>
                  </div>
                  <div className="w-full bg-gray-200 rounded-full h-3 mb-6">
                    <div 
                      className="bg-red-500 h-3 rounded-full"
                      style={{ width: `${progress}%` }}
                    ></div>
                  </div>
                </div>

                <div className="space-y-4 mb-6 pb-6 border-b border-gray-200">
                  <div className="flex justify-between">
                    <span className="text-gray-600">í˜„ì¬ ëª¨ê¸ˆì•¡</span>
                    <span className="text-2xl font-bold text-gray-900">
                      {formatAmount(selectedProject.currentAmount)}ì›
                    </span>
                  </div>
                  <div className="flex justify-between">
                    <span className="text-gray-600">ëª©í‘œ ê¸ˆì•¡</span>
                    <span className="font-semibold text-gray-600">
                      {formatAmount(selectedProject.targetAmount)}ì›
                    </span>
                  </div>
                  <div className="flex justify-between">
                    <span className="text-gray-600">ì°¸ì—¬ ì¸ì›</span>
                    <span className="font-semibold flex items-center gap-1">
                      <Users size={18} />
                      {selectedProject.donors}ëª…
                    </span>
                  </div>
                </div>

                <button 
                  onClick={() => {
                    if (!isLoggedIn) {
                      alert('ë¡œê·¸ì¸ì´ í•„ìš”í•œ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.');
                      setCurrentPage('login');
                    } else {
                      toggleFavoriteProject(selectedProject.id);
                    }
                  }}
                  className={`w-full py-4 rounded-lg font-bold text-lg mb-3 transition-all flex items-center justify-center gap-2 ${
                    isFavorite 
                      ? 'bg-red-50 text-red-500 border-2 border-red-500 hover:bg-red-100' 
                      : 'bg-gray-100 text-gray-700 border-2 border-gray-300 hover:bg-gray-200'
                  }`}
                >
                  <Heart 
                    size={20} 
                    fill={isFavorite ? 'currentColor' : 'none'}
                  />
                  {isFavorite ? 'ê´€ì‹¬ í”„ë¡œì íŠ¸ ë“±ë¡ë¨' : 'ê´€ì‹¬ í”„ë¡œì íŠ¸ ë“±ë¡'}
                </button>

                <button 
                  onClick={() => {
                    if (!isLoggedIn) {
                      setShowLoginModal(true);
                    } else {
                      setShowDonationModal(true);
                    }
                  }}
                  className="w-full py-4 bg-red-500 text-white rounded-lg font-bold text-lg hover:bg-red-600 transition-all mb-3"
                >
                  ê¸°ë¶€í•˜ê¸°
                </button>

                {/* SNS ê³µìœ  ë²„íŠ¼ë“¤ */}
                <div className="flex gap-2">
                  <button
                    onClick={() => shareToSNS('facebook', selectedProject.title)}
                    className="flex-1 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center justify-center gap-2"
                  >
                    <Share2 size={20} />
                    Facebook
                  </button>
                  <button
                    onClick={() => shareToSNS('twitter', selectedProject.title)}
                    className="flex-1 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center justify-center gap-2"
                  >
                    <Share2 size={20} />
                    Twitter
                  </button>
                  <button
                    onClick={() => copyToClipboard(window.location.href)}
                    className="flex-1 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center justify-center gap-2"
                  >
                    <Share2 size={20} />
                    ë§í¬ ë³µì‚¬
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    );
  };

// ============================================
// 5. SignupPage ì»´í¬ë„ŒíŠ¸ - ê¸°ì¡´ ê²ƒì„ ì•„ë˜ë¡œ ì™„ì „íˆ êµì²´
// ============================================
  const SignupPage: React.FC = () => (
    <div className="bg-gray-50 min-h-screen py-16">
      <div className="max-w-3xl mx-auto px-8">
        <button
          onClick={() => setCurrentPage('login')}
          className="mb-8 text-gray-600 hover:text-gray-900 font-semibold"
        >
          â† ë¡œê·¸ì¸ìœ¼ë¡œ
        </button>
        <div className="bg-white rounded-2xl p-12 border border-gray-200">
          <h1 className="text-5xl font-bold mb-10">íšŒì›ê°€ì…</h1>

          <div className="flex gap-4 mb-10">
            <button
              onClick={() => {
                setSignupType('individual');
                setUploadedFile(null);
              }}
              className={`flex-1 py-4 rounded-lg font-bold text-lg transition-all ${
                signupType === 'individual'
                  ? 'bg-red-500 text-white'
                  : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
              }`}
            >
              ì¼ë°˜ íšŒì›
            </button>
            <button
              onClick={() => setSignupType('organization')}
              className={`flex-1 py-4 rounded-lg font-bold text-lg transition-all ${
                signupType === 'organization'
                  ? 'bg-red-500 text-white'
                  : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
              }`}
            >
              ê¸°ê´€ íšŒì›
            </button>
          </div>

          <div className="space-y-6">
            {/* ì´ë©”ì¼ ì…ë ¥ + ì¤‘ë³µ í™•ì¸ */}
            <div>
              <label className="block text-sm font-bold text-gray-700 mb-2">
                ì´ë©”ì¼ <span className="text-red-500">*</span>
              </label>
              <div className="flex gap-2">
                <input
                  type="email"
                  placeholder="example@email.com"
                  value={signupEmail}
                  onChange={(e) => {
                    setSignupEmail(e.target.value);
                    setIsEmailChecked(false);
                    setIsEmailAvailable(false);
                  }}
                  className="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500"
                />
                <button
                  onClick={() => checkEmailDuplicate(signupEmail)}
                  className="px-6 py-3 bg-gray-800 text-white rounded-lg font-bold hover:bg-gray-900 transition-all whitespace-nowrap"
                >
                  ì¤‘ë³µ í™•ì¸
                </button>
              </div>
              {isEmailChecked && (
                <p className={`text-sm mt-2 ${isEmailAvailable ? 'text-green-600' : 'text-red-600'}`}>
                  {isEmailAvailable ? 'âœ“ ì‚¬ìš© ê°€ëŠ¥í•œ ì´ë©”ì¼ì…ë‹ˆë‹¤.' : 'âœ— ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì´ë©”ì¼ì…ë‹ˆë‹¤.'}
                </p>
              )}
            </div>

            {/* ë¹„ë°€ë²ˆí˜¸ */}
            <div>
              <label className="block text-sm font-bold text-gray-700 mb-2">
                ë¹„ë°€ë²ˆí˜¸ <span className="text-red-500">*</span>
              </label>
              <input
                type="password"
                placeholder="8ì ì´ìƒ, íŠ¹ìˆ˜ë¬¸ì í¬í•¨"
                value={signupPassword}
                onChange={(e) => setSignupPassword(e.target.value)}
                className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500"
              />
              <p className="text-xs text-gray-500 mt-1">
                * 8ì ì´ìƒ, íŠ¹ìˆ˜ë¬¸ì(!@#$%^&* ë“±) í¬í•¨
              </p>
            </div>

            {/* ë¹„ë°€ë²ˆí˜¸ í™•ì¸ */}
            <div>
              <label className="block text-sm font-bold text-gray-700 mb-2">
                ë¹„ë°€ë²ˆí˜¸ í™•ì¸ <span className="text-red-500">*</span>
              </label>
              <input
                type="password"
                placeholder="ë¹„ë°€ë²ˆí˜¸ ì¬ì…ë ¥"
                value={signupPasswordConfirm}
                onChange={(e) => setSignupPasswordConfirm(e.target.value)}
                className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500"
              />
            </div>

            {/* ì´ë¦„/ê¸°ê´€ëª… */}
            <div>
              <label className="block text-sm font-bold text-gray-700 mb-2">
                {signupType === 'organization' ? 'ê¸°ê´€ëª…' : 'ì´ë¦„'} <span className="text-red-500">*</span>
              </label>
              <input
                type="text"
                placeholder={signupType === 'organization' ? 'ê¸°ê´€ëª…' : 'ì´ë¦„'}
                value={signupName}
                onChange={(e) => setSignupName(e.target.value)}
                className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500"
              />
            </div>

            {/* ì „í™”ë²ˆí˜¸ */}
            <div>
              <label className="block text-sm font-bold text-gray-700 mb-2">
                ì „í™”ë²ˆí˜¸ <span className="text-red-500">*</span>
              </label>
              <input
                type="tel"
                placeholder="010-1234-5678"
                value={signupPhone}
                onChange={(e) => setSignupPhone(e.target.value)}
                className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500"
              />
            </div>

            {/* ê¸°ê´€ íšŒì› ì¶”ê°€ ì •ë³´ */}
            {signupType === 'organization' && (
              <>
                <div>
                  <label className="block text-sm font-bold text-gray-700 mb-2">
                    ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ <span className="text-red-500">*</span>
                  </label>
                  <input
                    type="text"
                    placeholder="000-00-00000"
                    value={signupBusinessNumber}
                    onChange={(e) => setSignupBusinessNumber(e.target.value)}
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500"
                  />
                </div>

                <div>
                  <label className="block text-sm font-bold text-gray-700 mb-2">
                    ëŒ€í‘œìëª… <span className="text-red-500">*</span>
                  </label>
                  <input
                    type="text"
                    placeholder="ëŒ€í‘œìëª…"
                    value={signupRepName}
                    onChange={(e) => setSignupRepName(e.target.value)}
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500"
                  />
                </div>

                {/* ê¸°ê´€ ì¸ì¦ì„œë¥˜ ì²¨ë¶€ */}
                <div>
                  <label className="block text-sm font-bold text-gray-700 mb-2">
                    ê¸°ê´€ ì¸ì¦ì„œë¥˜ <span className="text-red-500">*</span>
                  </label>
                  <div className="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-red-500 transition-all">
                    <input
                      type="file"
                      id="file-upload"
                      accept=".pdf,.jpg,.jpeg,.png"
                      onChange={handleFileUpload}
                      className="hidden"
                    />
                    <label
                      htmlFor="file-upload"
                      className="cursor-pointer flex flex-col items-center gap-3"
                    >
                      <Upload className="text-gray-400" size={48} />
                      {uploadedFile ? (
                        <div className="text-center">
                          <p className="text-sm font-bold text-gray-900">
                            {uploadedFile.name}
                          </p>
                          <p className="text-xs text-gray-500 mt-1">
                            {(uploadedFile.size / 1024).toFixed(2)} KB
                          </p>
                        </div>
                      ) : (
                        <>
                          <p className="text-sm text-gray-600">
                            í´ë¦­í•˜ì—¬ íŒŒì¼ ì—…ë¡œë“œ
                          </p>
                          <p className="text-xs text-gray-400">
                            PDF, JPG, PNG (ìµœëŒ€ 5MB)
                          </p>
                        </>
                      )}
                    </label>
                  </div>
                  <p className="text-xs text-gray-500 mt-2">
                    * ì‚¬ì—…ìë“±ë¡ì¦, ê³ ìœ ë²ˆí˜¸ì¦ ë“± ê¸°ê´€ì„ ì¦ëª…í•  ìˆ˜ ìˆëŠ” ì„œë¥˜
                  </p>
                </div>
              </>
            )}
          </div>

          <button
            onClick={handleSignup}
            className="w-full mt-8 py-4 bg-red-500 text-white rounded-lg font-bold text-lg hover:bg-red-600 transition-all"
          >
            ê°€ì…í•˜ê¸°
          </button>

          <div className="text-center mt-6">
            <span className="text-gray-600">ì´ë¯¸ ê³„ì •ì´ ìˆìœ¼ì‹ ê°€ìš”? </span>
            <button
              onClick={() => setCurrentPage('login')}
              className="text-red-500 font-semibold hover:underline"
            >
              ë¡œê·¸ì¸
            </button>
          </div>
        </div>
      </div>
    </div>
  );

  const CreateProjectPage: React.FC = () => {
    const steps = [
      { num: 1, title: "ê¸°ë³¸ ì •ë³´", desc: "í”„ë¡œì íŠ¸ì˜ ê¸°ë³¸ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”" },
      { num: 2, title: "ìƒì„¸ ì„¤ëª…", desc: "í”„ë¡œì íŠ¸ë¥¼ ìì„¸íˆ ì†Œê°œí•´ì£¼ì„¸ìš”" },
      { num: 3, title: "ì´ë¯¸ì§€ & ìë£Œ", desc: "ëŒ€í‘œ ì´ë¯¸ì§€ì™€ ìë£Œë¥¼ ë“±ë¡í•´ì£¼ì„¸ìš”" },
      { num: 4, title: "ëª©í‘œ & ì¼ì •", desc: "ëª©í‘œ ê¸ˆì•¡ê³¼ ê¸°ê°„ì„ ì„¤ì •í•´ì£¼ì„¸ìš”" },
      { num: 5, title: "ìµœì¢… í™•ì¸", desc: "ì…ë ¥í•œ ë‚´ìš©ì„ í™•ì¸í•´ì£¼ì„¸ìš”" }
    ];

    return (
      <div className="min-h-screen bg-gray-50 py-8">
        <div className="max-w-4xl mx-auto px-6">
          {/* ì§„í–‰ ìƒíƒœ í‘œì‹œ */}
          <div className="bg-white rounded-2xl shadow-sm p-8 mb-8">
            <div className="flex items-center justify-between mb-6">
              {steps.map((step, idx) => (
                <React.Fragment key={step.num}>
                  <div className="flex flex-col items-center">
                    <div className={`w-12 h-12 rounded-full flex items-center justify-center font-bold text-lg transition-all ${
                      currentStep === step.num
                        ? 'bg-gradient-to-br from-red-500 to-pink-500 text-white scale-110 shadow-lg'
                        : currentStep > step.num
                        ? 'bg-gradient-to-br from-pink-500 to-rose-500 text-white'
                        : 'bg-gray-200 text-gray-500'
                    }`}>
                      {currentStep > step.num ? <CheckCircle size={24} /> : step.num}
                    </div>
                    <span className={`text-xs mt-2 font-medium ${currentStep === step.num ? 'text-red-500' : 'text-gray-600'}`}>
                      {step.title}
                    </span>
                  </div>
                  {idx < steps.length - 1 && (
                    <div className={`flex-1 h-1 mx-2 rounded ${currentStep > step.num ? 'bg-gradient-to-r from-pink-400 to-rose-400' : 'bg-gray-200'}`} />
                  )}
                </React.Fragment>
              ))}
            </div>
            <div className="text-center">
              <h3 className="text-xl font-bold text-gray-800">{steps[currentStep - 1].title}</h3>
              <p className="text-gray-600 text-sm mt-1">{steps[currentStep - 1].desc}</p>
            </div>
          </div>

          {/* ì…ë ¥ í¼ */}
          <div className="bg-white rounded-2xl shadow-sm p-8">
            {currentStep === 1 && (
              <div className="space-y-6">
                <div>
                  <label className="flex items-center gap-2 text-sm font-bold text-gray-700 mb-2">
                    í”„ë¡œì íŠ¸ëª… <span className="text-red-500">*</span>
                  </label>
                  <input
                    type="text"
                    value={projectTitle}
                    onChange={(e) => setProjectTitle(e.target.value)}
                    placeholder="ì˜ˆ: ì†Œì™¸ê³„ì¸µ ì•„ë™ ê¸‰ì‹ ì§€ì›"
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"
                  />
                  <p className="text-xs text-gray-500 mt-1">ëª…í™•í•˜ê³  êµ¬ì²´ì ì¸ ì œëª©ì„ ì‘ì„±í•´ì£¼ì„¸ìš” (ìµœëŒ€ 50ì)</p>
                </div>

                <div>
                  <label className="flex items-center gap-2 text-sm font-bold text-gray-700 mb-2">
                    ì¹´í…Œê³ ë¦¬ ì„ íƒ <span className="text-red-500">*</span>
                  </label>
                  <select
                    value={projectCategory}
                    onChange={(e) => setProjectCategory(e.target.value)}
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"
                  >
                    <option value="">ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</option>
                    <option value="ì•„ë™Â·ì²­ì†Œë…„">ì•„ë™Â·ì²­ì†Œë…„</option>
                    <option value="ì–´ë¥´ì‹ ">ì–´ë¥´ì‹ </option>
                    <option value="ì¥ì• ì¸">ì¥ì• ì¸</option>
                    <option value="í™˜ê²½ë³´í˜¸">í™˜ê²½ë³´í˜¸</option>
                    <option value="ë™ë¬¼ë³´í˜¸">ë™ë¬¼ë³´í˜¸</option>
                    <option value="ì§€ì—­ì‚¬íšŒ">ì§€ì—­ì‚¬íšŒ</option>
                  </select>
                </div>

                <div>
                  <label className="flex items-center gap-2 text-sm font-bold text-gray-700 mb-2">
                    ê¸°ê´€ ì •ë³´ <span className="text-red-500">*</span>
                  </label>
                  <input
                    type="text"
                    value={organizationName}
                    onChange={(e) => setOrganizationName(e.target.value)}
                    placeholder="ê¸°ê´€ëª…"
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent mb-3"
                  />
                  <input
                    type="text"
                    value={businessNumber}
                    onChange={(e) => setBusinessNumber(e.target.value)}
                    placeholder="ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸"
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"
                  />
                </div>

                <div className="bg-red-50 border border-red-200 rounded-lg p-4 flex gap-3">
                  <Info className="text-red-500 flex-shrink-0" size={20} />
                  <div className="text-sm text-red-800">
                    <strong>ê¸°ê´€ ì¸ì¦ ì•ˆë‚´</strong>
                    <p className="mt-1">í”„ë¡œì íŠ¸ ë“±ë¡ì„ ìœ„í•´ì„œëŠ” ê¸°ê´€ ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤. ì‚¬ì—…ìë“±ë¡ì¦ ë˜ëŠ” ê³ ìœ ë²ˆí˜¸ì¦ì„ ì¤€ë¹„í•´ì£¼ì„¸ìš”.</p>
                  </div>
                </div>
              </div>
            )}

            {currentStep === 2 && (
              <div className="space-y-6">
                <div>
                  <label className="flex items-center gap-2 text-sm font-bold text-gray-700 mb-2">
                    í”„ë¡œì íŠ¸ ì†Œê°œ <span className="text-red-500">*</span>
                  </label>
                  <textarea
                    rows={3}
                    value={projectSummary}
                    onChange={(e) => setProjectSummary(e.target.value)}
                    placeholder="í”„ë¡œì íŠ¸ë¥¼ í•œ ë¬¸ì¥ìœ¼ë¡œ ì†Œê°œí•´ì£¼ì„¸ìš”"
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none"
                  />
                  <p className="text-xs text-gray-500 mt-1">ê¸°ë¶€ìë“¤ì´ ê°€ì¥ ë¨¼ì € ë³´ëŠ” ì†Œê°œ ë¬¸êµ¬ì…ë‹ˆë‹¤ (ìµœëŒ€ 100ì)</p>
                </div>

                <div>
                  <label className="flex items-center gap-2 text-sm font-bold text-gray-700 mb-2">
                    ìƒì„¸ ì„¤ëª… <span className="text-red-500">*</span>
                  </label>
                  <div className="border border-gray-300 rounded-lg overflow-hidden">
                    <div className="bg-gray-50 border-b border-gray-300 px-4 py-2 flex gap-2">
                      <button className="px-3 py-1 bg-white border border-gray-300 rounded text-sm hover:bg-gray-100">
                        <strong>B</strong>
                      </button>
                      <button className="px-3 py-1 bg-white border border-gray-300 rounded text-sm hover:bg-gray-100">
                        <em>I</em>
                      </button>
                      <button className="px-3 py-1 bg-white border border-gray-300 rounded text-sm hover:bg-gray-100">
                        <u>U</u>
                      </button>
                      <div className="border-l border-gray-300 mx-2"></div>
                      <button className="px-3 py-1 bg-white border border-gray-300 rounded text-sm hover:bg-gray-100">ëª©ë¡</button>
                      <button className="px-3 py-1 bg-white border border-gray-300 rounded text-sm hover:bg-gray-100">ì´ë¯¸ì§€</button>
                    </div>
                    <textarea
                      rows={12}
                      value={projectDescription}
                      onChange={(e) => setProjectDescription(e.target.value)}
                      placeholder="í”„ë¡œì íŠ¸ì˜ ëª©ì , í•„ìš”ì„±, ê¸°ëŒ€íš¨ê³¼ ë“±ì„ ìì„¸íˆ ì‘ì„±í•´ì£¼ì„¸ìš”"
                      className="w-full px-4 py-3 focus:outline-none resize-none"
                    />
                  </div>
                  <p className="text-xs text-gray-500 mt-1">ìµœì†Œ 500ì ì´ìƒ ì‘ì„±í•´ì£¼ì„¸ìš”. ì´ë¯¸ì§€ì™€ í•¨ê»˜ ì‘ì„±í•˜ë©´ ë” íš¨ê³¼ì ì…ë‹ˆë‹¤.</p>
                </div>

                <div>
                  <label className="flex items-center gap-2 text-sm font-bold text-gray-700 mb-2">
                    ê¸°ë¶€ê¸ˆ ì‚¬ìš© ê³„íš <span className="text-red-500">*</span>
                  </label>
                  <textarea
                    rows={6}
                    value={fundingPlan}
                    onChange={(e) => setFundingPlan(e.target.value)}
                    placeholder="ëª¨ê¸ˆëœ ê¸°ë¶€ê¸ˆì„ ì–´ë–»ê²Œ ì‚¬ìš©í•  ê³„íšì¸ì§€ êµ¬ì²´ì ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”"
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none"
                  />
                </div>
              </div>
            )}

            {currentStep === 3 && (
              <div className="space-y-6">
                <div>
                  <label className="flex items-center gap-2 text-sm font-bold text-gray-700 mb-2">
                    ëŒ€í‘œ ì´ë¯¸ì§€ <span className="text-red-500">*</span>
                  </label>
                  <div className="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-red-500 transition-colors cursor-pointer">
                    <Upload className="mx-auto text-gray-400 mb-3" size={48} />
                    <p className="text-gray-600 font-medium mb-1">í´ë¦­í•˜ê±°ë‚˜ ë“œë˜ê·¸í•˜ì—¬ ì´ë¯¸ì§€ ì—…ë¡œë“œ</p>
                    <p className="text-xs text-gray-500">JPG, PNG íŒŒì¼ (ìµœëŒ€ 5ê°œ, ê° 10MB ì´í•˜)</p>
                  </div>

                  <div className="grid grid-cols-5 gap-3 mt-4">
                    {[1, 2, 3].map((img) => (
                      <div key={img} className="relative aspect-square bg-gray-100 rounded-lg overflow-hidden group">
                        <div className="w-full h-full bg-gradient-to-br from-gray-200 to-gray-300 flex items-center justify-center">
                          <Image className="text-gray-400" size={32} />
                        </div>
                        <button className="absolute top-1 right-1 w-6 h-6 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                          <X size={14} />
                        </button>
                      </div>
                    ))}
                  </div>
                </div>

                <div>
                  <label className="flex items-center gap-2 text-sm font-bold text-gray-700 mb-2">
                    ì‚¬ì—…ê³„íšì„œ ë° ì˜ˆì‚°ì„œ ì²¨ë¶€ <span className="text-red-500">*</span>
                  </label>
                  <div className="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-red-500 transition-colors cursor-pointer">
                    <FileText className="mx-auto text-gray-400 mb-2" size={40} />
                    <p className="text-gray-600 font-medium mb-1">ì‚¬ì—…ê³„íšì„œ ì—…ë¡œë“œ</p>
                    <p className="text-xs text-gray-500">PDF, DOCX íŒŒì¼ (ìµœëŒ€ 20MB)</p>
                  </div>

                  {businessPlan && (
                    <div className="mt-3 p-4 bg-gray-50 rounded-lg flex items-center justify-between">
                      <div className="flex items-center gap-3">
                        <FileText className="text-red-500" size={24} />
                        <div>
                          <p className="text-sm font-medium text-gray-800">ì‚¬ì—…ê³„íšì„œ_2024.pdf</p>
                          <p className="text-xs text-gray-500">2.4 MB</p>
                        </div>
                      </div>
                      <button
                        onClick={() => setBusinessPlan('')}
                        className="text-red-500 hover:text-red-700"
                      >
                        <X size={20} />
                      </button>
                    </div>
                  )}
                </div>

                <div className="bg-amber-50 border border-amber-200 rounded-lg p-4 flex gap-3">
                  <AlertCircle className="text-amber-500 flex-shrink-0" size={20} />
                  <div className="text-sm text-amber-800">
                    <strong>ì„œë¥˜ ì‹¬ì‚¬ ì•ˆë‚´</strong>
                    <p className="mt-1">ì œì¶œëœ ì‚¬ì—…ê³„íšì„œëŠ” íˆ¬ëª…í•œ ê¸°ë¶€ ìš´ì˜ì„ ìœ„í•´ ê´€ë¦¬ìì˜ ê²€í† ë¥¼ ê±°ì¹˜ê²Œ ë©ë‹ˆë‹¤. ìŠ¹ì¸ê¹Œì§€ 2-3 ì˜ì—…ì¼ì´ ì†Œìš”ë©ë‹ˆë‹¤.</p>
                  </div>
                </div>
              </div>
            )}

            {currentStep === 4 && (
              <div className="space-y-6">
                <div className="grid grid-cols-2 gap-6">
                  <div>
                    <label className="flex items-center gap-2 text-sm font-bold text-gray-700 mb-2">
                      ëª©í‘œ ê¸ˆì•¡ <span className="text-red-500">*</span>
                    </label>
                    <div className="relative">
                      <input
                        type="text"
                        value={targetAmount}
                        onChange={(e) => setTargetAmount(e.target.value)}
                        placeholder="10000000"
                        className="w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"
                      />
                      <span className="absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 font-medium">ì›</span>
                    </div>
                    <p className="text-xs text-gray-500 mt-1">ìµœì†Œ 100ë§Œì› ì´ìƒ</p>
                  </div>

                  <div>
                    <label className="flex items-center gap-2 text-sm font-bold text-gray-700 mb-2">
                      ëª¨ê¸ˆ ê¸°ê°„
                    </label>
                    <select
                      value={fundingDuration}
                      onChange={(e) => setFundingDuration(e.target.value)}
                      className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"
                    >
                      <option value="30">30ì¼</option>
                      <option value="60">60ì¼</option>
                      <option value="90">90ì¼</option>
                      <option value="custom">ì§ì ‘ ì„¤ì •</option>
                    </select>
                  </div>
                </div>

                <div className="grid grid-cols-2 gap-6">
                  <div>
                    <label className="flex items-center gap-2 text-sm font-bold text-gray-700 mb-2">
                      ëª¨ê¸ˆ ì‹œì‘ì¼ <span className="text-red-500">*</span>
                    </label>
                    <div className="relative">
                      <input
                        type="date"
                        value={startDate}
                        onChange={(e) => setStartDate(e.target.value)}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"
                      />
                      <Calendar className="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none" size={20} />
                    </div>
                  </div>

                  <div>
                    <label className="flex items-center gap-2 text-sm font-bold text-gray-700 mb-2">
                      ëª¨ê¸ˆ ì¢…ë£Œì¼ <span className="text-red-500">*</span>
                    </label>
                    <div className="relative">
                      <input
                        type="date"
                        value={endDate}
                        onChange={(e) => setEndDate(e.target.value)}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"
                      />
                      <Calendar className="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none" size={20} />
                    </div>
                  </div>
                </div>

                <div>
                  <label className="flex items-center gap-2 text-sm font-bold text-gray-700 mb-2">
                    ëª©í‘œ ë‹¬ì„± ì‹œ ì²˜ë¦¬ ë°©ì‹
                  </label>
                  <div className="space-y-3">
                    <label className="flex items-center gap-3 p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50">
                      <input
                        type="radio"
                        name="funding-type"
                        value="stop-on-goal"
                        checked={fundingType === 'stop-on-goal'}
                        onChange={(e) => setFundingType(e.target.value)}
                        className="w-4 h-4 text-red-500"
                      />
                      <div>
                        <p className="font-medium text-gray-800">ëª©í‘œê¸ˆì•¡ ë‹¬ì„± ì‹œ ì¢…ë£Œ</p>
                        <p className="text-xs text-gray-500 mt-1">ëª©í‘œê¸ˆì•¡ì— ë„ë‹¬í•˜ë©´ ìë™ìœ¼ë¡œ ëª¨ê¸ˆì´ ì¢…ë£Œë©ë‹ˆë‹¤</p>
                      </div>
                    </label>
                    <label className="flex items-center gap-3 p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50">
                      <input
                        type="radio"
                        name="funding-type"
                        value="continue"
                        checked={fundingType === 'continue'}
                        onChange={(e) => setFundingType(e.target.value)}
                        className="w-4 h-4 text-red-500"
                      />
                      <div>
                        <p className="font-medium text-gray-800">ê¸°ê°„ ì¢…ë£Œê¹Œì§€ ê³„ì† ëª¨ê¸ˆ</p>
                        <p className="text-xs text-gray-500 mt-1">ëª©í‘œê¸ˆì•¡ ë‹¬ì„± í›„ì—ë„ ì¢…ë£Œì¼ê¹Œì§€ ëª¨ê¸ˆì„ ê³„ì†í•©ë‹ˆë‹¤</p>
                      </div>
                    </label>
                  </div>
                </div>

                <div className="bg-rose-50 border border-rose-200 rounded-lg p-4 flex gap-3">
                  <CheckCircle className="text-rose-500 flex-shrink-0" size={20} />
                  <div className="text-sm text-rose-800">
                    <strong>íˆ¬ëª…í•œ ê¸°ë¶€ ë¬¸í™”</strong>
                    <p className="mt-1">ëª¨ë“  ê¸°ë¶€ ë‚´ì—­ê³¼ ì‚¬ìš© ë‚´ì—­ì€ ì‹¤ì‹œê°„ìœ¼ë¡œ íˆ¬ëª…í•˜ê²Œ ê³µê°œë©ë‹ˆë‹¤.</p>
                  </div>
                </div>
              </div>
            )}

            {currentStep === 5 && (
              <div className="space-y-6">
                <div className="bg-gradient-to-r from-red-50 via-pink-50 to-rose-50 border border-red-200 rounded-xl p-6 text-center">
                  <CheckCircle className="mx-auto text-red-500 mb-3" size={48} />
                  <h3 className="text-xl font-bold text-gray-800 mb-2">ë“±ë¡ ì¤€ë¹„ ì™„ë£Œ!</h3>
                  <p className="text-gray-600">ì…ë ¥í•˜ì‹  ì •ë³´ë¥¼ ìµœì¢… í™•ì¸í•´ì£¼ì„¸ìš”</p>
                </div>

                <div className="space-y-4">
                  <div className="bg-white border border-gray-200 rounded-lg p-5">
                    <h4 className="font-bold text-gray-800 mb-3 flex items-center gap-2">
                      <div className="w-8 h-8 bg-gradient-to-br from-red-100 to-pink-100 rounded-full flex items-center justify-center text-red-500 font-bold">1</div>
                      ê¸°ë³¸ ì •ë³´
                    </h4>
                    <div className="space-y-2 text-sm ml-10">
                      <div className="flex justify-between">
                        <span className="text-gray-600">í”„ë¡œì íŠ¸ëª…:</span>
                        <span className="font-medium">{projectTitle || 'ë¯¸ì…ë ¥'}</span>
                      </div>
                      <div className="flex justify-between">
                        <span className="text-gray-600">ì¹´í…Œê³ ë¦¬:</span>
                        <span className="font-medium">{projectCategory || 'ë¯¸ì…ë ¥'}</span>
                      </div>
                      <div className="flex justify-between">
                        <span className="text-gray-600">ê¸°ê´€ëª…:</span>
                        <span className="font-medium">{organizationName || 'ë¯¸ì…ë ¥'}</span>
                      </div>
                    </div>
                  </div>

                  <div className="bg-white border border-gray-200 rounded-lg p-5">
                    <h4 className="font-bold text-gray-800 mb-3 flex items-center gap-2">
                      <div className="w-8 h-8 bg-gradient-to-br from-red-100 to-pink-100 rounded-full flex items-center justify-center text-red-500 font-bold">2</div>
                      ëª©í‘œ & ì¼ì •
                    </h4>
                    <div className="space-y-2 text-sm ml-10">
                      <div className="flex justify-between">
                        <span className="text-gray-600">ëª©í‘œ ê¸ˆì•¡:</span>
                        <span className="font-bold text-red-500">{targetAmount ? `${Number(targetAmount).toLocaleString()}ì›` : 'ë¯¸ì…ë ¥'}</span>
                      </div>
                      <div className="flex justify-between">
                        <span className="text-gray-600">ëª¨ê¸ˆ ê¸°ê°„:</span>
                        <span className="font-medium">{startDate && endDate ? `${startDate} ~ ${endDate}` : 'ë¯¸ì…ë ¥'}</span>
                      </div>
                    </div>
                  </div>

                  <div className="bg-white border border-gray-200 rounded-lg p-5">
                    <h4 className="font-bold text-gray-800 mb-3 flex items-center gap-2">
                      <div className="w-8 h-8 bg-gradient-to-br from-red-100 to-pink-100 rounded-full flex items-center justify-center text-red-500 font-bold">3</div>
                      ì²¨ë¶€ ìë£Œ
                    </h4>
                    <div className="space-y-2 text-sm ml-10">
                      <div className="flex items-center gap-2 text-pink-600">
                        <CheckCircle size={16} />
                        <span>ëŒ€í‘œ ì´ë¯¸ì§€ 3ê°œ ì—…ë¡œë“œ ì™„ë£Œ</span>
                      </div>
                      <div className="flex items-center gap-2 text-pink-600">
                        <CheckCircle size={16} />
                        <span>ì‚¬ì—…ê³„íšì„œ ì—…ë¡œë“œ ì™„ë£Œ</span>
                      </div>
                    </div>
                  </div>
                </div>

                <div className="bg-pink-50 border border-pink-200 rounded-lg p-4">
                  <div className="flex items-start gap-3">
                    <input
                      type="checkbox"
                      checked={agreeToTerms}
                      onChange={(e) => setAgreeToTerms(e.target.checked)}
                      className="mt-1"
                    />
                    <div className="text-sm text-pink-800">
                      <p className="font-medium">ìœ„ ë‚´ìš©ì€ ì‚¬ì‹¤ê³¼ ë‹¤ë¦„ì—†ìœ¼ë©°, í—ˆìœ„ ì •ë³´ ì œê³µ ì‹œ ë²•ì  ì±…ì„ì´ ìˆìŒì„ í™•ì¸í•©ë‹ˆë‹¤.</p>
                      <p className="text-xs text-pink-600 mt-1">ì œì¶œëœ í”„ë¡œì íŠ¸ëŠ” ê´€ë¦¬ì ìŠ¹ì¸ í›„ ê³µê°œë©ë‹ˆë‹¤ (2-3 ì˜ì—…ì¼ ì†Œìš”)</p>
                    </div>
                  </div>
                </div>
              </div>
            )}

            {/* ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ */}
            <div className="flex justify-between mt-8 pt-6 border-t border-gray-200">
              <button
                onClick={() => {
                  if (currentStep === 1) {
                    setCurrentPage('mypage');
                  } else {
                    setCurrentStep(Math.max(1, currentStep - 1));
                  }
                }}
                className="px-6 py-3 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50 flex items-center gap-2"
              >
                <ChevronLeft size={20} />
                {currentStep === 1 ? 'ë§ˆì´í˜ì´ì§€ë¡œ' : 'ì´ì „'}
              </button>

              {currentStep < 5 ? (
                <button
                  onClick={() => setCurrentStep(Math.min(5, currentStep + 1))}
                  className="px-6 py-3 bg-red-500 text-white rounded-lg font-medium hover:bg-red-600 flex items-center gap-2"
                >
                  ë‹¤ìŒ
                  <ChevronRight size={20} />
                </button>
              ) : (
                <button
                  onClick={() => {
                    if (!agreeToTerms) {
                      alert('ì•½ê´€ì— ë™ì˜í•´ì£¼ì„¸ìš”.');
                      return;
                    }
                    alert('í”„ë¡œì íŠ¸ê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ì ìŠ¹ì¸ í›„ ê³µê°œë©ë‹ˆë‹¤.');
                    // ìƒíƒœ ì´ˆê¸°í™”
                    setCurrentStep(1);
                    setProjectTitle('');
                    setProjectCategory('');
                    setOrganizationName('');
                    setBusinessNumber('');
                    setProjectSummary('');
                    setProjectDescription('');
                    setFundingPlan('');
                    setTargetAmount('');
                    setStartDate('');
                    setEndDate('');
                    setAgreeToTerms(false);
                    setCurrentPage('mypage');
                  }}
                  disabled={!agreeToTerms}
                  className="px-8 py-3 bg-red-500 text-white rounded-lg font-bold hover:bg-red-600 disabled:opacity-50 disabled:cursor-not-allowed"
                >
                  í”„ë¡œì íŠ¸ ë“±ë¡ ì‹ ì²­
                </button>
              )}
            </div>
          </div>
        </div>
      </div>
    );
  };

  const CommunityPage: React.FC = () => (
    <div className="bg-gray-50 min-h-screen">
      <div className="max-w-[1400px] mx-auto px-8 py-12">
        <div className="flex items-center justify-between mb-10">
          <h1 className="text-5xl font-bold">ì»¤ë®¤ë‹ˆí‹°</h1>
          {isLoggedIn && (
            <button 
              onClick={() => setCurrentPage('create-post')}
              className="px-6 py-3 bg-red-500 text-white rounded-lg font-bold hover:bg-red-600"
            >
              ê¸€ì“°ê¸°
            </button>
          )}
        </div>

        <div className="bg-white border border-gray-200 rounded-xl overflow-hidden">
          <div className="grid grid-cols-12 gap-4 p-4 bg-gray-50 border-b border-gray-200 font-bold text-sm">
            <div className="col-span-1 text-center">êµ¬ë¶„</div>
            <div className="col-span-7">ì œëª©</div>
            <div className="col-span-2">ì‘ì„±ì</div>
            <div className="col-span-1 text-center">ë‚ ì§œ</div>
            <div className="col-span-1 text-center">ì¡°íšŒ</div>
          </div>

          {communityPosts.map(post => {
            const currentViews = postViews.get(post.id) || post.views;
            return (
              <div
                key={post.id}
                className="grid grid-cols-12 gap-4 p-4 border-b border-gray-200 hover:bg-gray-50 cursor-pointer"
                onClick={() => {
                  setSelectedPost(post);
                  setCurrentPage('post-detail');
                }}
              >
                <div className="col-span-1 text-center">
                  <span className={`px-2 py-1 rounded text-xs font-bold ${
                    post.type === 'ê³µì§€' ? 'bg-red-100 text-red-600' :
                    post.type === 'ì§ˆë¬¸' ? 'bg-blue-100 text-blue-600' :
                    'bg-green-100 text-green-600'
                  }`}>
                    {post.type}
                  </span>
                </div>
                <div className="col-span-7 font-semibold">{post.title}</div>
                <div className="col-span-2 text-gray-600">{post.author}</div>
                <div className="col-span-1 text-center text-gray-500 text-sm">{post.date}</div>
                <div className="col-span-1 text-center text-gray-500 text-sm">{currentViews}</div>
              </div>
            );
          })}
        </div>
      </div>
    </div>
  );

  const PostDetailPage: React.FC = () => {
    if (!selectedPost) return <div />;

    // 11ë²ˆ - ì¡°íšŒìˆ˜ ì¦ê°€ (í˜ì´ì§€ ì§„ì… ì‹œ - í•œ ë²ˆë§Œ ì‹¤í–‰)
    useEffect(() => {
      if (selectedPost) {
        incrementView(selectedPost.id);
      }
      // eslint-disable-next-line react-hooks/exhaustive-deps
    }, [selectedPost?.id]); // selectedPost.idê°€ ë³€ê²½ë  ë•Œë§Œ ì‹¤í–‰

    const currentViews = postViews.get(selectedPost.id) || selectedPost.views;

    return (
      <div className="bg-gray-50 min-h-screen">
        <div className="max-w-5xl mx-auto px-8 py-12">
          <button
            onClick={() => setCurrentPage('community')}
            className="mb-8 text-gray-600 hover:text-gray-900 font-semibold"
          >
            â† ëª©ë¡ìœ¼ë¡œ
          </button>

          <div className="bg-white border border-gray-200 rounded-xl p-8">
            <div className="flex items-center gap-3 mb-4">
              <span className={`px-3 py-1 rounded font-bold ${
                selectedPost.type === 'ê³µì§€' ? 'bg-red-100 text-red-600' :
                selectedPost.type === 'ì§ˆë¬¸' ? 'bg-blue-100 text-blue-600' :
                'bg-green-100 text-green-600'
              }`}>
                {selectedPost.type}
              </span>
            </div>

            <h1 className="text-4xl font-bold mb-6">{selectedPost.title}</h1>

            <div className="flex items-center gap-4 pb-6 mb-6 border-b border-gray-200">
              <span className="font-semibold">{selectedPost.author}</span>
              <span className="text-gray-500">â€¢</span>
              <span className="text-gray-500">{selectedPost.date}</span>
              <span className="text-gray-500">â€¢</span>
              <span className="flex items-center gap-1 text-gray-500">
                <Eye size={16} />
                {currentViews}
              </span>
            </div>

            <div className="prose max-w-none mb-12">
              <p className="text-gray-700 leading-relaxed">
                ê²Œì‹œê¸€ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
              </p>
            </div>

            {/* 7ë²ˆ - ëŒ“ê¸€ ì„¹ì…˜ */}
            <div className="mt-8 border-t pt-8">
              <h3 className="text-2xl font-bold mb-6">ëŒ“ê¸€ {comments.length}ê°œ</h3>

              {/* ëŒ“ê¸€ ì‘ì„± */}
              {isLoggedIn ? (
                <div className="mb-6">
                  <textarea
                    value={newComment}
                    onChange={(e) => setNewComment(e.target.value)}
                    placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”"
                    rows={3}
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500 resize-none"
                  />
                  <button
                    onClick={() => addComment(newComment)}
                    className="mt-2 px-6 py-2 bg-red-500 text-white rounded-lg font-bold hover:bg-red-600"
                  >
                    ëŒ“ê¸€ ì‘ì„±
                  </button>
                </div>
              ) : (
                <div className="mb-6 p-4 bg-gray-50 rounded-lg text-center text-gray-600">
                  ëŒ“ê¸€ì„ ì‘ì„±í•˜ë ¤ë©´ ë¡œê·¸ì¸ì´ í•„è¦í•©ë‹ˆë‹¤.
                </div>
              )}

              {/* ëŒ“ê¸€ ëª©ë¡ */}
              <div className="space-y-4">
                {comments.filter(c => !c.parentId).map(comment => (
                  <div key={comment.id} className="border-b pb-4">
                    <div className="flex justify-between items-start mb-2">
                      <div>
                        <span className="font-bold">{comment.author}</span>
                        <span className="text-sm text-gray-500 ml-2">{comment.date}</span>
                      </div>
                      <div className="flex gap-2">
                        {isLoggedIn && (
                          <>
                            <button
                              onClick={() => setReplyTo(comment.id)}
                              className="text-sm text-gray-600 hover:text-gray-900"
                            >
                              ë‹µê¸€
                            </button>
                            <button
                              onClick={() => deleteComment(comment.id)}
                              className="text-sm text-red-500 hover:text-red-700"
                            >
                              ì‚­ì œ
                            </button>
                          </>
                        )}
                      </div>
                    </div>
                    <p className="text-gray-700">{comment.content}</p>

                    {/* ë‹µê¸€ ì‘ì„± */}
                    {replyTo === comment.id && isLoggedIn && (
                      <div className="mt-3 ml-8">
                        <textarea
                          value={newComment}
                          onChange={(e) => setNewComment(e.target.value)}
                          placeholder="ë‹µê¸€ì„ ì…ë ¥í•˜ì„¸ìš”"
                          rows={2}
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500 resize-none"
                        />
                        <div className="flex gap-2 mt-2">
                          <button
                            onClick={() => addComment(newComment, comment.id)}
                            className="px-4 py-1 bg-red-500 text-white rounded-lg text-sm hover:bg-red-600"
                          >
                            ë‹µê¸€ ì‘ì„±
                          </button>
                          <button
                            onClick={() => setReplyTo(null)}
                            className="px-4 py-1 border border-gray-300 rounded-lg text-sm hover:bg-gray-50"
                          >
                            ì·¨ì†Œ
                          </button>
                        </div>
                      </div>
                    )}

                    {/* ë‹µê¸€ ëª©ë¡ */}
                    <div className="ml-8 mt-3 space-y-2">
                      {comments.filter(c => c.parentId === comment.id).map(reply => (
                        <div key={reply.id} className="bg-gray-50 p-3 rounded-lg">
                          <div className="flex justify-between items-start mb-1">
                            <div>
                              <span className="font-bold text-sm">{reply.author}</span>
                              <span className="text-xs text-gray-500 ml-2">{reply.date}</span>
                            </div>
                            {isLoggedIn && (
                              <button
                                onClick={() => deleteComment(reply.id)}
                                className="text-xs text-red-500 hover:text-red-700"
                              >
                                ì‚­ì œ
                              </button>
                            )}
                          </div>
                          <p className="text-sm text-gray-700">{reply.content}</p>
                        </div>
                      ))}
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      </div>
    );
  };

  const CreatePostPage: React.FC = () => (
    <div className="bg-gray-50 min-h-screen py-16">
      <div className="max-w-5xl mx-auto px-8">
        <div className="bg-white rounded-2xl p-12 border border-gray-200">
          <h1 className="text-4xl font-bold mb-10">ê²Œì‹œê¸€ ì‘ì„±</h1>

          <div className="space-y-6">
            <div>
              <label className="block text-sm font-bold text-gray-700 mb-2">êµ¬ë¶„</label>
              <select className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500">
                <option>ì§ˆë¬¸</option>
                <option>ì‘ì›</option>
              </select>
            </div>

            <div>
              <label className="block text-sm font-bold text-gray-700 mb-2">ì œëª©</label>
              <input 
                type="text" 
                placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”"
                className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500"
              />
            </div>

            <div>
              <label className="block text-sm font-bold text-gray-700 mb-2">ë‚´ìš©</label>
              <textarea
                placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"
                rows={15}
                className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500 resize-none"
              />
            </div>

            {/* 10ë²ˆ - ì´ë¯¸ì§€ ì—…ë¡œë“œ */}
            <div>
              <label className="block text-sm font-bold text-gray-700 mb-2">ì´ë¯¸ì§€ ì²¨ë¶€ (ìµœëŒ€ 5ê°œ)</label>
              <input
                type="file"
                accept="image/*"
                multiple
                onChange={handleImageUpload}
                className="hidden"
                id="image-upload"
              />
              <label
                htmlFor="image-upload"
                className="inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50"
              >
                <Upload size={20} />
                ì´ë¯¸ì§€ ì„ íƒ
              </label>

              {/* ì—…ë¡œë“œëœ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° */}
              {uploadedImageFiles.length > 0 && (
                <div className="mt-4 grid grid-cols-5 gap-2">
                  {uploadedImageFiles.map((file, index) => (
                    <div key={index} className="relative">
                      <img
                        src={URL.createObjectURL(file)}
                        alt={`preview-${index}`}
                        className="w-full h-24 object-cover rounded-lg"
                      />
                      <button
                        onClick={() => removeImage(index)}
                        className="absolute -top-2 -right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600"
                      >
                        <X size={16} />
                      </button>
                    </div>
                  ))}
                </div>
              )}
            </div>

            <div className="flex gap-4 pt-6">
              <button 
                onClick={() => setCurrentPage('community')}
                className="flex-1 py-4 border border-gray-300 rounded-lg font-bold text-lg hover:bg-gray-50"
              >
                ì·¨ì†Œ
              </button>
              <button 
                onClick={() => {
                  alert('ê²Œì‹œê¸€ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.');
                  setCurrentPage('community');
                }}
                className="flex-1 py-4 bg-red-500 text-white rounded-lg font-bold text-lg hover:bg-red-600"
              >
                ë“±ë¡
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  );

  const MyPage: React.FC = () => (
    <div className="bg-gray-50 min-h-screen">
      <div className="max-w-[1400px] mx-auto px-8 py-12">
        <h1 className="text-5xl font-bold mb-12">ë§ˆì´í˜ì´ì§€</h1>

        <div className="grid grid-cols-4 gap-8">
          <div className="bg-white border border-gray-200 rounded-xl p-6">
            <h3 className="text-xl font-bold mb-6">í”„ë¡œí•„</h3>
            <div className="space-y-2">
              <button 
                onClick={() => setCurrentPage('profile-edit')}
                className="w-full py-3 text-left hover:bg-gray-50 rounded-lg px-4 font-semibold"
              >
                ê¸°ë³¸ ì •ë³´ ìˆ˜ì •
              </button>
              <button 
                onClick={() => setShowPasswordModal(true)}
                className="w-full py-3 text-left hover:bg-gray-50 rounded-lg px-4 font-semibold"
              >
                ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
              </button>
            </div>

            <div className="mt-8 pt-8 border-t border-gray-200">
              <h3 className="text-xl font-bold mb-6">ë‚˜ì˜ í™œë™</h3>
              <div className="space-y-2">
                <button 
                  onClick={() => setCurrentPage('donation-history')}
                  className="w-full py-3 text-left hover:bg-gray-50 rounded-lg px-4 font-semibold"
                >
                  ê¸°ë¶€ ë‚´ì—­
                </button>
                <button 
                  onClick={() => setCurrentPage('favorite-projects')}
                  className="w-full py-3 text-left hover:bg-gray-50 rounded-lg px-4 font-semibold"
                >
                  ê´€ì‹¬ í”„ë¡œì íŠ¸
                </button>
              </div>
            </div>

            {userType === 'organization' && (
              <div className="mt-8 pt-8 border-t border-gray-200">
                <h3 className="text-xl font-bold mb-6">ë‚´ í”„ë¡œì íŠ¸</h3>
                <div className="space-y-2">
                  <button 
                    onClick={() => setCurrentPage('create-project')}
                    className="w-full py-3 text-left hover:bg-gray-50 rounded-lg px-4 font-semibold"
                  >
                    í”„ë¡œì íŠ¸ ë“±ë¡
                  </button>
                  <button 
                    onClick={() => setCurrentPage('piggy-bank')}
                    className="w-full py-3 text-left hover:bg-gray-50 rounded-lg px-4 font-semibold"
                  >
                    ì €ê¸ˆí†µ ê´€ë¦¬
                  </button>
                </div>
              </div>
            )}
          </div>

          <div className="col-span-3 space-y-8">
            <div className="bg-white border border-gray-200 rounded-xl p-8">
              <h2 className="text-3xl font-bold mb-6">ë‚˜ì˜ ê¸°ë¶€ í˜„í™©</h2>
              <div className="grid grid-cols-3 gap-6">
                <div className="p-6 bg-red-50 rounded-xl">
                  <p className="text-sm text-gray-600 mb-2">ì´ ê¸°ë¶€ ê¸ˆì•¡</p>
                  <p className="text-3xl font-bold">{formatAmount(donationHistory.reduce((sum, d) => sum + d.amount, 0))}ì›</p>
                </div>
                <div className="p-6 bg-blue-50 rounded-xl">
                  <p className="text-sm text-gray-600 mb-2">ì°¸ì—¬ í”„ë¡œì íŠ¸</p>
                  <p className="text-3xl font-bold">{donationHistory.length}ê°œ</p>
                </div>
                <div className="p-6 bg-green-50 rounded-xl">
                  <p className="text-sm text-gray-600 mb-2">ê´€ì‹¬ í”„ë¡œì íŠ¸</p>
                  <p className="text-3xl font-bold">{favoriteProjects.length}ê°œ</p>
                </div>
              </div>
            </div>

            <div className="bg-white border border-gray-200 rounded-xl p-8">
              <h2 className="text-3xl font-bold mb-6">ìµœê·¼ ê¸°ë¶€ ë‚´ì—­</h2>
              <div className="space-y-4">
                {donationHistory.slice(0, 3).map(donation => (
                  <div key={donation.id} className="flex justify-between p-6 bg-gray-50 rounded-xl">
                    <div>
                      <p className="font-bold text-lg mb-1">{donation.projectTitle}</p>
                      <p className="text-sm text-gray-500">{donation.date}</p>
                    </div>
                    <p className="font-bold text-2xl">{formatAmount(donation.amount)}ì›</p>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );

  const DonationHistoryPage: React.FC = () => (
    <div className="bg-gray-50 min-h-screen">
      <div className="max-w-5xl mx-auto px-8 py-12">
        <button 
          onClick={() => setCurrentPage('mypage')}
          className="mb-8 text-gray-600 hover:text-gray-900 font-semibold"
        >
          â† ë§ˆì´í˜ì´ì§€ë¡œ
        </button>

        <div className="bg-white rounded-2xl p-8 border border-gray-200">
          <h2 className="text-3xl font-bold mb-6">ë‚˜ì˜ ê¸°ë¶€ ë‚´ì—­</h2>

          <div className="grid grid-cols-3 gap-6 mb-8">
            <div className="p-6 bg-gradient-to-br from-red-50 to-pink-50 rounded-xl">
              <div className="text-sm text-gray-600 mb-2">ì´ ê¸°ë¶€ ê¸ˆì•¡</div>
              <div className="text-3xl font-bold text-red-500">
                {formatAmount(donationHistory.reduce((sum, d) => sum + d.amount, 0))}ì›
              </div>
            </div>
            <div className="p-6 bg-gradient-to-br from-blue-50 to-cyan-50 rounded-xl">
              <div className="text-sm text-gray-600 mb-2">ì°¸ì—¬ í”„ë¡œì íŠ¸</div>
              <div className="text-3xl font-bold text-blue-500">{donationHistory.length}ê°œ</div>
            </div>
            <div className="p-6 bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl">
              <div className="text-sm text-gray-600 mb-2">ë°œê¸‰ëœ ì˜ìˆ˜ì¦</div>
              <div className="text-3xl font-bold text-green-500">{donationHistory.length}ê±´</div>
            </div>
          </div>

          <div className="space-y-4">
            {donationHistory.map(donation => (
              <div key={donation.id} className="p-6 border border-gray-200 rounded-xl hover:border-red-500 transition-all">
                <div className="flex items-start justify-between">
                  <div className="flex-1">
                    <h3 className="font-bold text-lg mb-2">{donation.projectTitle}</h3>
                    <div className="flex items-center gap-4 text-sm text-gray-600">
                      <span className="flex items-center gap-1">
                        <Calendar size={16} />
                        {donation.date}
                      </span>
                      <span>ì˜ìˆ˜ì¦ ë²ˆí˜¸: {donation.receiptNumber}</span>
                    </div>
                  </div>
                  <div className="text-right">
                    <div className="text-2xl font-bold text-red-500 mb-2">
                      {formatAmount(donation.amount)}ì›
                    </div>
                    <button
                      onClick={() => downloadReceipt(donation.receiptNumber, donation.projectTitle, donation.amount)}
                      className="flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:border-red-500 transition-all"
                    >
                      <Download size={16} />
                      ì˜ìˆ˜ì¦ ë‹¤ìš´ë¡œë“œ
                    </button>
                  </div>
                </div>
              </div>
            ))}
          </div>
        </div>
      </div>
    </div>
  );

  const FavoriteProjectsPage: React.FC = () => (
    <div className="bg-gray-50 min-h-screen">
      <div className="max-w-5xl mx-auto px-8 py-12">
        <button 
          onClick={() => setCurrentPage('mypage')}
          className="mb-8 text-gray-600 hover:text-gray-900 font-semibold"
        >
          â† ë§ˆì´í˜ì´ì§€ë¡œ
        </button>

        <div className="bg-white rounded-2xl p-8 border border-gray-200">
          <div className="flex items-center justify-between mb-6">
            <h2 className="text-3xl font-bold">ê´€ì‹¬ í”„ë¡œì íŠ¸</h2>
            <span className="text-gray-600">{favoriteProjects.length}ê°œ í”„ë¡œì íŠ¸</span>
          </div>

          {favoriteProjects.length === 0 ? (
            // ê´€ì‹¬ í”„ë¡œì íŠ¸ê°€ ì—†ì„ ë•Œ
            <div className="text-center py-20">
              <Heart className="mx-auto text-gray-300 mb-4" size={64} />
              <p className="text-gray-500 text-lg mb-4">ê´€ì‹¬ í”„ë¡œì íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
              <button 
                onClick={() => setCurrentPage('projects')}
                className="px-6 py-3 bg-red-500 text-white rounded-lg font-bold hover:bg-red-600"
              >
                í”„ë¡œì íŠ¸ ë‘˜ëŸ¬ë³´ê¸°
              </button>
            </div>
          ) : (
            // ê´€ì‹¬ í”„ë¡œì íŠ¸ê°€ ìˆì„ ë•Œ
            <div className="grid grid-cols-3 gap-6">
              {favoriteProjects.map(project => {
                const progress = calculatePercentage(project.currentAmount, project.targetAmount);
                return (
                  <div 
                    key={project.id} 
                    className="border border-gray-200 rounded-xl overflow-hidden hover:border-red-500 transition-all bg-white relative"
                  >
                    {/* í•˜íŠ¸ ë²„íŠ¼ - í´ë¦­í•˜ë©´ ê´€ì‹¬ í”„ë¡œì íŠ¸ì—ì„œ ì œê±° */}
                    <button
                      onClick={(e) => {
                        e.stopPropagation();
                        toggleFavoriteProject(project.id);
                      }}
                      className="absolute top-4 right-4 z-10 p-2 bg-white rounded-full shadow-lg hover:scale-110 transition-transform"
                    >
                      <Heart 
                        size={24} 
                        className="text-red-500"
                        fill="currentColor"
                      />
                    </button>

                    {/* ì¹´ë“œ ë‚´ìš© - í´ë¦­í•˜ë©´ ìƒì„¸ í˜ì´ì§€ë¡œ ì´ë™ */}
                    <div
                      className="cursor-pointer"
                      onClick={() => {
                        setSelectedProject(project);
                        setActiveTab('intro');
                        setCurrentPage('detail');
                      }}
                    >
                      <div className="h-48 bg-gradient-to-br from-red-100 to-pink-100 flex items-center justify-center text-7xl">
                        {project.image}
                      </div>
                      <div className="p-5">
                        <div className="text-sm text-red-500 font-semibold mb-2">{project.category}</div>
                        <h3 className="text-lg font-bold mb-3 line-clamp-2">{project.title}</h3>

                        <div className="mb-4">
                          <div className="flex justify-between text-sm mb-2">
                            <span className="font-bold text-red-500">{progress}%</span>
                            <span className="text-gray-500">D-{project.dday}</span>
                          </div>
                          <div className="w-full bg-gray-200 rounded-full h-2">
                            <div 
                              className="bg-red-500 h-2 rounded-full"
                              style={{ width: `${progress}%` }}
                            ></div>
                          </div>
                        </div>

                        <div className="flex justify-between text-sm text-gray-600">
                          <span>{formatAmount(project.currentAmount)}ì›</span>
                          <span>{project.donors}ëª… ì°¸ì—¬</span>
                        </div>
                      </div>
                    </div>
                  </div>
                );
              })}
            </div>
          )}
        </div>
      </div>
    </div>
  );

  const PiggyBankPage: React.FC = () => (
    <div className="bg-gray-50 min-h-screen">
      <div className="max-w-5xl mx-auto px-8 py-12">
        <button 
          onClick={() => setCurrentPage('mypage')}
          className="mb-8 text-gray-600 hover:text-gray-900 font-semibold"
        >
          â† ë§ˆì´í˜ì´ì§€ë¡œ
        </button>

        <div className="bg-white rounded-2xl p-8 border border-gray-200">
          <h2 className="text-3xl font-bold mb-6">ì €ê¸ˆí†µ ê´€ë¦¬</h2>

          <div className="space-y-6">
            {piggyBanks.map(bank => (
              <div key={bank.projectId} className="p-6 border border-gray-200 rounded-xl">
                <div className="flex items-start justify-between mb-4">
                  <div>
                    <h3 className="font-bold text-xl mb-2">{bank.projectTitle}</h3>
                    <div className="flex items-center gap-2">
                      <span className={`px-3 py-1 rounded-full text-sm font-bold ${
                        bank.status === 'active' ? 'bg-green-100 text-green-600' :
                        bank.status === 'withdrawn' ? 'bg-gray-100 text-gray-600' :
                        'bg-red-100 text-red-600'
                      }`}>
                        {bank.status === 'active' ? 'ìš´ì˜ì¤‘' : bank.status === 'withdrawn' ? 'ì •ì‚°ì™„ë£Œ' : 'ì ê¸ˆ'}
                      </span>
                      <span className="text-sm text-gray-500">ìµœì¢… ì—…ë°ì´íŠ¸: {bank.lastUpdated}</span>
                    </div>
                  </div>
                  {bank.status === 'active' && bank.balance > 0 && (
                    <button
                      onClick={() => handleSettlementRequest(bank.projectId)}
                      className="px-6 py-3 bg-red-500 text-white rounded-lg font-bold hover:bg-red-600 transition-all"
                    >
                      ì •ì‚° ìš”ì²­
                    </button>
                  )}
                </div>

                <div className="grid grid-cols-3 gap-4">
                  <div className="p-4 bg-blue-50 rounded-lg">
                    <div className="text-sm text-gray-600 mb-1">ì´ ë³´ê´€ê¸ˆì•¡</div>
                    <div className="text-2xl font-bold text-blue-600">
                      {formatAmount(bank.totalAmount)}ì›
                    </div>
                  </div>
                  <div className="p-4 bg-gray-50 rounded-lg">
                    <div className="text-sm text-gray-600 mb-1">ì¸ì¶œê¸ˆì•¡</div>
                    <div className="text-2xl font-bold text-gray-600">
                      {formatAmount(bank.withdrawnAmount)}ì›
                    </div>
                  </div>
                  <div className="p-4 bg-green-50 rounded-lg">
                    <div className="text-sm text-gray-600 mb-1">í˜„ì¬ ì”ì•¡</div>
                    <div className="text-2xl font-bold text-green-600">
                      {formatAmount(bank.balance)}ì›
                    </div>
                  </div>
                </div>
              </div>
            ))}
          </div>
        </div>
      </div>
    </div>
  );

  const ProfileEditPage: React.FC = () => {
    const [editedProfile, setEditedProfile] = useState<UserProfile>(userProfile);
    
    return (
      <div className="bg-gray-50 min-h-screen py-16">
        <div className="max-w-3xl mx-auto px-8">
          <button 
            onClick={() => setCurrentPage('mypage')}
            className="mb-8 text-gray-600 hover:text-gray-900 font-semibold"
          >
            â† ë§ˆì´í˜ì´ì§€ë¡œ
          </button>

          <div className="bg-white rounded-2xl p-12 border border-gray-200">
            <h1 className="text-4xl font-bold mb-10">í”„ë¡œí•„ ìˆ˜ì •</h1>

            <div className="space-y-6">
              <div>
                <label className="block text-sm font-bold text-gray-700 mb-2">ì´ë¦„</label>
                <input 
                  type="text"
                  value={editedProfile.name}
                  onChange={(e) => setEditedProfile({...editedProfile, name: e.target.value})}
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500"
                />
              </div>

              <div>
                <label className="block text-sm font-bold text-gray-700 mb-2">ì´ë©”ì¼</label>
                <input 
                  type="email"
                  value={editedProfile.email}
                  onChange={(e) => setEditedProfile({...editedProfile, email: e.target.value})}
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500"
                />
              </div>

              <div>
                <label className="block text-sm font-bold text-gray-700 mb-2">ì „í™”ë²ˆí˜¸</label>
                <input 
                  type="tel"
                  value={editedProfile.phone}
                  onChange={(e) => setEditedProfile({...editedProfile, phone: e.target.value})}
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500"
                />
              </div>

              <div className="pt-6 border-t border-gray-200">
                <h2 className="text-2xl font-bold mb-6">ì•Œë¦¼ ì„¤ì •</h2>
                <div className="space-y-4">
                  <label className="flex items-center justify-between p-4 bg-gray-50 rounded-lg cursor-pointer">
                    <span className="font-semibold">ê¸°ë¶€ ê´€ë ¨ ì•Œë¦¼</span>
                    <input
                      type="checkbox"
                      checked={editedProfile.notificationSettings.donation}
                      onChange={(e) => setEditedProfile({
                        ...editedProfile,
                        notificationSettings: {
                          ...editedProfile.notificationSettings,
                          donation: e.target.checked
                        }
                      })}
                      className="w-5 h-5"
                    />
                  </label>
                  <label className="flex items-center justify-between p-4 bg-gray-50 rounded-lg cursor-pointer">
                    <span className="font-semibold">í”„ë¡œì íŠ¸ ê´€ë ¨ ì•Œë¦¼</span>
                    <input
                      type="checkbox"
                      checked={editedProfile.notificationSettings.project}
                      onChange={(e) => setEditedProfile({
                        ...editedProfile,
                        notificationSettings: {
                          ...editedProfile.notificationSettings,
                          project: e.target.checked
                        }
                      })}
                      className="w-5 h-5"
                    />
                  </label>
                </div>
              </div>

              <button 
                onClick={() => handleUpdateProfile(editedProfile)}
                className="w-full py-4 bg-red-500 text-white rounded-lg font-bold text-lg hover:bg-red-600 transition-all"
              >
                ì €ì¥í•˜ê¸°
              </button>
            </div>
          </div>
        </div>
      </div>
    );
  };

  const NotificationPage: React.FC = () => (
    <div className="bg-gray-50 min-h-screen">
      <div className="max-w-5xl mx-auto px-8 py-12">
        <button
          onClick={() => setCurrentPage('home')}
          className="mb-8 text-gray-600 hover:text-gray-900 font-semibold"
        >
          â† í™ˆìœ¼ë¡œ
        </button>
        <div className="flex items-center justify-between mb-8">
          <h1 className="text-5xl font-bold">ì•Œë¦¼</h1>
          <button 
            onClick={markAllAsRead}
            className="px-6 py-3 border border-gray-300 rounded-lg font-semibold hover:border-red-500"
          >
            ëª¨ë‘ ì½ìŒ í‘œì‹œ
          </button>
        </div>

        <div className="space-y-4">
          {notifications.map(notification => (
            <div 
              key={notification.id}
              className={`p-6 rounded-xl border cursor-pointer ${
                notification.isRead 
                  ? 'bg-white border-gray-200' 
                  : 'bg-red-50 border-red-200'
              }`}
              onClick={() => markAsRead(notification.id)}
            >
              <div className="flex items-start justify-between mb-2">
                <h3 className="font-bold text-lg">{notification.title}</h3>
                <span className="text-sm text-gray-500">{notification.date}</span>
              </div>
              <p className="text-gray-700">{notification.message}</p>
            </div>
          ))}
        </div>
      </div>
    </div>
  );

// ============================================
// Modal Components (ë©”ëª¨ì´ì œì´ì…˜)
// ============================================
const ProjectDetailModalContent: React.FC<{
  selectedProject: any;
  rejectReason: string;
  setRejectReason: (reason: string) => void;
  handleApproveProject: () => void;
  handleRejectProject: () => void;
  onClose: () => void;
}> = React.memo(({ selectedProject, rejectReason, setRejectReason, handleApproveProject, handleRejectProject, onClose }) => {
  const scrollContainerRef = React.useRef<HTMLDivElement>(null);
  const scrollPositionRef = React.useRef<number>(0);

  // ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ì €ì¥
  const handleScroll = () => {
    if (scrollContainerRef.current) {
      scrollPositionRef.current = scrollContainerRef.current.scrollTop;
    }
  };

  // ë Œë”ë§ í›„ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ë³µì›
  React.useEffect(() => {
    if (scrollContainerRef.current && scrollPositionRef.current > 0) {
      scrollContainerRef.current.scrollTop = scrollPositionRef.current;
    }
  });

  return (
    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
      <div
        ref={scrollContainerRef}
        onScroll={handleScroll}
        className="bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto"
      >
        <div className="sticky top-0 bg-white border-b border-gray-200 p-6 flex items-center justify-between">
          <div>
            <h2 className="text-2xl font-bold text-gray-800">í”„ë¡œì íŠ¸ ê²€í† </h2>
            <p className="text-sm text-gray-600 mt-1">í”„ë¡œì íŠ¸ ì •ë³´ë¥¼ í™•ì¸í•˜ê³  ìŠ¹ì¸/ë°˜ë ¤ ì²˜ë¦¬í•˜ì„¸ìš”</p>
          </div>
          <button onClick={onClose} className="p-2 hover:bg-gray-100 rounded-lg">
            <X size={24} />
          </button>
        </div>

        <div className="p-6 space-y-6">
          <div className="bg-gradient-to-r from-red-50 to-pink-50 rounded-xl p-6 border border-red-200">
            <div className="flex items-start justify-between mb-4">
              <div>
                <span className="px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-xs font-semibold">ìŠ¹ì¸ ëŒ€ê¸°ì¤‘</span>
                <h3 className="text-2xl font-bold text-gray-800 mt-3">{selectedProject.title}</h3>
                <p className="text-gray-600 mt-2">{selectedProject.organization || selectedProject.org}</p>
              </div>
              <span className="px-3 py-1 bg-blue-100 text-blue-700 rounded-lg text-sm font-medium">{selectedProject.category}</span>
            </div>
            <div className="grid grid-cols-3 gap-4 mt-4">
              <div className="bg-white rounded-lg p-4">
                <p className="text-sm text-gray-600 mb-1">ëª©í‘œ ê¸ˆì•¡</p>
                <p className="text-xl font-bold text-red-600">{(selectedProject.targetAmount || selectedProject.amount).toLocaleString()}ì›</p>
              </div>
              <div className="bg-white rounded-lg p-4">
                <p className="text-sm text-gray-600 mb-1">ì‹ ì²­ì¼</p>
                <p className="text-lg font-semibold text-gray-800">{selectedProject.date || '2024.11.15'}</p>
              </div>
              <div className="bg-white rounded-lg p-4">
                <p className="text-sm text-gray-600 mb-1">í”„ë¡œì íŠ¸ ID</p>
                <p className="text-lg font-semibold text-gray-800">#{selectedProject.id}</p>
              </div>
            </div>
          </div>

          <div className="bg-white border border-gray-200 rounded-xl p-6">
            <h4 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
              <Users size={20} className="text-pink-500" />
              ê¸°ê´€ ì •ë³´
            </h4>
            <div className="grid grid-cols-2 gap-4">
              <div>
                <p className="text-sm text-gray-600 mb-1">ê¸°ê´€ëª…</p>
                <p className="font-semibold text-gray-800">{selectedProject.org || selectedProject.organization || 'êµìœ¡ë‚˜ëˆ”ì¬ë‹¨'}</p>
              </div>
              <div>
                <p className="text-sm text-gray-600 mb-1">ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸</p>
                <p className="font-semibold text-gray-800">123-45-67890</p>
              </div>
              <div>
                <p className="text-sm text-gray-600 mb-1">ëŒ€í‘œì</p>
                <p className="font-semibold text-gray-800">í™ê¸¸ë™</p>
              </div>
              <div>
                <p className="text-sm text-gray-600 mb-1">ì—°ë½ì²˜</p>
                <p className="font-semibold text-gray-800">02-1234-5678</p>
              </div>
            </div>
          </div>

          <div className="bg-white border border-gray-200 rounded-xl p-6">
            <h4 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
              <FileText size={20} className="text-pink-500" />
              í”„ë¡œì íŠ¸ ì„¤ëª…
            </h4>
            <p className="text-gray-700 leading-relaxed">
              ì €ì†Œë“ì¸µ í•™ìƒë“¤ì—ê²Œ ì–‘ì§ˆì˜ êµìœ¡ ê¸°íšŒë¥¼ ì œê³µí•˜ì—¬ êµìœ¡ ê²©ì°¨ë¥¼ í•´ì†Œí•˜ê³ ì í•©ë‹ˆë‹¤.
              ë³¸ í”„ë¡œì íŠ¸ëŠ” í•™ìŠµ êµì¬ ì§€ì›, ì˜¨ë¼ì¸ êµìœ¡ í”Œë«í¼ êµ¬ë…, ê·¸ë¦¬ê³  ì „ë¬¸ íŠœí„°ë§ ì„œë¹„ìŠ¤ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.
            </p>
          </div>

          <div className="bg-white border border-gray-200 rounded-xl p-6">
            <h4 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
              <FileText size={20} className="text-purple-500" />
              ì²¨ë¶€ ì„œë¥˜
            </h4>
            <div className="space-y-3">
              <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition">
                <div className="flex items-center gap-3">
                  <div className="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center">
                    <FileText size={20} className="text-red-500" />
                  </div>
                  <div>
                    <p className="font-semibold text-gray-800">ì‚¬ì—…ê³„íšì„œ.pdf</p>
                    <p className="text-sm text-gray-500">2.4 MB</p>
                  </div>
                </div>
                <button className="px-4 py-2 bg-green-500 text-white rounded-lg text-sm font-semibold hover:bg-green-600">ë‹¤ìš´ë¡œë“œ</button>
              </div>
              <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition">
                <div className="flex items-center gap-3">
                  <div className="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
                    <FileText size={20} className="text-green-500" />
                  </div>
                  <div>
                    <p className="font-semibold text-gray-800">ì˜ˆì‚°ì„œ.xlsx</p>
                    <p className="text-sm text-gray-500">156 KB</p>
                  </div>
                </div>
                <button className="px-4 py-2 bg-green-500 text-white rounded-lg text-sm font-semibold hover:bg-green-600">ë‹¤ìš´ë¡œë“œ</button>
              </div>
              <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition">
                <div className="flex items-center gap-3">
                  <div className="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                    <FileText size={20} className="text-blue-500" />
                  </div>
                  <div>
                    <p className="font-semibold text-gray-800">ì‚¬ì—…ìë“±ë¡ì¦.pdf</p>
                    <p className="text-sm text-gray-500">890 KB</p>
                  </div>
                </div>
                <button className="px-4 py-2 bg-green-500 text-white rounded-lg text-sm font-semibold hover:bg-green-600">ë‹¤ìš´ë¡œë“œ</button>
              </div>
            </div>
          </div>

          <div className="bg-white border border-gray-200 rounded-xl p-6">
            <h4 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
              <AlertCircle size={20} className="text-orange-500" />
              ë°˜ë ¤ ì‚¬ìœ  (ì„ íƒ)
            </h4>
            <textarea
              value={rejectReason}
              onChange={(e) => setRejectReason(e.target.value)}
              placeholder="í”„ë¡œì íŠ¸ë¥¼ ë°˜ë ¤í•  ê²½ìš° ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”..."
              rows={4}
              className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none"
            />
          </div>
        </div>

        <div className="sticky bottom-0 bg-white border-t border-gray-200 p-6 flex gap-3">
          <button onClick={onClose} className="flex-1 px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-bold hover:bg-gray-50">ì·¨ì†Œ</button>
          <button onClick={handleRejectProject} className="flex-1 px-6 py-3 bg-red-500 text-white rounded-lg font-bold hover:bg-red-600">ë°˜ë ¤</button>
          <button onClick={handleApproveProject} className="flex-1 px-6 py-3 bg-green-500 text-white rounded-lg font-bold hover:bg-green-600">ìŠ¹ì¸</button>
        </div>
      </div>
    </div>
  );
});

const SettlementDetailModalContent: React.FC<{
  selectedSettlement: any;
  rejectReason: string;
  setRejectReason: (reason: string) => void;
  handleApproveSettlement: () => void;
  handleRejectSettlement: () => void;
  onClose: () => void;
}> = React.memo(({ selectedSettlement, rejectReason, setRejectReason, handleApproveSettlement, handleRejectSettlement, onClose }) => {
  const scrollContainerRef = React.useRef<HTMLDivElement>(null);
  const scrollPositionRef = React.useRef<number>(0);

  // ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ì €ì¥
  const handleScroll = () => {
    if (scrollContainerRef.current) {
      scrollPositionRef.current = scrollContainerRef.current.scrollTop;
    }
  };

  // ë Œë”ë§ í›„ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ë³µì›
  React.useEffect(() => {
    if (scrollContainerRef.current && scrollPositionRef.current > 0) {
      scrollContainerRef.current.scrollTop = scrollPositionRef.current;
    }
  });

  return (
    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
      <div
        ref={scrollContainerRef}
        onScroll={handleScroll}
        className="bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto"
      >
        <div className="sticky top-0 bg-white border-b border-gray-200 p-6 flex items-center justify-between">
          <div>
            <h2 className="text-2xl font-bold text-gray-800">ì •ì‚° ê²€í† </h2>
            <p className="text-sm text-gray-600 mt-1">ì •ì‚° ì •ë³´ë¥¼ í™•ì¸í•˜ê³  ìŠ¹ì¸/ê±°ë¶€ ì²˜ë¦¬í•˜ì„¸ìš”</p>
          </div>
          <button onClick={onClose} className="p-2 hover:bg-gray-100 rounded-lg">
            <X size={24} />
          </button>
        </div>

        <div className="p-6 space-y-6">
          <div className="bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-200">
            <span className="px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-xs font-semibold">ì •ì‚° ëŒ€ê¸°ì¤‘</span>
            <h3 className="text-2xl font-bold text-gray-800 mt-3">{selectedSettlement.project}</h3>
            <p className="text-gray-600 mt-2">{selectedSettlement.org}</p>
            <div className="bg-white rounded-lg p-6 mt-4">
              <div className="flex items-center justify-between mb-4">
                <span className="text-gray-600">ì •ì‚° ê¸ˆì•¡</span>
                <span className="text-3xl font-bold text-green-600">{selectedSettlement.amount.toLocaleString()}ì›</span>
              </div>
              <div className="flex items-center justify-between text-sm">
                <span className="text-gray-600">ì‹ ì²­ì¼</span>
                <span className="font-semibold text-gray-800">{selectedSettlement.date}</span>
              </div>
            </div>
          </div>

          <div className="bg-white border border-gray-200 rounded-xl p-6">
            <h4 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
              <FileText size={20} className="text-green-500" />
              í”„ë¡œì íŠ¸ ì •ë³´
            </h4>
            <div className="grid grid-cols-2 gap-4">
              <div className="bg-gray-50 rounded-lg p-4">
                <p className="text-sm text-gray-600 mb-1">ëª©í‘œ ê¸ˆì•¡</p>
                <p className="text-xl font-bold text-gray-800">50,000,000ì›</p>
              </div>
              <div className="bg-gray-50 rounded-lg p-4">
                <p className="text-sm text-gray-600 mb-1">ìµœì¢… ëª¨ê¸ˆì•¡</p>
                <p className="text-xl font-bold text-green-600">52,500,000ì›</p>
              </div>
              <div className="bg-gray-50 rounded-lg p-4">
                <p className="text-sm text-gray-600 mb-1">ë‹¬ì„±ë¥ </p>
                <p className="text-xl font-bold text-blue-600">105%</p>
              </div>
              <div className="bg-gray-50 rounded-lg p-4">
                <p className="text-sm text-gray-600 mb-1">ê¸°ë¶€ì ìˆ˜</p>
                <p className="text-xl font-bold text-purple-600">1,234ëª…</p>
              </div>
            </div>
          </div>

          <div className="bg-white border border-gray-200 rounded-xl p-6">
            <h4 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
              <CreditCard size={20} className="text-blue-500" />
              ì…ê¸ˆ ê³„ì¢Œ ì •ë³´
            </h4>
            <div className="bg-blue-50 rounded-lg p-4 space-y-3">
              <div className="flex items-center justify-between">
                <span className="text-sm text-gray-600">ì€í–‰ëª…</span>
                <span className="font-semibold text-gray-800">êµ­ë¯¼ì€í–‰</span>
              </div>
              <div className="flex items-center justify-between">
                <span className="text-sm text-gray-600">ê³„ì¢Œë²ˆí˜¸</span>
                <span className="font-semibold text-gray-800">123-456-789012</span>
              </div>
              <div className="flex items-center justify-between">
                <span className="text-sm text-gray-600">ì˜ˆê¸ˆì£¼</span>
                <span className="font-semibold text-gray-800">ì‚¬íšŒë³µì§€ë²•ì¸ í¬ë§ë‚˜ëˆ”</span>
              </div>
            </div>
          </div>

          <div className="bg-white border border-gray-200 rounded-xl p-6">
            <h4 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
              <FileText size={20} className="text-purple-500" />
              ì²¨ë¶€ ì„œë¥˜
            </h4>
            <div className="space-y-3">
              <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition">
                <div className="flex items-center gap-3">
                  <div className="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center">
                    <FileText size={20} className="text-red-500" />
                  </div>
                  <div>
                    <p className="font-semibold text-gray-800">ì‚¬ìš©ë‚´ì—­ì„œ.pdf</p>
                    <p className="text-sm text-gray-500">1.8 MB</p>
                  </div>
                </div>
                <button className="px-4 py-2 bg-green-500 text-white rounded-lg text-sm font-semibold hover:bg-green-600">ë‹¤ìš´ë¡œë“œ</button>
              </div>
              <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition">
                <div className="flex items-center gap-3">
                  <div className="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center">
                    <FileText size={20} className="text-red-500" />
                  </div>
                  <div>
                    <p className="font-semibold text-gray-800">ì˜ìˆ˜ì¦_ëª¨ìŒ.pdf</p>
                    <p className="text-sm text-gray-500">3.2 MB</p>
                  </div>
                </div>
                <button className="px-4 py-2 bg-green-500 text-white rounded-lg text-sm font-semibold hover:bg-green-600">ë‹¤ìš´ë¡œë“œ</button>
              </div>
            </div>
          </div>

          <div className="bg-amber-50 border border-amber-200 rounded-xl p-6">
            <h4 className="text-lg font-bold text-amber-800 mb-3 flex items-center gap-2">
              <AlertCircle size={20} className="text-amber-600" />
              ì£¼ì˜ì‚¬í•­
            </h4>
            <ul className="space-y-2 text-sm text-amber-900">
              <li className="flex items-start gap-2">
                <span className="text-amber-600 mt-0.5">â€¢</span>
                <span>ì •ì‚° ìŠ¹ì¸ í›„ ì·¨ì†Œê°€ ë¶ˆê°€ëŠ¥í•˜ë‹ˆ ì‹ ì¤‘íˆ ê²€í† í•´ì£¼ì„¸ìš”.</span>
              </li>
              <li className="flex items-start gap-2">
                <span className="text-amber-600 mt-0.5">â€¢</span>
                <span>ì²¨ë¶€ëœ ì„œë¥˜ë¥¼ ë°˜ë“œì‹œ í™•ì¸í•˜ì‹  í›„ ìŠ¹ì¸í•´ì£¼ì„¸ìš”.</span>
              </li>
              <li className="flex items-start gap-2">
                <span className="text-amber-600 mt-0.5">â€¢</span>
                <span>ìŠ¹ì¸ ì‹œ ì¦‰ì‹œ ì…ê¸ˆ ì²˜ë¦¬ë˜ë©°, ê±°ë˜ ë‚´ì—­ì´ ê¸°ë¡ë©ë‹ˆë‹¤.</span>
              </li>
            </ul>
          </div>

          <div className="bg-white border border-gray-200 rounded-xl p-6">
            <h4 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
              <AlertCircle size={20} className="text-orange-500" />
              ê±°ë¶€ ì‚¬ìœ  (ì„ íƒ)
            </h4>
            <textarea
              value={rejectReason}
              onChange={(e) => setRejectReason(e.target.value)}
              placeholder="ì •ì‚°ì„ ê±°ë¶€í•  ê²½ìš° ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”..."
              rows={4}
              className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none"
            />
          </div>
        </div>

        <div className="sticky bottom-0 bg-white border-t border-gray-200 p-6 flex gap-3">
          <button onClick={onClose} className="flex-1 px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-bold hover:bg-gray-50">ì·¨ì†Œ</button>
          <button onClick={handleRejectSettlement} className="flex-1 px-6 py-3 bg-red-500 text-white rounded-lg font-bold hover:bg-red-600">ê±°ë¶€</button>
          <button onClick={handleApproveSettlement} className="flex-1 px-6 py-3 bg-green-500 text-white rounded-lg font-bold hover:bg-green-600">ìŠ¹ì¸ ë° ì†¡ê¸ˆ</button>
        </div>
      </div>
    </div>
  );
});

// ============================================
// AdminDashboard Component (ì™¸ë¶€ ë¶„ë¦¬)
// ============================================
const AdminDashboard: React.FC<AdminDashboardProps> = ({
  sidebarOpen,
  setSidebarOpen,
  activeMenu,
  setActiveMenu,
  projectFilter,
  setProjectFilter,
  projectCategoryFilter,
  setProjectCategoryFilter,
  projectSearchTerm,
  setProjectSearchTerm,
  userTypeFilter,
  setUserTypeFilter,
  userStatusFilter,
  setUserStatusFilter,
  userSearchTerm,
  setUserSearchTerm,
  settlementFilter,
  setSettlementFilter,
  settlementSearchTerm,
  setSettlementSearchTerm,
  selectedProjects,
  setSelectedProjects,
  selectedUsers,
  setSelectedUsers,
  selectedSettlements,
  setSelectedSettlements,
  selectedProject,
  setSelectedProject,
  selectedUser,
  setSelectedUser,
  selectedSettlement,
  setSelectedSettlement,
  showProjectModal,
  setShowProjectModal,
  showUserModal,
  setShowUserModal,
  showSettlementModal,
  setShowSettlementModal,
  rejectReason,
  setRejectReason,
  adminUsers
}) => {
  const stats = {
    todayDonation: 8500000,
    donationChange: 15.3,
    newUsers: 142,
    userChange: 8.2,
    pendingApprovals: 5,
    pendingSettlements: 3
  };

  const recentProjects = [
    { id: 1, title: 'ì €ì†Œë“ì¸µ í•™ìƒ êµìœ¡ë¹„ ì§€ì›', org: 'êµìœ¡ë‚˜ëˆ”ì¬ë‹¨', amount: 10000000, status: 'pending', date: '2024-10-07', category: 'êµìœ¡' },
    { id: 2, title: 'ë…ê±°ë…¸ì¸ ìƒí™œ ì§€ì› í”„ë¡œì íŠ¸', org: 'í¬ë§ë‚˜ëˆ”ì„¼í„°', amount: 5000000, status: 'pending', date: '2024-10-06', category: 'ë…¸ì¸' },
    { id: 3, title: 'ì¥ì• ì¸ ì¼ìë¦¬ ì°½ì¶œ ì‚¬ì—…', org: 'í•¨ê»˜ì¼í•˜ëŠ”ì„¸ìƒ', amount: 15000000, status: 'pending', date: '2024-10-05', category: 'ì¥ì• ì¸' },
    { id: 4, title: 'ì§€ì—­ì•„ë™ì„¼í„° ê¸‰ì‹ ì§€ì›', org: 'ì•„ì´ì‚¬ë‘ë³µì§€ê´€', amount: 7500000, status: 'approved', date: '2024-10-04', category: 'ì•„ë™' },
    { id: 5, title: 'í™˜ê²½ë³´í˜¸ ìº í˜ì¸ ìš´ì˜', org: 'ê·¸ë¦°í”¼ìŠ¤ì½”ë¦¬ì•„', amount: 20000000, status: 'rejected', date: '2024-10-03', category: 'í™˜ê²½' },
  ];

  const settlements = [
    { id: 1, project: 'ë…ê±°ë…¸ì¸ ìƒí™œ ì§€ì›', org: 'ì‹¤ë²„ì¼€ì–´ì„¼í„°', amount: 9800000, date: '2024-03-15', status: 'pending', files: 2 },
    { id: 2, project: 'ì²­ì†Œë…„ ì§„ë¡œ ë©˜í† ë§', org: 'ì²­ë…„ë¯¸ë˜ì¬ë‹¨', amount: 15000000, date: '2024-03-10', status: 'pending', files: 3 },
    { id: 3, project: 'ì¥ì• ì¸ ì¬í™œ í”„ë¡œê·¸ë¨', org: 'í•¨ê»˜ê°€ëŠ”ë³µì§€ê´€', amount: 8500000, date: '2024-03-05', status: 'completed', files: 2 },
  ];

  // Modal handler functions (useCallbackìœ¼ë¡œ ë©”ëª¨ì´ì œì´ì…˜)
  const handleApproveProject = React.useCallback(() => {
    if (window.confirm('ì´ í”„ë¡œì íŠ¸ë¥¼ ìŠ¹ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
      alert('í”„ë¡œì íŠ¸ê°€ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.');
      setShowProjectModal(false);
      setSelectedProject(null);
    }
  }, [setShowProjectModal, setSelectedProject]);

  const handleRejectProject = React.useCallback(() => {
    if (!rejectReason.trim()) {
      alert('ë°˜ë ¤ ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
      return;
    }
    if (window.confirm('ì´ í”„ë¡œì íŠ¸ë¥¼ ë°˜ë ¤í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
      alert('í”„ë¡œì íŠ¸ê°€ ë°˜ë ¤ë˜ì—ˆìŠµë‹ˆë‹¤.');
      setShowProjectModal(false);
      setSelectedProject(null);
      setRejectReason('');
    }
  }, [rejectReason, setShowProjectModal, setSelectedProject, setRejectReason]);

  const handleApproveSettlement = React.useCallback(() => {
    if (window.confirm('ì •ì‚°ì„ ìŠ¹ì¸í•˜ê³  ì†¡ê¸ˆ ì²˜ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
      alert('ì •ì‚°ì´ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤. ì†¡ê¸ˆ ì²˜ë¦¬ê°€ ì§„í–‰ë©ë‹ˆë‹¤.');
      setShowSettlementModal(false);
      setSelectedSettlement(null);
    }
  }, [setShowSettlementModal, setSelectedSettlement]);

  const handleRejectSettlement = React.useCallback(() => {
    if (!rejectReason.trim()) {
      alert('ê±°ë¶€ ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
      return;
    }
    if (window.confirm('ì´ ì •ì‚° ìš”ì²­ì„ ê±°ë¶€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
      alert('ì •ì‚° ìš”ì²­ì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.');
      setShowSettlementModal(false);
      setSelectedSettlement(null);
      setRejectReason('');
    }
  }, [rejectReason, setShowSettlementModal, setSelectedSettlement, setRejectReason]);

  const handleChangeUserStatus = React.useCallback((status: string) => {
    if (window.confirm(`ì‚¬ìš©ì ìƒíƒœë¥¼ "${status}"ë¡œ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
      alert('ì‚¬ìš©ì ìƒíƒœê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.');
    }
  }, []);

  const handleCloseProjectModal = React.useCallback(() => {
    setShowProjectModal(false);
    setSelectedProject(null);
    setRejectReason('');
  }, [setShowProjectModal, setSelectedProject, setRejectReason]);

  const handleCloseSettlementModal = React.useCallback(() => {
    setShowSettlementModal(false);
    setSelectedSettlement(null);
    setRejectReason('');
  }, [setShowSettlementModal, setSelectedSettlement, setRejectReason]);

  return (
    <>
      {/* Project Detail Modal */}
      {showProjectModal && selectedProject && (
        <ProjectDetailModalContent
          selectedProject={selectedProject}
          rejectReason={rejectReason}
          setRejectReason={setRejectReason}
          handleApproveProject={handleApproveProject}
          handleRejectProject={handleRejectProject}
          onClose={handleCloseProjectModal}
        />
      )}

      {/* Settlement Detail Modal - OLD CODE TO REMOVE */}
      {false && showProjectModal && selectedProject && (
          <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
            <div className="bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto" key={`project-modal-${selectedProject.id}`}>
              <div className="sticky top-0 bg-white border-b border-gray-200 p-6 flex items-center justify-between">
                <div>
                  <h2 className="text-2xl font-bold text-gray-800">í”„ë¡œì íŠ¸ ê²€í† </h2>
                  <p className="text-sm text-gray-600 mt-1">í”„ë¡œì íŠ¸ ì •ë³´ë¥¼ í™•ì¸í•˜ê³  ìŠ¹ì¸/ë°˜ë ¤ ì²˜ë¦¬í•˜ì„¸ìš”</p>
                </div>
                <button
                  onClick={() => {
                    setShowProjectModal(false);
                    setSelectedProject(null);
                    setRejectReason('');
                  }}
                  className="p-2 hover:bg-gray-100 rounded-lg"
                >
                  <X size={24} />
                </button>
              </div>

              <div className="p-6 space-y-6">
                <div className="bg-gradient-to-r from-red-50 to-pink-50 rounded-xl p-6 border border-red-200">
                  <div className="flex items-start justify-between mb-4">
                    <div>
                      <span className="px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-xs font-semibold">ìŠ¹ì¸ ëŒ€ê¸°ì¤‘</span>
                      <h3 className="text-2xl font-bold text-gray-800 mt-3">{selectedProject.title}</h3>
                      <p className="text-gray-600 mt-2">{selectedProject.organization || selectedProject.org}</p>
                    </div>
                    <span className="px-3 py-1 bg-blue-100 text-blue-700 rounded-lg text-sm font-medium">{selectedProject.category}</span>
                  </div>
                  <div className="grid grid-cols-3 gap-4 mt-4">
                    <div className="bg-white rounded-lg p-4">
                      <p className="text-sm text-gray-600 mb-1">ëª©í‘œ ê¸ˆì•¡</p>
                      <p className="text-xl font-bold text-red-600">{(selectedProject.targetAmount || selectedProject.amount).toLocaleString()}ì›</p>
                    </div>
                    <div className="bg-white rounded-lg p-4">
                      <p className="text-sm text-gray-600 mb-1">ì‹ ì²­ì¼</p>
                      <p className="text-lg font-semibold text-gray-800">{selectedProject.date || '2024.11.15'}</p>
                    </div>
                    <div className="bg-white rounded-lg p-4">
                      <p className="text-sm text-gray-600 mb-1">í”„ë¡œì íŠ¸ ID</p>
                      <p className="text-lg font-semibold text-gray-800">#{selectedProject.id}</p>
                    </div>
                  </div>
                </div>

                <div className="bg-white border border-gray-200 rounded-xl p-6">
                  <h4 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <Users size={20} className="text-pink-500" />
                    ê¸°ê´€ ì •ë³´
                  </h4>
                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <p className="text-sm text-gray-600 mb-1">ê¸°ê´€ëª…</p>
                      <p className="font-semibold text-gray-800">{selectedProject.org}</p>
                    </div>
                    <div>
                      <p className="text-sm text-gray-600 mb-1">ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸</p>
                      <p className="font-semibold text-gray-800">123-45-67890</p>
                    </div>
                    <div>
                      <p className="text-sm text-gray-600 mb-1">ëŒ€í‘œì</p>
                      <p className="font-semibold text-gray-800">í™ê¸¸ë™</p>
                    </div>
                    <div>
                      <p className="text-sm text-gray-600 mb-1">ì—°ë½ì²˜</p>
                      <p className="font-semibold text-gray-800">02-1234-5678</p>
                    </div>
                  </div>
                </div>

                <div className="bg-white border border-gray-200 rounded-xl p-6">
                  <h4 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <FileText size={20} className="text-pink-500" />
                    í”„ë¡œì íŠ¸ ì„¤ëª…
                  </h4>
                  <div className="prose max-w-none text-gray-700">
                    <p>ê²½ì œì  ì–´ë ¤ì›€ìœ¼ë¡œ í•™ìŠµ ê¸°íšŒë¥¼ ë†“ì¹˜ëŠ” ì €ì†Œë“ì¸µ í•™ìƒë“¤ì„ ìœ„í•œ êµìœ¡ë¹„ ì§€ì› í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤. êµê³¼ì„œ, ì°¸ê³ ì„œ, ì˜¨ë¼ì¸ ê°•ì˜ ìˆ˜ê°•ë£Œ ë“±ì„ ì§€ì›í•˜ì—¬ í•™ìŠµê¶Œì„ ë³´ì¥í•˜ê³ ì í•©ë‹ˆë‹¤.</p>
                    <p className="mt-3">ì§€ì› ëŒ€ìƒ: ê¸°ì´ˆìƒí™œìˆ˜ê¸‰ì ê°€ì •ì˜ ì´ˆì¤‘ê³  í•™ìƒ 50ëª…</p>
                    <p className="mt-2">ì§€ì› ë‚´ìš©: 1ì¸ë‹¹ 200,000ì› (êµì¬ë¹„ + ì˜¨ë¼ì¸ ê°•ì˜)</p>
                  </div>
                </div>

                <div className="bg-white border border-gray-200 rounded-xl p-6">
                  <h4 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <FileText size={20} className="text-pink-500" />
                    ì²¨ë¶€ ì„œë¥˜
                  </h4>
                  <div className="space-y-3">
                    <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                      <div className="flex items-center gap-3">
                        <div className="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center">
                          <FileText className="text-red-600" size={20} />
                        </div>
                        <div>
                          <p className="font-semibold text-gray-800">ì‚¬ì—…ê³„íšì„œ.pdf</p>
                          <p className="text-sm text-gray-500">2.4 MB</p>
                        </div>
                      </div>
                      <button className="px-4 py-2 bg-pink-500 text-white rounded-lg hover:bg-pink-600 font-semibold text-sm">
                        ë‹¤ìš´ë¡œë“œ
                      </button>
                    </div>
                    <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                      <div className="flex items-center gap-3">
                        <div className="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center">
                          <FileText className="text-red-600" size={20} />
                        </div>
                        <div>
                          <p className="font-semibold text-gray-800">ì˜ˆì‚°ì„œ.xlsx</p>
                          <p className="text-sm text-gray-500">156 KB</p>
                        </div>
                      </div>
                      <button className="px-4 py-2 bg-pink-500 text-white rounded-lg hover:bg-pink-600 font-semibold text-sm">
                        ë‹¤ìš´ë¡œë“œ
                      </button>
                    </div>
                    <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                      <div className="flex items-center gap-3">
                        <div className="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center">
                          <FileText className="text-red-600" size={20} />
                        </div>
                        <div>
                          <p className="font-semibold text-gray-800">ì‚¬ì—…ìë“±ë¡ì¦.pdf</p>
                          <p className="text-sm text-gray-500">890 KB</p>
                        </div>
                      </div>
                      <button className="px-4 py-2 bg-pink-500 text-white rounded-lg hover:bg-pink-600 font-semibold text-sm">
                        ë‹¤ìš´ë¡œë“œ
                      </button>
                    </div>
                  </div>
                </div>

                <div className="bg-white border border-gray-200 rounded-xl p-6">
                  <h4 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <AlertCircle size={20} className="text-orange-500" />
                    ë°˜ë ¤ ì‚¬ìœ  (ì„ íƒ)
                  </h4>
                  <textarea
                    value={rejectReason}
                    onChange={(e) => setRejectReason(e.target.value)}
                    placeholder="í”„ë¡œì íŠ¸ë¥¼ ë°˜ë ¤í•  ê²½ìš° ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”..."
                    rows={4}
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none"
                  />
                </div>
              </div>

              <div className="sticky bottom-0 bg-white border-t border-gray-200 p-6 flex gap-3">
                <button onClick={() => { setShowProjectModal(false); setSelectedProject(null); setRejectReason(''); }} className="flex-1 px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-bold hover:bg-gray-50">ì·¨ì†Œ</button>
                <button onClick={handleRejectProject} className="flex-1 px-6 py-3 bg-red-500 text-white rounded-lg font-bold hover:bg-red-600">ë°˜ë ¤</button>
                <button onClick={handleApproveProject} className="flex-1 px-6 py-3 bg-green-500 text-white rounded-lg font-bold hover:bg-green-600">ìŠ¹ì¸</button>
              </div>
            </div>
          </div>
        )}

        {/* Settlement Detail Modal */}
        {showSettlementModal && selectedSettlement && (
          <SettlementDetailModalContent
            selectedSettlement={selectedSettlement}
            rejectReason={rejectReason}
            setRejectReason={setRejectReason}
            handleApproveSettlement={handleApproveSettlement}
            handleRejectSettlement={handleRejectSettlement}
            onClose={handleCloseSettlementModal}
          />
        )}

        {/* Settlement Detail Modal - OLD CODE TO REMOVE */}
        {false && showSettlementModal && selectedSettlement && (
          <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
            <div className="bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
              <div className="sticky top-0 bg-white border-b border-gray-200 p-6 flex items-center justify-between">
                <div>
                  <h2 className="text-2xl font-bold text-gray-800">ì •ì‚° ê²€í† </h2>
                  <p className="text-sm text-gray-600 mt-1">ì •ì‚° ì •ë³´ë¥¼ í™•ì¸í•˜ê³  ìŠ¹ì¸/ê±°ë¶€ ì²˜ë¦¬í•˜ì„¸ìš”</p>
                </div>
                <button onClick={() => { setShowSettlementModal(false); setSelectedSettlement(null); setRejectReason(''); }} className="p-2 hover:bg-gray-100 rounded-lg">
                  <X size={24} />
                </button>
              </div>

              <div className="p-6 space-y-6">
                <div className="bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-200">
                  <span className="px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-xs font-semibold">ì •ì‚° ëŒ€ê¸°ì¤‘</span>
                  <h3 className="text-2xl font-bold text-gray-800 mt-3">{selectedSettlement.project}</h3>
                  <p className="text-gray-600 mt-2">{selectedSettlement.org}</p>
                  <div className="bg-white rounded-lg p-6 mt-4">
                    <div className="flex items-center justify-between mb-4">
                      <span className="text-gray-600">ì •ì‚° ê¸ˆì•¡</span>
                      <span className="text-3xl font-bold text-green-600">{selectedSettlement.amount.toLocaleString()}ì›</span>
                    </div>
                    <div className="flex items-center justify-between text-sm">
                      <span className="text-gray-600">ì‹ ì²­ì¼</span>
                      <span className="font-semibold text-gray-800">{selectedSettlement.date}</span>
                    </div>
                  </div>
                </div>

                {/* í”„ë¡œì íŠ¸ ì •ë³´ */}
                <div className="bg-white border border-gray-200 rounded-xl p-6">
                  <h4 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <FileText size={20} className="text-green-500" />
                    í”„ë¡œì íŠ¸ ì •ë³´
                  </h4>
                  <div className="grid grid-cols-2 gap-4">
                    <div className="bg-gray-50 rounded-lg p-4">
                      <p className="text-sm text-gray-600 mb-1">ëª©í‘œ ê¸ˆì•¡</p>
                      <p className="text-xl font-bold text-gray-800">50,000,000ì›</p>
                    </div>
                    <div className="bg-gray-50 rounded-lg p-4">
                      <p className="text-sm text-gray-600 mb-1">ìµœì¢… ëª¨ê¸ˆì•¡</p>
                      <p className="text-xl font-bold text-green-600">52,500,000ì›</p>
                    </div>
                    <div className="bg-gray-50 rounded-lg p-4">
                      <p className="text-sm text-gray-600 mb-1">ë‹¬ì„±ë¥ </p>
                      <p className="text-xl font-bold text-blue-600">105%</p>
                    </div>
                    <div className="bg-gray-50 rounded-lg p-4">
                      <p className="text-sm text-gray-600 mb-1">ê¸°ë¶€ì ìˆ˜</p>
                      <p className="text-xl font-bold text-purple-600">1,234ëª…</p>
                    </div>
                  </div>
                </div>

                {/* ì…ê¸ˆ ê³„ì¢Œ ì •ë³´ */}
                <div className="bg-white border border-gray-200 rounded-xl p-6">
                  <h4 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <CreditCard size={20} className="text-blue-500" />
                    ì…ê¸ˆ ê³„ì¢Œ ì •ë³´
                  </h4>
                  <div className="bg-blue-50 rounded-lg p-4 space-y-3">
                    <div className="flex items-center justify-between">
                      <span className="text-sm text-gray-600">ì€í–‰ëª…</span>
                      <span className="font-semibold text-gray-800">êµ­ë¯¼ì€í–‰</span>
                    </div>
                    <div className="flex items-center justify-between">
                      <span className="text-sm text-gray-600">ê³„ì¢Œë²ˆí˜¸</span>
                      <span className="font-semibold text-gray-800">123-456-789012</span>
                    </div>
                    <div className="flex items-center justify-between">
                      <span className="text-sm text-gray-600">ì˜ˆê¸ˆì£¼</span>
                      <span className="font-semibold text-gray-800">ì‚¬íšŒë³µì§€ë²•ì¸ í¬ë§ë‚˜ëˆ”</span>
                    </div>
                  </div>
                </div>

                {/* ì²¨ë¶€ ì„œë¥˜ */}
                <div className="bg-white border border-gray-200 rounded-xl p-6">
                  <h4 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <FileText size={20} className="text-purple-500" />
                    ì²¨ë¶€ ì„œë¥˜
                  </h4>
                  <div className="space-y-3">
                    <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition">
                      <div className="flex items-center gap-3">
                        <div className="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center">
                          <FileText size={20} className="text-red-500" />
                        </div>
                        <div>
                          <p className="font-semibold text-gray-800">ì‚¬ìš©ë‚´ì—­ì„œ.pdf</p>
                          <p className="text-sm text-gray-500">1.8 MB</p>
                        </div>
                      </div>
                      <button className="px-4 py-2 bg-green-500 text-white rounded-lg text-sm font-semibold hover:bg-green-600">ë‹¤ìš´ë¡œë“œ</button>
                    </div>
                    <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition">
                      <div className="flex items-center gap-3">
                        <div className="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center">
                          <FileText size={20} className="text-red-500" />
                        </div>
                        <div>
                          <p className="font-semibold text-gray-800">ì˜ìˆ˜ì¦_ëª¨ìŒ.pdf</p>
                          <p className="text-sm text-gray-500">3.2 MB</p>
                        </div>
                      </div>
                      <button className="px-4 py-2 bg-green-500 text-white rounded-lg text-sm font-semibold hover:bg-green-600">ë‹¤ìš´ë¡œë“œ</button>
                    </div>
                  </div>
                </div>

                {/* ì£¼ì˜ì‚¬í•­ */}
                <div className="bg-amber-50 border border-amber-200 rounded-xl p-6">
                  <h4 className="text-lg font-bold text-amber-800 mb-3 flex items-center gap-2">
                    <AlertCircle size={20} className="text-amber-600" />
                    ì£¼ì˜ì‚¬í•­
                  </h4>
                  <ul className="space-y-2 text-sm text-amber-900">
                    <li className="flex items-start gap-2">
                      <span className="text-amber-600 mt-0.5">â€¢</span>
                      <span>ì •ì‚° ìŠ¹ì¸ í›„ ì·¨ì†Œê°€ ë¶ˆê°€ëŠ¥í•˜ë‹ˆ ì‹ ì¤‘íˆ ê²€í† í•´ì£¼ì„¸ìš”.</span>
                    </li>
                    <li className="flex items-start gap-2">
                      <span className="text-amber-600 mt-0.5">â€¢</span>
                      <span>ì²¨ë¶€ëœ ì„œë¥˜ë¥¼ ë°˜ë“œì‹œ í™•ì¸í•˜ì‹  í›„ ìŠ¹ì¸í•´ì£¼ì„¸ìš”.</span>
                    </li>
                    <li className="flex items-start gap-2">
                      <span className="text-amber-600 mt-0.5">â€¢</span>
                      <span>ìŠ¹ì¸ ì‹œ ì¦‰ì‹œ ì…ê¸ˆ ì²˜ë¦¬ë˜ë©°, ê±°ë˜ ë‚´ì—­ì´ ê¸°ë¡ë©ë‹ˆë‹¤.</span>
                    </li>
                  </ul>
                </div>

                <div className="bg-white border border-gray-200 rounded-xl p-6">
                  <h4 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <AlertCircle size={20} className="text-orange-500" />
                    ê±°ë¶€ ì‚¬ìœ  (ì„ íƒ)
                  </h4>
                  <textarea
                    value={rejectReason}
                    onChange={(e) => setRejectReason(e.target.value)}
                    placeholder="ì •ì‚°ì„ ê±°ë¶€í•  ê²½ìš° ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”..."
                    rows={4}
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none"
                  />
                </div>
              </div>

              <div className="sticky bottom-0 bg-white border-t border-gray-200 p-6 flex gap-3">
                <button onClick={() => { setShowSettlementModal(false); setSelectedSettlement(null); setRejectReason(''); }} className="flex-1 px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-bold hover:bg-gray-50">ì·¨ì†Œ</button>
                <button onClick={handleRejectSettlement} className="flex-1 px-6 py-3 bg-red-500 text-white rounded-lg font-bold hover:bg-red-600">ê±°ë¶€</button>
                <button onClick={handleApproveSettlement} className="flex-1 px-6 py-3 bg-green-500 text-white rounded-lg font-bold hover:bg-green-600">ìŠ¹ì¸ ë° ì†¡ê¸ˆ</button>
              </div>
            </div>
          </div>
        )}

        {/* User Detail Modal */}
        {showUserModal && selectedUser && (
          <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
            <div className="bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
              <div className="sticky top-0 bg-white border-b border-gray-200 p-6 flex items-center justify-between">
                <div>
                  <h2 className="text-2xl font-bold text-gray-800">ì‚¬ìš©ì ìƒì„¸ ì •ë³´</h2>
                  <p className="text-sm text-gray-600 mt-1">ì‚¬ìš©ì ì •ë³´ë¥¼ í™•ì¸í•˜ê³  ê´€ë¦¬í•˜ì„¸ìš”</p>
                </div>
                <button onClick={() => { setShowUserModal(false); setSelectedUser(null); }} className="p-2 hover:bg-gray-100 rounded-lg">
                  <X size={24} />
                </button>
              </div>

              <div className="p-6 space-y-6">
                <div className="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200">
                  <div className="flex items-start gap-4">
                    <div className="w-20 h-20 bg-gradient-to-br from-red-500 to-pink-500 rounded-full flex items-center justify-center text-white text-2xl font-bold">
                      {selectedUser.name[0]}
                    </div>
                    <div className="flex-1">
                      <div className="flex items-center gap-3 mb-2">
                        <h3 className="text-2xl font-bold text-gray-800">{selectedUser.name}</h3>
                        <span className={`px-3 py-1 rounded-full text-xs font-semibold ${selectedUser.status === 'active' ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-700'}`}>{selectedUser.status === 'active' ? 'í™œì„±' : 'ë¹„í™œì„±'}</span>
                      </div>
                      <p className="text-gray-600">{selectedUser.email}</p>
                      <div className="flex items-center gap-4 mt-3 text-sm">
                        <span className="text-gray-500">ê°€ì…ì¼: 2024.01.15</span>
                        <span className="text-gray-500">ìµœê·¼ ì ‘ì†: 2024.12.28</span>
                      </div>
                    </div>
                  </div>
                </div>

                {/* í™œë™ í†µê³„ */}
                <div className="bg-white border border-gray-200 rounded-xl p-6">
                  <h4 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <BarChart3 size={20} className="text-blue-500" />
                    í™œë™ í†µê³„
                  </h4>
                  <div className="grid grid-cols-3 gap-4">
                    <div className="bg-blue-50 rounded-lg p-4 text-center">
                      <p className="text-sm text-gray-600 mb-1">ì´ ê¸°ë¶€ íšŸìˆ˜</p>
                      <p className="text-2xl font-bold text-blue-600">24íšŒ</p>
                    </div>
                    <div className="bg-green-50 rounded-lg p-4 text-center">
                      <p className="text-sm text-gray-600 mb-1">ì´ ê¸°ë¶€ ê¸ˆì•¡</p>
                      <p className="text-2xl font-bold text-green-600">850,000ì›</p>
                    </div>
                    <div className="bg-purple-50 rounded-lg p-4 text-center">
                      <p className="text-sm text-gray-600 mb-1">ì°¸ì—¬ í”„ë¡œì íŠ¸</p>
                      <p className="text-2xl font-bold text-purple-600">12ê°œ</p>
                    </div>
                  </div>
                </div>

                {/* ê¸°ë¶€ ì´ë ¥ */}
                <div className="bg-white border border-gray-200 rounded-xl p-6">
                  <h4 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <Heart size={20} className="text-red-500" />
                    ìµœê·¼ ê¸°ë¶€ ì´ë ¥
                  </h4>
                  <div className="space-y-3">
                    <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                      <div>
                        <p className="font-semibold text-gray-800">ì•„ë™ ê¸‰ì‹ ì§€ì› í”„ë¡œì íŠ¸</p>
                        <p className="text-sm text-gray-500">2024.12.20</p>
                      </div>
                      <span className="text-lg font-bold text-green-600">50,000ì›</span>
                    </div>
                    <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                      <div>
                        <p className="font-semibold text-gray-800">ë…ê±°ë…¸ì¸ ìƒí™œ ì§€ì›</p>
                        <p className="text-sm text-gray-500">2024.12.15</p>
                      </div>
                      <span className="text-lg font-bold text-green-600">30,000ì›</span>
                    </div>
                    <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                      <div>
                        <p className="font-semibold text-gray-800">ì¥ì• ì¸ ì¬í™œ í”„ë¡œê·¸ë¨</p>
                        <p className="text-sm text-gray-500">2024.12.10</p>
                      </div>
                      <span className="text-lg font-bold text-green-600">100,000ì›</span>
                    </div>
                  </div>
                </div>

                {/* í™œë™ ë¡œê·¸ */}
                <div className="bg-white border border-gray-200 rounded-xl p-6">
                  <h4 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <Clock size={20} className="text-orange-500" />
                    ìµœê·¼ í™œë™ ë¡œê·¸
                  </h4>
                  <div className="space-y-3">
                    <div className="flex items-start gap-3 p-3 bg-gray-50 rounded-lg">
                      <div className="w-2 h-2 bg-green-500 rounded-full mt-2"></div>
                      <div className="flex-1">
                        <p className="text-sm text-gray-800">í”„ë¡œì íŠ¸ ê¸°ë¶€ ì™„ë£Œ</p>
                        <p className="text-xs text-gray-500">2024.12.20 14:32</p>
                      </div>
                    </div>
                    <div className="flex items-start gap-3 p-3 bg-gray-50 rounded-lg">
                      <div className="w-2 h-2 bg-blue-500 rounded-full mt-2"></div>
                      <div className="flex-1">
                        <p className="text-sm text-gray-800">í”„ë¡œì íŠ¸ ìƒì„¸ ì¡°íšŒ</p>
                        <p className="text-xs text-gray-500">2024.12.20 14:28</p>
                      </div>
                    </div>
                    <div className="flex items-start gap-3 p-3 bg-gray-50 rounded-lg">
                      <div className="w-2 h-2 bg-purple-500 rounded-full mt-2"></div>
                      <div className="flex-1">
                        <p className="text-sm text-gray-800">ë¡œê·¸ì¸</p>
                        <p className="text-xs text-gray-500">2024.12.20 14:25</p>
                      </div>
                    </div>
                    <div className="flex items-start gap-3 p-3 bg-gray-50 rounded-lg">
                      <div className="w-2 h-2 bg-green-500 rounded-full mt-2"></div>
                      <div className="flex-1">
                        <p className="text-sm text-gray-800">í”„ë¡œì íŠ¸ ê¸°ë¶€ ì™„ë£Œ</p>
                        <p className="text-xs text-gray-500">2024.12.15 09:15</p>
                      </div>
                    </div>
                  </div>
                </div>

                <div className="bg-white border border-gray-200 rounded-xl p-6">
                  <h4 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <Settings size={20} className="text-pink-500" />
                    ì‚¬ìš©ì ê´€ë¦¬
                  </h4>
                  <div className="grid grid-cols-3 gap-3">
                    <button onClick={() => handleChangeUserStatus('í™œì„±')} className="px-4 py-3 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600">í™œì„±í™”</button>
                    <button onClick={() => handleChangeUserStatus('ë¹„í™œì„±')} className="px-4 py-3 bg-gray-500 text-white rounded-lg font-semibold hover:bg-gray-600">ë¹„í™œì„±í™”</button>
                    <button onClick={() => handleChangeUserStatus('ì •ì§€')} className="px-4 py-3 bg-red-500 text-white rounded-lg font-semibold hover:bg-red-600">ê³„ì • ì •ì§€</button>
                  </div>
                </div>
              </div>

              <div className="sticky bottom-0 bg-white border-t border-gray-200 p-6 flex gap-3">
                <button onClick={() => { setShowUserModal(false); setSelectedUser(null); }} className="flex-1 px-6 py-3 bg-gray-500 text-white rounded-lg font-bold hover:bg-gray-600">ë‹«ê¸°</button>
              </div>
            </div>
          </div>
        )}

        <div className="flex h-screen bg-gray-50">
        {/* ì‚¬ì´ë“œë°” */}
        <div className={`bg-gradient-to-b from-gray-900 to-gray-800 text-white transition-all duration-300 ${sidebarOpen ? 'w-64' : 'w-20'}`}>
          <div className="p-4 border-b border-gray-700 flex items-center justify-between">
            {sidebarOpen && <h1 className="text-xl font-bold">ìœ„ë²¡íŠ¸ ê´€ë¦¬ì</h1>}
            <button onClick={() => setSidebarOpen(!sidebarOpen)} className="p-2 hover:bg-gray-700 rounded-lg">
              <Menu size={20} />
            </button>
          </div>

          <nav className="p-4 space-y-2">
            {[
              { id: 'dashboard', icon: LayoutDashboard, label: 'ëŒ€ì‹œë³´ë“œ' },
              { id: 'projects', icon: FolderCheck, label: 'í”„ë¡œì íŠ¸ ìŠ¹ì¸' },
              { id: 'users', icon: Users, label: 'ì‚¬ìš©ì ê´€ë¦¬' },
              { id: 'settlements', icon: DollarSign, label: 'ì •ì‚° ê´€ë¦¬' },
              { id: 'reports', icon: BarChart3, label: 'í†µê³„ ë¦¬í¬íŠ¸' },
              { id: 'settings', icon: Settings, label: 'ì„¤ì •' },
            ].map((item) => {
              const Icon = item.icon;
              return (
                <button
                  key={item.id}
                  onClick={() => setActiveMenu(item.id)}
                  className={`w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${
                    activeMenu === item.id
                      ? 'bg-gradient-to-r from-red-500 to-pink-500 text-white'
                      : 'text-gray-300 hover:bg-gray-700'
                  }`}
                >
                  <Icon size={20} />
                  {sidebarOpen && <span className="font-medium">{item.label}</span>}
                </button>
              );
            })}
          </nav>
        </div>

        {/* ë©”ì¸ ì½˜í…ì¸  */}
        <div className="flex-1 overflow-auto">
          {/* í—¤ë” */}
          <div className="bg-white border-b border-gray-200 px-8 py-4 flex items-center justify-between sticky top-0 z-10">
            <div>
              <h2 className="text-2xl font-bold text-gray-800">
                {activeMenu === 'dashboard' && 'ëŒ€ì‹œë³´ë“œ'}
                {activeMenu === 'projects' && 'í”„ë¡œì íŠ¸ ìŠ¹ì¸ ê´€ë¦¬'}
                {activeMenu === 'users' && 'ì‚¬ìš©ì ê´€ë¦¬'}
                {activeMenu === 'settlements' && 'ì •ì‚° ê´€ë¦¬'}
                {activeMenu === 'reports' && 'í†µê³„ ë¦¬í¬íŠ¸'}
                {activeMenu === 'settings' && 'ì„¤ì •'}
              </h2>
              <p className="text-sm text-gray-600 mt-1">
                {activeMenu === 'dashboard' && 'ì‹¤ì‹œê°„ ì‹œìŠ¤í…œ í˜„í™©ì„ í™•ì¸í•˜ì„¸ìš”'}
                {activeMenu === 'projects' && 'í”„ë¡œì íŠ¸ ìŠ¹ì¸ ìš”ì²­ì„ ê²€í† í•˜ê³  ê´€ë¦¬í•˜ì„¸ìš”'}
                {activeMenu === 'users' && 'í”Œë«í¼ ì‚¬ìš©ì ì •ë³´ë¥¼ ê´€ë¦¬í•˜ì„¸ìš”'}
                {activeMenu === 'settlements' && 'ì •ì‚° ìš”ì²­ì„ ì²˜ë¦¬í•˜ê³  ë‚´ì—­ì„ í™•ì¸í•˜ì„¸ìš”'}
                {activeMenu === 'reports' && 'ê¸°ë¶€ ë° í”„ë¡œì íŠ¸ í†µê³„ë¥¼ í™•ì¸í•˜ì„¸ìš”'}
                {activeMenu === 'settings' && 'ì‹œìŠ¤í…œ ì„¤ì •ì„ ê´€ë¦¬í•˜ì„¸ìš”'}
              </p>
            </div>
          </div>

          {/* ëŒ€ì‹œë³´ë“œ ì»¨í…ì¸  */}
          {activeMenu === 'dashboard' && (
            <div className="p-8 space-y-6">
              {/* í†µê³„ ì¹´ë“œ */}
              <div className="grid grid-cols-4 gap-6">
                <div className="bg-white rounded-xl p-6 border border-gray-200 shadow-sm hover:shadow-md transition-shadow">
                  <div className="flex items-center justify-between mb-4">
                    <div className="w-12 h-12 bg-gradient-to-br from-red-100 to-pink-100 rounded-lg flex items-center justify-center">
                      <DollarSign className="text-red-600" size={24} />
                    </div>
                    <span className="flex items-center gap-1 text-sm font-semibold text-red-600">
                      <ArrowUp size={16} />
                      {stats.donationChange}%
                    </span>
                  </div>
                  <p className="text-gray-600 text-sm mb-1">ì˜¤ëŠ˜ ê¸°ë¶€ ê¸ˆì•¡</p>
                  <p className="text-3xl font-bold text-gray-800">{stats.todayDonation.toLocaleString()}ì›</p>
                  <p className="text-xs text-gray-500 mt-2">ì „ì¼ ëŒ€ë¹„</p>
                </div>

                <div className="bg-white rounded-xl p-6 border border-gray-200 shadow-sm hover:shadow-md transition-shadow">
                  <div className="flex items-center justify-between mb-4">
                    <div className="w-12 h-12 bg-gradient-to-br from-pink-100 to-rose-100 rounded-lg flex items-center justify-center">
                      <Users className="text-pink-600" size={24} />
                    </div>
                    <span className="flex items-center gap-1 text-sm font-semibold text-pink-600">
                      <ArrowUp size={16} />
                      {stats.userChange}%
                    </span>
                  </div>
                  <p className="text-gray-600 text-sm mb-1">ì‹ ê·œ íšŒì›</p>
                  <p className="text-3xl font-bold text-gray-800">{stats.newUsers}ëª…</p>
                  <p className="text-xs text-gray-500 mt-2">ì´ë²ˆ ì£¼</p>
                </div>

                <div className="bg-white rounded-xl p-6 border border-gray-200 shadow-sm hover:shadow-md transition-shadow cursor-pointer" onClick={() => setActiveMenu('projects')}>
                  <div className="flex items-center justify-between mb-4">
                    <div className="w-12 h-12 bg-gradient-to-br from-orange-100 to-red-100 rounded-lg flex items-center justify-center">
                      <Clock className="text-orange-600" size={24} />
                    </div>
                    <button className="text-red-600 hover:text-red-700 font-semibold text-sm">
                      ë³´ê¸° â†’
                    </button>
                  </div>
                  <p className="text-gray-600 text-sm mb-1">ìŠ¹ì¸ ëŒ€ê¸°</p>
                  <p className="text-3xl font-bold text-gray-800">{stats.pendingApprovals}ê±´</p>
                  <p className="text-xs text-gray-500 mt-2">í”„ë¡œì íŠ¸</p>
                </div>

                <div className="bg-white rounded-xl p-6 border border-gray-200 shadow-sm hover:shadow-md transition-shadow cursor-pointer" onClick={() => setActiveMenu('settlements')}>
                  <div className="flex items-center justify-between mb-4">
                    <div className="w-12 h-12 bg-gradient-to-br from-rose-100 to-pink-100 rounded-lg flex items-center justify-center">
                      <FileText className="text-rose-600" size={24} />
                    </div>
                    <button className="text-pink-600 hover:text-pink-700 font-semibold text-sm">
                      ë³´ê¸° â†’
                    </button>
                  </div>
                  <p className="text-gray-600 text-sm mb-1">ì •ì‚° ìš”ì²­</p>
                  <p className="text-3xl font-bold text-gray-800">{stats.pendingSettlements}ê±´</p>
                  <p className="text-xs text-gray-500 mt-2">ì²˜ë¦¬ ëŒ€ê¸°ì¤‘</p>
                </div>
              </div>

              {/* ìµœê·¼ í”„ë¡œì íŠ¸ */}
              <div className="bg-white rounded-xl border border-gray-200 shadow-sm">
                <div className="p-6 border-b border-gray-200 flex items-center justify-between">
                  <h3 className="text-lg font-bold text-gray-800">ìŠ¹ì¸ ëŒ€ê¸° í”„ë¡œì íŠ¸</h3>
                  <button
                    onClick={() => setActiveMenu('projects')}
                    className="text-sm text-red-500 hover:text-red-600 font-semibold"
                  >
                    ì „ì²´ë³´ê¸° â†’
                  </button>
                </div>
                <div className="overflow-x-auto">
                  <table className="w-full">
                    <thead className="bg-gray-50 border-b border-gray-200">
                      <tr>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">í”„ë¡œì íŠ¸ëª…</th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">ê¸°ê´€</th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">ëª©í‘œê¸ˆì•¡</th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">ì‹ ì²­ì¼</th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">ìƒíƒœ</th>
                        <th className="px-6 py-3 text-right text-xs font-semibold text-gray-600 uppercase">ì•¡ì…˜</th>
                      </tr>
                    </thead>
                    <tbody className="divide-y divide-gray-200">
                      {recentProjects.filter(p => p.status === 'pending').map((project) => (
                        <tr key={project.id} className="hover:bg-gray-50">
                          <td className="px-6 py-4 font-medium text-gray-800">{project.title}</td>
                          <td className="px-6 py-4 text-gray-600">{project.org}</td>
                          <td className="px-6 py-4 text-gray-800 font-semibold">{project.amount.toLocaleString()}ì›</td>
                          <td className="px-6 py-4 text-gray-600 text-sm">{project.date}</td>
                          <td className="px-6 py-4">
                            <span className="px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-xs font-semibold">
                              ëŒ€ê¸°ì¤‘
                            </span>
                          </td>
                          <td className="px-6 py-4 text-right">
                            <button
                              onClick={() => {
                                setSelectedProject(project);
                                setShowProjectModal(true);
                              }}
                              className="text-red-500 hover:text-red-600 font-semibold text-sm hover:underline"
                            >
                              ê²€í† í•˜ê¸°
                            </button>
                          </td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>
              </div>

              {/* ì°¨íŠ¸ ì˜ì—­ */}
              <div className="grid grid-cols-2 gap-6">
                <div className="bg-white rounded-xl border border-gray-200 shadow-sm p-6">
                  <h3 className="text-lg font-bold text-gray-800 mb-4">ì£¼ê°„ ê¸°ë¶€ ì¶”ì´</h3>
                  <div className="h-64 flex items-end justify-between gap-2">
                    {[65, 85, 72, 90, 78, 95, 88].map((height, idx) => (
                      <div key={idx} className="flex-1 flex flex-col items-center">
                        <div
                          className="w-full bg-gradient-to-t from-red-500 to-pink-500 rounded-t-lg transition-all hover:opacity-80"
                          style={{ height: `${height}%` }}
                        ></div>
                        <span className="text-xs text-gray-600 mt-2">
                          {['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† ', 'ì¼'][idx]}
                        </span>
                      </div>
                    ))}
                  </div>
                </div>

                <div className="bg-white rounded-xl border border-gray-200 shadow-sm p-6">
                  <h3 className="text-lg font-bold text-gray-800 mb-4">ì¹´í…Œê³ ë¦¬ë³„ ë¶„í¬</h3>
                  <div className="space-y-4">
                    {[
                      { name: 'ì•„ë™Â·ì²­ì†Œë…„', percent: 35, color: 'bg-red-500' },
                      { name: 'ì–´ë¥´ì‹ ', percent: 25, color: 'bg-pink-500' },
                      { name: 'ì¥ì• ì¸', percent: 20, color: 'bg-rose-500' },
                      { name: 'í™˜ê²½ë³´í˜¸', percent: 15, color: 'bg-orange-500' },
                      { name: 'ê¸°íƒ€', percent: 5, color: 'bg-amber-500' },
                    ].map((cat) => (
                      <div key={cat.name}>
                        <div className="flex items-center justify-between mb-1">
                          <span className="text-sm text-gray-700 font-medium">{cat.name}</span>
                          <span className="text-sm text-gray-600 font-semibold">{cat.percent}%</span>
                        </div>
                        <div className="w-full bg-gray-200 rounded-full h-2">
                          <div
                            className={`${cat.color} h-2 rounded-full transition-all`}
                            style={{ width: `${cat.percent}%` }}
                          ></div>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              </div>
            </div>
          )}

          {/* í”„ë¡œì íŠ¸ ìŠ¹ì¸ ê´€ë¦¬ */}
          {activeMenu === 'projects' && (
            <div className="p-8">
              <div className="bg-white rounded-xl border border-gray-200 shadow-sm">
                {/* í•„í„° ë°” */}
                <div className="p-6 border-b border-gray-200 space-y-4">
                  <div className="flex items-center gap-4">
                    <div className="flex-1 relative">
                      <Search className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" size={20} />
                      <input
                        type="text"
                        value={projectSearchTerm}
                        onChange={(e) => setProjectSearchTerm(e.target.value)}
                        placeholder="í”„ë¡œì íŠ¸ëª…, ê¸°ê´€ëª…ìœ¼ë¡œ ê²€ìƒ‰..."
                        className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"
                      />
                    </div>
                    <select
                      value={projectFilter}
                      onChange={(e) => setProjectFilter(e.target.value)}
                      className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"
                    >
                      <option value="all">ëª¨ë“  ìƒíƒœ</option>
                      <option value="pending">ìŠ¹ì¸ ëŒ€ê¸°</option>
                      <option value="approved">ìŠ¹ì¸ ì™„ë£Œ</option>
                      <option value="rejected">ë°˜ë ¤</option>
                    </select>
                    <select
                      value={projectCategoryFilter}
                      onChange={(e) => setProjectCategoryFilter(e.target.value)}
                      className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"
                    >
                      <option value="all">ëª¨ë“  ì¹´í…Œê³ ë¦¬</option>
                      <option value="êµìœ¡">êµìœ¡</option>
                      <option value="ë…¸ì¸">ë…¸ì¸</option>
                      <option value="ì¥ì• ì¸">ì¥ì• ì¸</option>
                      <option value="ì•„ë™">ì•„ë™</option>
                      <option value="í™˜ê²½">í™˜ê²½</option>
                    </select>
                    <button className="px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg flex items-center gap-2 font-semibold">
                      <Download size={18} />
                      ì—‘ì…€
                    </button>
                  </div>

                  <div className="flex items-center gap-2">
                    <span className="text-sm text-gray-600">ë¹ ë¥¸ í•„í„°:</span>
                    <button className="px-3 py-1 bg-gradient-to-r from-red-50 to-pink-50 text-red-600 rounded-lg text-sm font-medium hover:from-red-100 hover:to-pink-100 border border-red-200">
                      ì˜¤ëŠ˜ ì‹ ì²­ (3)
                    </button>
                    <button className="px-3 py-1 bg-gray-100 text-gray-600 rounded-lg text-sm font-medium hover:bg-gray-200">
                      ì´ë²ˆ ì£¼ (12)
                    </button>
                    <button className="px-3 py-1 bg-gray-100 text-gray-600 rounded-lg text-sm font-medium hover:bg-gray-200">
                      ê¸´ê¸‰ (2)
                    </button>
                  </div>
                </div>

                {/* í…Œì´ë¸” */}
                <div className="overflow-x-auto">
                  <table className="w-full">
                    <thead className="bg-gray-50 border-b border-gray-200">
                      <tr>
                        <th className="px-6 py-3 text-left">
                          <input
                            type="checkbox"
                            className="rounded"
                            checked={selectedProjects.length === recentProjects.filter(p =>
                              (projectFilter === 'all' || p.status === projectFilter) &&
                              (projectCategoryFilter === 'all' || p.category === projectCategoryFilter) &&
                              (projectSearchTerm === '' || p.title.toLowerCase().includes(projectSearchTerm.toLowerCase()) || p.org.toLowerCase().includes(projectSearchTerm.toLowerCase()))
                            ).length && recentProjects.filter(p =>
                              (projectFilter === 'all' || p.status === projectFilter) &&
                              (projectCategoryFilter === 'all' || p.category === projectCategoryFilter) &&
                              (projectSearchTerm === '' || p.title.toLowerCase().includes(projectSearchTerm.toLowerCase()) || p.org.toLowerCase().includes(projectSearchTerm.toLowerCase()))
                            ).length > 0}
                            onChange={(e) => {
                              const filteredProjects = recentProjects.filter(p =>
                                (projectFilter === 'all' || p.status === projectFilter) &&
                                (projectCategoryFilter === 'all' || p.category === projectCategoryFilter) &&
                                (projectSearchTerm === '' || p.title.toLowerCase().includes(projectSearchTerm.toLowerCase()) || p.org.toLowerCase().includes(projectSearchTerm.toLowerCase()))
                              );
                              if (e.target.checked) {
                                setSelectedProjects(filteredProjects.map(p => p.id));
                              } else {
                                setSelectedProjects([]);
                              }
                            }}
                          />
                        </th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">ID</th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">í”„ë¡œì íŠ¸ëª…</th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">ê¸°ê´€</th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">ì¹´í…Œê³ ë¦¬</th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">ëª©í‘œê¸ˆì•¡</th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">ì‹ ì²­ì¼</th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">ìƒíƒœ</th>
                        <th className="px-6 py-3 text-center text-xs font-semibold text-gray-600 uppercase">ì•¡ì…˜</th>
                      </tr>
                    </thead>
                    <tbody className="divide-y divide-gray-200">
                      {recentProjects.filter(p =>
                        (projectFilter === 'all' || p.status === projectFilter) &&
                        (projectCategoryFilter === 'all' || p.category === projectCategoryFilter) &&
                        (projectSearchTerm === '' || p.title.toLowerCase().includes(projectSearchTerm.toLowerCase()) || p.org.toLowerCase().includes(projectSearchTerm.toLowerCase()))
                      ).map((project) => (
                        <tr key={project.id} className="hover:bg-gray-50 transition-colors">
                          <td className="px-6 py-4">
                            <input
                              type="checkbox"
                              className="rounded"
                              checked={selectedProjects.includes(project.id)}
                              onChange={(e) => {
                                if (e.target.checked) {
                                  setSelectedProjects([...selectedProjects, project.id]);
                                } else {
                                  setSelectedProjects(selectedProjects.filter(id => id !== project.id));
                                }
                              }}
                            />
                          </td>
                          <td className="px-6 py-4 text-sm text-gray-600">#{project.id}</td>
                          <td className="px-6 py-4">
                            <p className="font-medium text-gray-800">{project.title}</p>
                          </td>
                          <td className="px-6 py-4 text-gray-600">{project.org}</td>
                          <td className="px-6 py-4">
                            <span className="px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-medium">
                              {project.category}
                            </span>
                          </td>
                          <td className="px-6 py-4 text-gray-800 font-semibold">{project.amount.toLocaleString()}ì›</td>
                          <td className="px-6 py-4 text-gray-600 text-sm">{project.date}</td>
                          <td className="px-6 py-4">
                            {project.status === 'pending' && (
                              <span className="px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-xs font-semibold">
                                ëŒ€ê¸°ì¤‘
                              </span>
                            )}
                            {project.status === 'approved' && (
                              <span className="px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-semibold">
                                ìŠ¹ì¸
                              </span>
                            )}
                            {project.status === 'rejected' && (
                              <span className="px-3 py-1 bg-red-100 text-red-700 rounded-full text-xs font-semibold">
                                ë°˜ë ¤
                              </span>
                            )}
                          </td>
                          <td className="px-6 py-4">
                            <div className="flex items-center justify-center gap-2">
                              <button
                                onClick={() => {
                                  setSelectedProject(project);
                                  setShowProjectModal(true);
                                }}
                                className="p-2 hover:bg-gray-100 rounded-lg transition-colors"
                                title="ìƒì„¸ë³´ê¸°"
                              >
                                <Eye size={16} className="text-gray-600" />
                              </button>
                              {project.status === 'pending' && (
                                <>
                                  <button
                                    onClick={() => {
                                      if (window.confirm('ì´ í”„ë¡œì íŠ¸ë¥¼ ìŠ¹ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                                        alert('í”„ë¡œì íŠ¸ê°€ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.');
                                      }
                                    }}
                                    className="p-2 hover:bg-green-50 rounded-lg transition-colors"
                                    title="ìŠ¹ì¸"
                                  >
                                    <CheckCircle size={16} className="text-green-600" />
                                  </button>
                                  <button
                                    onClick={() => {
                                      setSelectedProject(project);
                                      setShowProjectModal(true);
                                    }}
                                    className="p-2 hover:bg-red-50 rounded-lg transition-colors"
                                    title="ë°˜ë ¤"
                                  >
                                    <XCircle size={16} className="text-red-600" />
                                  </button>
                                </>
                              )}
                            </div>
                          </td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>

                {/* í˜ì´ì§€ë„¤ì´ì…˜ */}
                <div className="p-6 border-t border-gray-200 flex items-center justify-between">
                  <p className="text-sm text-gray-600">
                    ì´ <strong>{recentProjects.filter(p =>
                      (projectFilter === 'all' || p.status === projectFilter) &&
                      (projectCategoryFilter === 'all' || p.category === projectCategoryFilter) &&
                      (projectSearchTerm === '' || p.title.toLowerCase().includes(projectSearchTerm.toLowerCase()) || p.org.toLowerCase().includes(projectSearchTerm.toLowerCase()))
                    ).length}</strong>ê°œ ì¤‘ <strong>1-{recentProjects.filter(p =>
                      (projectFilter === 'all' || p.status === projectFilter) &&
                      (projectCategoryFilter === 'all' || p.category === projectCategoryFilter) &&
                      (projectSearchTerm === '' || p.title.toLowerCase().includes(projectSearchTerm.toLowerCase()) || p.org.toLowerCase().includes(projectSearchTerm.toLowerCase()))
                    ).length}</strong> í‘œì‹œ
                  </p>
                  <div className="flex gap-2">
                    <button className="px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed" disabled>ì´ì „</button>
                    <button className="px-3 py-1 border rounded-lg bg-red-500 text-white border-red-500">1</button>
                    <button className="px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed" disabled>ë‹¤ìŒ</button>
                  </div>
                </div>
              </div>
            </div>
          )}

          {/* ì‚¬ìš©ì ê´€ë¦¬ */}
          {activeMenu === 'users' && (
            <div className="p-8">
              <div className="bg-white rounded-xl border border-gray-200 shadow-sm">
                <div className="p-6 border-b border-gray-200 flex items-center gap-4">
                  <div className="flex-1 relative">
                    <Search className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" size={20} />
                    <input
                      type="text"
                      value={userSearchTerm}
                      onChange={(e) => setUserSearchTerm(e.target.value)}
                      placeholder="ì´ë¦„, ì´ë©”ì¼ë¡œ ê²€ìƒ‰..."
                      className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"
                    />
                  </div>
                  <select
                    value={userTypeFilter}
                    onChange={(e) => setUserTypeFilter(e.target.value)}
                    className="px-4 py-2 border border-gray-300 rounded-lg"
                  >
                    <option value="all">ëª¨ë“  ìœ í˜•</option>
                    <option value="ì¼ë°˜">ì¼ë°˜ ì‚¬ìš©ì</option>
                    <option value="ê¸°ê´€">ê¸°ê´€</option>
                  </select>
                  <select
                    value={userStatusFilter}
                    onChange={(e) => setUserStatusFilter(e.target.value)}
                    className="px-4 py-2 border border-gray-300 rounded-lg"
                  >
                    <option value="all">ëª¨ë“  ìƒíƒœ</option>
                    <option value="active">í™œì„±</option>
                    <option value="inactive">ë¹„í™œì„±</option>
                  </select>
                  <button className="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 font-semibold">
                    + ì‚¬ìš©ì ì¶”ê°€
                  </button>
                </div>

                <div className="overflow-x-auto">
                  <table className="w-full">
                    <thead className="bg-gray-50 border-b border-gray-200">
                      <tr>
                        <th className="px-6 py-3 text-left">
                          <input
                            type="checkbox"
                            className="rounded"
                            checked={selectedUsers.length === adminUsers.filter(u =>
                              (userTypeFilter === 'all' || u.type === userTypeFilter) &&
                              (userStatusFilter === 'all' || u.status === userStatusFilter) &&
                              (userSearchTerm === '' || u.name.toLowerCase().includes(userSearchTerm.toLowerCase()) || u.email.toLowerCase().includes(userSearchTerm.toLowerCase()))
                            ).length && adminUsers.filter(u =>
                              (userTypeFilter === 'all' || u.type === userTypeFilter) &&
                              (userStatusFilter === 'all' || u.status === userStatusFilter) &&
                              (userSearchTerm === '' || u.name.toLowerCase().includes(userSearchTerm.toLowerCase()) || u.email.toLowerCase().includes(userSearchTerm.toLowerCase()))
                            ).length > 0}
                            onChange={(e) => {
                              const filteredUsers = adminUsers.filter(u =>
                                (userTypeFilter === 'all' || u.type === userTypeFilter) &&
                                (userStatusFilter === 'all' || u.status === userStatusFilter) &&
                                (userSearchTerm === '' || u.name.toLowerCase().includes(userSearchTerm.toLowerCase()) || u.email.toLowerCase().includes(userSearchTerm.toLowerCase()))
                              );
                              if (e.target.checked) {
                                setSelectedUsers(filteredUsers.map(u => u.id));
                              } else {
                                setSelectedUsers([]);
                              }
                            }}
                          />
                        </th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">ì´ë¦„</th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">ì´ë©”ì¼</th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">ìœ í˜•</th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">ê°€ì…ì¼</th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">ìµœê·¼ ë¡œê·¸ì¸</th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">ìƒíƒœ</th>
                        <th className="px-6 py-3 text-center text-xs font-semibold text-gray-600 uppercase">ì•¡ì…˜</th>
                      </tr>
                    </thead>
                    <tbody className="divide-y divide-gray-200">
                      {adminUsers.filter(u =>
                        (userTypeFilter === 'all' || u.type === userTypeFilter) &&
                        (userStatusFilter === 'all' || u.status === userStatusFilter) &&
                        (userSearchTerm === '' || u.name.toLowerCase().includes(userSearchTerm.toLowerCase()) || u.email.toLowerCase().includes(userSearchTerm.toLowerCase()))
                      ).map((user) => (
                        <tr key={user.id} className="hover:bg-gray-50">
                          <td className="px-6 py-4">
                            <input
                              type="checkbox"
                              className="rounded"
                              checked={selectedUsers.includes(user.id)}
                              onChange={(e) => {
                                if (e.target.checked) {
                                  setSelectedUsers([...selectedUsers, user.id]);
                                } else {
                                  setSelectedUsers(selectedUsers.filter(id => id !== user.id));
                                }
                              }}
                            />
                          </td>
                          <td className="px-6 py-4 font-medium text-gray-800">{user.name}</td>
                          <td className="px-6 py-4 text-gray-600 text-sm">{user.email}</td>
                          <td className="px-6 py-4">
                            <span className={`px-2 py-1 rounded text-xs font-medium ${
                              user.type === 'ì¼ë°˜' ? 'bg-blue-100 text-blue-700' : 'bg-purple-100 text-purple-700'
                            }`}>
                              {user.type}
                            </span>
                          </td>
                          <td className="px-6 py-4 text-gray-600 text-sm">{user.registeredDate}</td>
                          <td className="px-6 py-4 text-gray-600 text-sm">{user.lastLogin}</td>
                          <td className="px-6 py-4">
                            <span className={`px-3 py-1 rounded-full text-xs font-semibold ${
                              user.status === 'active' ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-700'
                            }`}>
                              {user.status === 'active' ? 'í™œì„±' : 'ë¹„í™œì„±'}
                            </span>
                          </td>
                          <td className="px-6 py-4">
                            <div className="flex items-center justify-center gap-2">
                              <button
                                onClick={() => {
                                  setSelectedUser(user);
                                  setShowUserModal(true);
                                }}
                                className="p-2 hover:bg-gray-100 rounded-lg"
                                title="ìƒì„¸ë³´ê¸°"
                              >
                                <Eye size={16} className="text-gray-600" />
                              </button>
                              <button
                                onClick={() => {
                                  setSelectedUser(user);
                                  setShowUserModal(true);
                                }}
                                className="p-2 hover:bg-pink-50 rounded-lg"
                                title="ìˆ˜ì •"
                              >
                                <Edit size={16} className="text-pink-600" />
                              </button>
                              <button
                                onClick={() => {
                                  if (window.confirm('ì´ ì‚¬ìš©ìë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                                    alert('ì‚¬ìš©ìê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                                  }
                                }}
                                className="p-2 hover:bg-red-50 rounded-lg"
                                title="ì‚­ì œ"
                              >
                                <Trash2 size={16} className="text-red-600" />
                              </button>
                            </div>
                          </td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>

                <div className="p-6 border-t border-gray-200 flex items-center justify-between">
                  <p className="text-sm text-gray-600">
                    ì´ <strong>{adminUsers.filter(u =>
                      (userTypeFilter === 'all' || u.type === userTypeFilter) &&
                      (userStatusFilter === 'all' || u.status === userStatusFilter) &&
                      (userSearchTerm === '' || u.name.toLowerCase().includes(userSearchTerm.toLowerCase()) || u.email.toLowerCase().includes(userSearchTerm.toLowerCase()))
                    ).length}</strong>ëª… ì¤‘ <strong>1-{adminUsers.filter(u =>
                      (userTypeFilter === 'all' || u.type === userTypeFilter) &&
                      (userStatusFilter === 'all' || u.status === userStatusFilter) &&
                      (userSearchTerm === '' || u.name.toLowerCase().includes(userSearchTerm.toLowerCase()) || u.email.toLowerCase().includes(userSearchTerm.toLowerCase()))
                    ).length}</strong> í‘œì‹œ
                  </p>
                  <div className="flex gap-2">
                    <button className="px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed" disabled>ì´ì „</button>
                    <button className="px-3 py-1 border rounded-lg bg-red-500 text-white border-red-500">1</button>
                    <button className="px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed" disabled>ë‹¤ìŒ</button>
                  </div>
                </div>
              </div>
            </div>
          )}

          {/* ì •ì‚° ê´€ë¦¬ */}
          {activeMenu === 'settlements' && (
            <div className="p-8">
              <div className="bg-white rounded-xl border border-gray-200 shadow-sm">
                <div className="p-6 border-b border-gray-200 flex items-center gap-4">
                  <div className="flex-1 relative">
                    <Search className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" size={20} />
                    <input
                      type="text"
                      value={settlementSearchTerm}
                      onChange={(e) => setSettlementSearchTerm(e.target.value)}
                      placeholder="í”„ë¡œì íŠ¸ëª…, ê¸°ê´€ëª…ìœ¼ë¡œ ê²€ìƒ‰..."
                      className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"
                    />
                  </div>
                  <select
                    value={settlementFilter}
                    onChange={(e) => setSettlementFilter(e.target.value)}
                    className="px-4 py-2 border border-gray-300 rounded-lg"
                  >
                    <option value="all">ëª¨ë“  ìƒíƒœ</option>
                    <option value="pending">ëŒ€ê¸°ì¤‘</option>
                    <option value="completed">ì™„ë£Œ</option>
                  </select>
                  <button
                    className="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 font-semibold disabled:opacity-50 disabled:cursor-not-allowed"
                    disabled={selectedSettlements.length === 0}
                    onClick={() => {
                      alert(`${selectedSettlements.length}ê±´ì˜ ì •ì‚°ì„ ìŠ¹ì¸í•©ë‹ˆë‹¤.`);
                      setSelectedSettlements([]);
                    }}
                  >
                    ì„ íƒ í•­ëª© ìŠ¹ì¸ ({selectedSettlements.length})
                  </button>
                </div>

                <div className="overflow-x-auto">
                  <table className="w-full">
                    <thead className="bg-gray-50 border-b border-gray-200">
                      <tr>
                        <th className="px-6 py-3 text-left">
                          <input
                            type="checkbox"
                            className="rounded"
                            checked={selectedSettlements.length === settlements.filter(s =>
                              (settlementFilter === 'all' || s.status === settlementFilter) &&
                              (settlementSearchTerm === '' || s.project.toLowerCase().includes(settlementSearchTerm.toLowerCase()) || s.org.toLowerCase().includes(settlementSearchTerm.toLowerCase()))
                            ).length && settlements.filter(s =>
                              (settlementFilter === 'all' || s.status === settlementFilter) &&
                              (settlementSearchTerm === '' || s.project.toLowerCase().includes(settlementSearchTerm.toLowerCase()) || s.org.toLowerCase().includes(settlementSearchTerm.toLowerCase()))
                            ).length > 0}
                            onChange={(e) => {
                              const filteredSettlements = settlements.filter(s =>
                                (settlementFilter === 'all' || s.status === settlementFilter) &&
                                (settlementSearchTerm === '' || s.project.toLowerCase().includes(settlementSearchTerm.toLowerCase()) || s.org.toLowerCase().includes(settlementSearchTerm.toLowerCase()))
                              );
                              if (e.target.checked) {
                                setSelectedSettlements(filteredSettlements.map(s => s.id));
                              } else {
                                setSelectedSettlements([]);
                              }
                            }}
                          />
                        </th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">í”„ë¡œì íŠ¸ëª…</th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">ê¸°ê´€</th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">ì •ì‚°ê¸ˆì•¡</th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">ì‹ ì²­ì¼</th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">ì²¨ë¶€ì„œë¥˜</th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">ìƒíƒœ</th>
                        <th className="px-6 py-3 text-center text-xs font-semibold text-gray-600 uppercase">ì•¡ì…˜</th>
                      </tr>
                    </thead>
                    <tbody className="divide-y divide-gray-200">
                      {settlements.filter(s =>
                        (settlementFilter === 'all' || s.status === settlementFilter) &&
                        (settlementSearchTerm === '' || s.project.toLowerCase().includes(settlementSearchTerm.toLowerCase()) || s.org.toLowerCase().includes(settlementSearchTerm.toLowerCase()))
                      ).map((settlement) => (
                        <tr key={settlement.id} className="hover:bg-gray-50">
                          <td className="px-6 py-4">
                            <input
                              type="checkbox"
                              className="rounded"
                              checked={selectedSettlements.includes(settlement.id)}
                              onChange={(e) => {
                                if (e.target.checked) {
                                  setSelectedSettlements([...selectedSettlements, settlement.id]);
                                } else {
                                  setSelectedSettlements(selectedSettlements.filter(id => id !== settlement.id));
                                }
                              }}
                            />
                          </td>
                          <td className="px-6 py-4 font-medium text-gray-800">{settlement.project}</td>
                          <td className="px-6 py-4 text-gray-600">{settlement.org}</td>
                          <td className="px-6 py-4 text-gray-800 font-bold text-lg">{settlement.amount.toLocaleString()}ì›</td>
                          <td className="px-6 py-4 text-gray-600 text-sm">{settlement.date}</td>
                          <td className="px-6 py-4">
                            <button
                              onClick={() => {
                                setSelectedSettlement(settlement);
                                setShowSettlementModal(true);
                              }}
                              className="flex items-center gap-1 text-pink-600 hover:text-pink-700 text-sm font-medium hover:underline"
                            >
                              <FileText size={16} />
                              {settlement.files}ê°œ íŒŒì¼
                            </button>
                          </td>
                          <td className="px-6 py-4">
                            {settlement.status === 'pending' ? (
                              <span className="px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-xs font-semibold">
                                ëŒ€ê¸°ì¤‘
                              </span>
                            ) : (
                              <span className="px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-semibold">
                                ì™„ë£Œ
                              </span>
                            )}
                          </td>
                          <td className="px-6 py-4">
                            <div className="flex items-center justify-center gap-2">
                              {settlement.status === 'pending' ? (
                                <>
                                  <button
                                    onClick={() => {
                                      setSelectedSettlement(settlement);
                                      setShowSettlementModal(true);
                                    }}
                                    className="px-3 py-1 bg-green-500 text-white rounded-lg hover:bg-green-600 text-sm font-semibold"
                                  >
                                    ìŠ¹ì¸
                                  </button>
                                  <button
                                    onClick={() => {
                                      setSelectedSettlement(settlement);
                                      setShowSettlementModal(true);
                                    }}
                                    className="px-3 py-1 bg-red-500 text-white rounded-lg hover:bg-red-600 text-sm font-semibold"
                                  >
                                    ë°˜ë ¤
                                  </button>
                                </>
                              ) : (
                                <button
                                  onClick={() => {
                                    setSelectedSettlement(settlement);
                                    setShowSettlementModal(true);
                                  }}
                                  className="px-3 py-1 bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 text-sm font-semibold"
                                >
                                  ìƒì„¸ë³´ê¸°
                                </button>
                              )}
                            </div>
                          </td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>

                <div className="p-6 border-t border-gray-200 flex items-center justify-between">
                  <p className="text-sm text-gray-600">
                    ì´ <strong>{settlements.filter(s =>
                      (settlementFilter === 'all' || s.status === settlementFilter) &&
                      (settlementSearchTerm === '' || s.project.toLowerCase().includes(settlementSearchTerm.toLowerCase()) || s.org.toLowerCase().includes(settlementSearchTerm.toLowerCase()))
                    ).length}</strong>ê±´ ì¤‘ <strong>1-{settlements.filter(s =>
                      (settlementFilter === 'all' || s.status === settlementFilter) &&
                      (settlementSearchTerm === '' || s.project.toLowerCase().includes(settlementSearchTerm.toLowerCase()) || s.org.toLowerCase().includes(settlementSearchTerm.toLowerCase()))
                    ).length}</strong> í‘œì‹œ
                  </p>
                  <div className="flex gap-2">
                    <button className="px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed" disabled>ì´ì „</button>
                    <button className="px-3 py-1 border rounded-lg bg-red-500 text-white border-red-500">1</button>
                    <button className="px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed" disabled>ë‹¤ìŒ</button>
                  </div>
                </div>
              </div>
            </div>
          )}

          {/* í†µê³„ ë¦¬í¬íŠ¸ */}
          {activeMenu === 'reports' && (
            <div className="p-8">
              <div className="bg-white rounded-xl border border-gray-200 shadow-sm p-8">
                <div className="text-center py-16">
                  <PieChart size={64} className="mx-auto text-gray-400 mb-4" />
                  <h3 className="text-xl font-bold text-gray-800 mb-2">í†µê³„ ë¦¬í¬íŠ¸</h3>
                  <p className="text-gray-600">í†µê³„ ë¦¬í¬íŠ¸ ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.</p>
                </div>
              </div>
            </div>
          )}

          {/* ì„¤ì • */}
          {activeMenu === 'settings' && (
            <div className="p-8">
              <div className="bg-white rounded-xl border border-gray-200 shadow-sm p-8">
                <div className="text-center py-16">
                  <Settings size={64} className="mx-auto text-gray-400 mb-4" />
                  <h3 className="text-xl font-bold text-gray-800 mb-2">ì‹œìŠ¤í…œ ì„¤ì •</h3>
                  <p className="text-gray-600">ì‹œìŠ¤í…œ ì„¤ì • ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.</p>
                </div>
              </div>
            </div>
          )}
        </div>
        </div>
      </>
    );
  };

  const AdminUsersPage: React.FC = () => (
    <div className="bg-gray-50 min-h-screen">
      <div className="max-w-[1400px] mx-auto px-8 py-12">
        <button 
          onClick={() => setCurrentPage('admin')}
          className="mb-8 text-gray-600 hover:text-gray-900 font-semibold"
        >
          â† ëŒ€ì‹œë³´ë“œë¡œ
        </button>

        <h1 className="text-5xl font-bold mb-12">ì‚¬ìš©ì ê´€ë¦¬</h1>

        <div className="bg-white border border-gray-200 rounded-xl overflow-hidden">
          <div className="grid grid-cols-12 gap-4 p-4 bg-gray-50 border-b border-gray-200 font-bold">
            <div className="col-span-2">ì´ë¦„</div>
            <div className="col-span-3">ì´ë©”ì¼</div>
            <div className="col-span-1">ìœ í˜•</div>
            <div className="col-span-2">ê°€ì…ì¼</div>
            <div className="col-span-2">ìµœê·¼ ë¡œê·¸ì¸</div>
            <div className="col-span-2 text-center">ìƒíƒœ</div>
          </div>

          {adminUsers.map(user => (
            <div key={user.id} className="grid grid-cols-12 gap-4 p-4 border-b border-gray-200">
              <div className="col-span-2 font-semibold">{user.name}</div>
              <div className="col-span-3 text-gray-600">{user.email}</div>
              <div className="col-span-1">
                <span className={`px-2 py-1 rounded text-xs font-bold ${
                  user.type === 'ì¼ë°˜' ? 'bg-blue-100 text-blue-600' : 'bg-purple-100 text-purple-600'
                }`}>
                  {user.type}
                </span>
              </div>
              <div className="col-span-2 text-sm text-gray-600">{user.registeredDate}</div>
              <div className="col-span-2 text-sm text-gray-600">{user.lastLogin}</div>
              <div className="col-span-2 text-center">
                <select 
                  value={user.status}
                  className={`px-3 py-1 rounded-full text-sm font-bold ${
                    user.status === 'active' ? 'bg-green-100 text-green-600' :
                    user.status === 'inactive' ? 'bg-gray-100 text-gray-600' :
                    'bg-red-100 text-red-600'
                  }`}
                >
                  <option value="active">í™œì„±</option>
                  <option value="inactive">ë¹„í™œì„±</option>
                  <option value="suspended">ì •ì§€</option>
                </select>
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>
  );

  const ProjectApprovalPage: React.FC = () => {
    const pendingProjects = projects.filter(p => p.status === 'pending');

    return (
      <div className="bg-gray-50 min-h-screen">
        <div className="max-w-5xl mx-auto px-8 py-12">
          <button 
            onClick={() => setCurrentPage('admin')}
            className="mb-8 text-gray-600 hover:text-gray-900 font-semibold"
          >
            â† ëŒ€ì‹œë³´ë“œë¡œ
          </button>

          <div className="bg-white rounded-2xl p-8 border border-gray-200">
            <h2 className="text-3xl font-bold mb-6">í”„ë¡œì íŠ¸ ìŠ¹ì¸ ê´€ë¦¬</h2>

            <div className="mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
              <div className="flex items-center gap-2 text-yellow-800">
                <span className="font-bold">ìŠ¹ì¸ ëŒ€ê¸° ì¤‘ì¸ í”„ë¡œì íŠ¸: {pendingProjects.length}ê±´</span>
              </div>
            </div>

            <div className="space-y-6">
              {pendingProjects.map(project => (
                <div key={project.id} className="p-6 border-2 border-yellow-300 rounded-xl bg-yellow-50/30">
                  <div className="flex items-start justify-between mb-4">
                    <div>
                      <div className="flex items-center gap-3 mb-2">
                        <h3 className="font-bold text-xl">{project.title}</h3>
                        <span className="px-3 py-1 bg-yellow-200 text-yellow-800 rounded-full text-sm font-bold">
                          ìŠ¹ì¸ ëŒ€ê¸°
                        </span>
                      </div>
                      <div className="flex items-center gap-4 text-sm text-gray-600 mb-3">
                        <span>{project.category}</span>
                        <span>â€¢</span>
                        <span>{project.organization}</span>
                      </div>
                      <p className="text-gray-700 mb-3">{project.description}</p>
                      <div className="flex items-center gap-2">
                        <span className="font-bold">ëª©í‘œ ê¸ˆì•¡:</span>
                        <span className="text-xl font-bold text-red-500">{formatAmount(project.targetAmount)}ì›</span>
                      </div>
                    </div>
                  </div>

                  <div className="flex gap-3 pt-4 border-t border-gray-200">
                    <button
                      onClick={() => handleProjectApproval(project.id, false)}
                      className="flex-1 py-3 border-2 border-red-500 text-red-500 rounded-lg font-bold hover:bg-red-50 transition-all flex items-center justify-center gap-2"
                    >
                      <XCircle size={20} />
                      ë°˜ë ¤
                    </button>
                    <button
                      onClick={() => handleProjectApproval(project.id, true)}
                      className="flex-1 py-3 bg-green-500 text-white rounded-lg font-bold hover:bg-green-600 transition-all flex items-center justify-center gap-2"
                    >
                      <CheckCircle size={20} />
                      ìŠ¹ì¸
                    </button>
                  </div>
                </div>
              ))}
            </div>
          </div>
        </div>
      </div>
    );
  };

  const SettlementPage: React.FC = () => (
    <div className="bg-gray-50 min-h-screen">
      <div className="max-w-5xl mx-auto px-8 py-12">
        <button 
          onClick={() => setCurrentPage('admin')}
          className="mb-8 text-gray-600 hover:text-gray-900 font-semibold"
        >
          â† ëŒ€ì‹œë³´ë“œë¡œ
        </button>

        <div className="bg-white rounded-2xl p-8 border border-gray-200">
          <h2 className="text-3xl font-bold mb-6">ì •ì‚° ê´€ë¦¬</h2>

          <div className="space-y-6">
            {settlementRequests.map(request => (
              <div 
                key={request.id}
                className={`p-6 rounded-xl border-2 ${
                  request.status === 'pending' ? 'border-yellow-300 bg-yellow-50/30' :
                  request.status === 'approved' ? 'border-green-300 bg-green-50/30' :
                  'border-red-300 bg-red-50/30'
                }`}
              >
                <div className="flex items-start justify-between mb-4">
                  <div>
                    <h3 className="font-bold text-xl mb-2">{request.projectTitle}</h3>
                    <div className="flex items-center gap-4 text-sm text-gray-600 mb-2">
                      <span>{request.organization}</span>
                      <span>â€¢</span>
                      <span>ì‹ ì²­ì¼: {request.requestDate}</span>
                    </div>
                    <div className="flex items-center gap-2 mb-3">
                      <span className="font-bold">ì •ì‚° ê¸ˆì•¡:</span>
                      <span className="text-2xl font-bold text-red-500">
                        {formatAmount(request.requestAmount)}ì›
                      </span>
                    </div>
                    <div className="flex items-center gap-2">
                      <FileText size={16} className="text-gray-500" />
                      <span className="text-sm text-gray-600">
                        ì²¨ë¶€ ì„œë¥˜: {request.documents.join(', ')}
                      </span>
                    </div>
                  </div>
                  <span className={`px-4 py-2 rounded-full font-bold ${
                    request.status === 'pending' ? 'bg-yellow-200 text-yellow-800' :
                    request.status === 'approved' ? 'bg-green-200 text-green-800' :
                    'bg-red-200 text-red-800'
                  }`}>
                    {request.status === 'pending' ? 'ëŒ€ê¸°ì¤‘' : request.status === 'approved' ? 'ìŠ¹ì¸ì™„ë£Œ' : 'ë°˜ë ¤'}
                  </span>
                </div>

                {request.status === 'pending' && (
                  <div className="flex gap-3 pt-4 border-t border-gray-200">
                    <button
                      onClick={() => handleRejectSettlement(request.id)}
                      className="flex-1 py-3 border-2 border-red-500 text-red-500 rounded-lg font-bold hover:bg-red-50 transition-all flex items-center justify-center gap-2"
                    >
                      <XCircle size={20} />
                      ì •ì‚° ë°˜ë ¤
                    </button>
                    <button
                      onClick={() => handleApproveSettlement(request.id)}
                      className="flex-1 py-3 bg-green-500 text-white rounded-lg font-bold hover:bg-green-600 transition-all flex items-center justify-center gap-2"
                    >
                      <CheckCircle size={20} />
                      ì •ì‚° ìŠ¹ì¸
                    </button>
                  </div>
                )}

                {request.status === 'rejected' && request.rejectionReason && (
                  <div className="p-4 bg-red-50 border border-red-200 rounded-lg mt-4">
                    <p className="text-sm font-bold text-red-700 mb-1">ê±°ë¶€ ì‚¬ìœ </p>
                    <p className="text-red-600">{request.rejectionReason}</p>
                  </div>
                )}
              </div>
            ))}
          </div>
        </div>
      </div>
    </div>
  );

  const renderPage = () => {
    switch (currentPage) {
      case 'home':
        return <HomePage
          projects={projects}
          recentDonations={recentDonations}
          isLoggedIn={isLoggedIn}
          userType={userType}
          setCurrentPage={setCurrentPage}
          setSelectedProject={setSelectedProject}
          setActiveTab={setActiveTab}
          formatAmount={formatAmount}
          calculatePercentage={calculatePercentage}
        />;
      case 'login':
        return <LoginPage />;
      case 'projects':
        return <ProjectsPage />;
      case 'detail':
        return <ProjectDetailPage />;
      case 'signup':
        return <SignupPage />;
      case 'create-project':
        return <CreateProjectPage />;
      case 'community':
        return <CommunityPage />;
      case 'post-detail':
        return <PostDetailPage />;
      case 'create-post':
        return <CreatePostPage />;
      case 'mypage':
        return <MyPage />;
      case 'donation-history':
        return <DonationHistoryPage />;
      case 'favorite-projects':
        return <FavoriteProjectsPage />;
      case 'piggy-bank':
        return <PiggyBankPage />;
      case 'profile-edit':
        return <ProfileEditPage />;
      case 'notifications':
        return <NotificationPage />;
      case 'admin':
        return <AdminDashboard
          sidebarOpen={sidebarOpen}
          setSidebarOpen={setSidebarOpen}
          activeMenu={activeMenu}
          setActiveMenu={setActiveMenu}
          projectFilter={projectFilter}
          setProjectFilter={setProjectFilter}
          projectCategoryFilter={projectCategoryFilter}
          setProjectCategoryFilter={setProjectCategoryFilter}
          projectSearchTerm={projectSearchTerm}
          setProjectSearchTerm={setProjectSearchTerm}
          userTypeFilter={userTypeFilter}
          setUserTypeFilter={setUserTypeFilter}
          userStatusFilter={userStatusFilter}
          setUserStatusFilter={setUserStatusFilter}
          userSearchTerm={userSearchTerm}
          setUserSearchTerm={setUserSearchTerm}
          settlementFilter={settlementFilter}
          setSettlementFilter={setSettlementFilter}
          settlementSearchTerm={settlementSearchTerm}
          setSettlementSearchTerm={setSettlementSearchTerm}
          selectedProjects={selectedProjects}
          setSelectedProjects={setSelectedProjects}
          selectedUsers={selectedUsers}
          setSelectedUsers={setSelectedUsers}
          selectedSettlements={selectedSettlements}
          setSelectedSettlements={setSelectedSettlements}
          selectedProject={selectedProject}
          setSelectedProject={setSelectedProject}
          selectedUser={selectedUser}
          setSelectedUser={setSelectedUser}
          selectedSettlement={selectedSettlement}
          setSelectedSettlement={setSelectedSettlement}
          showProjectModal={showProjectModal}
          setShowProjectModal={setShowProjectModal}
          showUserModal={showUserModal}
          setShowUserModal={setShowUserModal}
          showSettlementModal={showSettlementModal}
          setShowSettlementModal={setShowSettlementModal}
          rejectReason={rejectReason}
          setRejectReason={setRejectReason}
          adminUsers={adminUsers}
        />;
      case 'admin-users':
        return <AdminUsersPage />;
      case 'project-approval':
        return <ProjectApprovalPage />;
      case 'settlement':
        return <SettlementPage />;
      default:
        return <HomePage
          projects={projects}
          recentDonations={recentDonations}
          isLoggedIn={isLoggedIn}
          userType={userType}
          setCurrentPage={setCurrentPage}
          setSelectedProject={setSelectedProject}
          setActiveTab={setActiveTab}
          formatAmount={formatAmount}
          calculatePercentage={calculatePercentage}
        />;
    }
  };

  return (
    <div className="min-h-screen bg-white">
      <Header />
      {renderPage()}
      <DonationModal
        selectedProject={selectedProject}
        showDonationModal={showDonationModal}
        setShowDonationModal={setShowDonationModal}
        formatAmount={formatAmount}
      />
      {showPaymentModal && <PaymentModal />}
      {showLoginModal && <LoginModal />}
      {showPasswordModal && <PasswordChangeModal />}
    </div>
  );
};

export default DonationPlatform;

// npm run dev